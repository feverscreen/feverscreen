{"version":3,"file":"js/app.962b6012.js","mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,0BAA0B,aAAa,0BAA0B,wBAAwB,mBAAmB,OAAO,WAAW,KAAK,8BAA8B,4BAA4B,OAAO,6bAA6b,iBAAiB,OAAO,cAAc,QAAQ,sEAAsE,yCAAyC,gDAAgD,gIAAgI,OAAO,aAAa,cAAc,OAAO,UAAU,KAAK,uBAAuB,0DAA0D,oDAAoD,OAAO,4BAA4B,QAAQ,wDAAwD,2BAA2B,kCAAkC,qGAAqG,OAAO,oEAAoE,uCAAuC,8CAA8C,wGAAwG,OAAO,2BAA2B,4BAA4B,OAAO,eAAe,+CAA+C,OAAO,6BAA6B,kDAAkD,0BAA0B,gDAAgD,OAAO,wMAAwM,sCAAsC,iEAAiE;AACjvE;;;;;;ACDA,IAAI,mEAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,iBAAiB;AAC1G;AACA;AACA,MAAM,sCAAsC,WAAW,wCAAwC,SAAS,6BAA6B,KAAK,yBAAyB,wBAAwB,eAAe,qBAAqB,0FAA0F,YAAY,6BAA6B,gCAAgC,qCAAqC,mBAAmB,4CAA4C,EAAE,yJAAyJ,UAAU,qCAAqC,wDAAwD,6CAA6C,4BAA4B,QAAQ,mEAAmE,mCAAmC,OAAO,8FAA8F,KAAK;AACzgC;AACA;AACA;AACA;AACA,aAAa,eAAe,OAAO,+CAA+C,oEAAoE,OAAO,4GAA4G,QAAQ,kDAAkD,qBAAqB,4BAA4B,wCAAwC,IAAI,kCAAkC;AAClc,IAAI,4EAAe;;;;;;;;ACJZ,MAAM,2BAA2B,GAAG,IAApC;AACA,MAAM,+BAAyB,GAAoB;AACxD,gBAAc,EAAE,iBADwC;AAExD,cAAY,EAAE,CAF0C;AAGxD,oBAAkB,EAAE,IAHoC;AAIxD,eAAa,EAAE,aAJyC;AAKxD,mBAAiB,EAAE,2BALqC;AAMxD,SAAO,EAAE,CAN+C;AAOxD,SAAO,EAAE,CAP+C;AAQxD,SAAO,EAAE,CAR+C;AASxD,SAAO,EAAE,CAT+C;AAUxD,SAAO,EAAE,CAV+C;AAWxD,SAAO,EAAE,CAX+C;AAYxD,SAAO,EAAE,CAZ+C;AAaxD,SAAO,EAAE,CAb+C;AAcxD,0BAAwB,EAAE,OAd8B;AAexD,eAAa,EAAE,YAfyC;AAgBxD,gBAAc,EAAE,IAhBwC;AAiBxD,iBAAe,EAAE,IAjBuC;AAkBxD,eAAa,EAAE;AAlByC,CAAnD;AAwDP,IAAY,cAAZ;;AAAA,WAAY,cAAZ,EAA0B;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,CAfD,EAAY,cAAc,KAAd,cAAc,MAA1B;;AAmFO,MAAM,gBAAgB,GAAG;AAC9B,QAAM,EAAE;AACN,QAAI,EAAE,GADA;AAEN,QAAI,EAAE,GAFA;AAGN,OAAG,EAAE,CAHC;AAIN,SAAK,EAAE,MAJD;AAKN,SAAK,EAAE,WALD;AAMN,YAAQ,EAAE,QANJ;AAON,gBAAY,EAAE;AAPR,GADsB;AAU9B,WAAS,EAAE;AACT,cAAU,EAAE,CADH;AAET,UAAM,EAAE,CAFC;AAGT,YAAQ,EAAE,IAHD;AAIT,aAAS,EAAE,CAJF;AAKT,SAAK,EAAE,CALE;AAMT,gBAAY,EAAE,CANL;AAOT,eAAW,EAAE;AAPJ,GAVmB;AAmB9B,YAAU,EAAE,EAnBkB;AAoB9B,eAAa,EAAE,EApBe;AAqB9B,aAAW,EAAE,+BAAyB;AArBR,CAAzB;;AAsCP,SAAS,iBAAT,CAA2B,KAA3B,EAAwC;AACtC,MAAI,cAAc,GAAG,cAAc,CAAC,IAApC;;AACA,UAAQ,KAAR;AACE,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,UAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,KAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,SAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,OAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,UAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,SAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,YAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,WAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,QAAhC;AACA;;AACF,SAAK,CAAL;AACE,oBAAc,GAAG,cAAc,CAAC,mBAAhC;AACA;;AACF,SAAK,EAAL;AACE,oBAAc,GAAG,cAAc,CAAC,OAAhC;AACA;;AACF,SAAK,EAAL;AACE,oBAAc,GAAG,cAAc,CAAC,eAAhC;AACA;AApCJ;;AAsCA,SAAO,cAAP;AACD;;AAEK,SAAU,aAAV,CAAwB,cAAxB,EAAqD;AACzD,QAAM,CAAC,GAAG,cAAc,CAAC,IAAzB;AACA,QAAM,CAAC,GAAG,CAAC,CAAC,IAAZ;AACA,QAAM,EAAE,GAAG,CAAC,CAAC,OAAb;AACA,QAAM,EAAE,GAAG,CAAC,CAAC,QAAb;AACA,QAAM,EAAE,GAAG,CAAC,CAAC,UAAb;AACA,QAAM,EAAE,GAAG,CAAC,CAAC,WAAb;AACA,QAAM,EAAE,GAAG,CAAC,CAAC,WAAb;AACA,QAAM,EAAE,GAAG,cAAc,CAAC,SAA1B;AACA,QAAM,GAAG,GAAG,cAAc,CAAC,gBAA3B;AACA,QAAM,IAAI,GAAG,cAAc,CAAC,gBAAf,CAAgC,IAA7C;AACA,QAAM,EAAE,GAAG,IAAI,CAAC,MAAhB;AAEA,QAAM,oBAAoB,GAAmB;AAC3C,QAAI,EAAE;AACJ,cAAQ,EAAE,CAAC,CAAC,QADR;AAEJ,UAAI,EAAE;AACJ,eAAO,EAAE;AACP,WAAC,EAAE,EAAE,CAAC,CADC;AAEP,WAAC,EAAE,EAAE,CAAC;AAFC,SADL;AAKJ,gBAAQ,EAAE;AACR,WAAC,EAAE,EAAE,CAAC,CADE;AAER,WAAC,EAAE,EAAE,CAAC;AAFE,SALN;AASJ,kBAAU,EAAE;AACV,WAAC,EAAE,EAAE,CAAC,CADI;AAEV,WAAC,EAAE,EAAE,CAAC;AAFI,SATR;AAaJ,mBAAW,EAAE;AACX,WAAC,EAAE,EAAE,CAAC,CADK;AAEX,WAAC,EAAE,EAAE,CAAC;AAFK;AAbT,OAFF;AAoBJ,iBAAW,EAAE;AACX,SAAC,EAAE,EAAE,CAAC,CADK;AAEX,SAAC,EAAE,EAAE,CAAC;AAFK,OApBT;AAwBJ,gBAAU,EAAE,CAAC,CAAC,UAxBV;AAyBJ,iBAAW,EAAE,CAAC,CAAC,WAzBX;AA0BJ,kBAAY,EAAE,CAAC,CAAC,YA1BZ;AA2BJ,aAAO,EAAE,CAAC,CAAC;AA3BP,KADqC;AA8B3C,kBAAc,EAAE,cAAc,CAAC,cA9BY;AA+B3C,aAAS,EAAE,cAAc,CAAC,SA/BiB;AAgC3C,aAAS,EAAE;AACT,eAAS,EAAE,EAAE,CAAC,SADL;AAET,SAAG,EAAE,EAAE,CAAC,GAFC;AAGT,SAAG,EAAE,EAAE,CAAC;AAHC,KAhCgC;AAqC3C,sBAAkB,EAAE,cAAc,CAAC,kBArCQ;AAsC3C,gBAAY,EAAE,cAAc,CAAC,YAtCc;AAuC3C,aAAS,EAAE,iBAAiB,CAAC,cAAc,CAAC,SAAhB,CAvCe;AAwC3C,WAAO,EAAE,cAAc,CAAC,OAxCmB;AAyC3C,cAAU,EAAE;AACV,UAAI,EAAE;AACJ,cAAM,EAAE;AACN,WAAC,EAAE,EAAE,CAAC,CADA;AAEN,WAAC,EAAE,EAAE,CAAC;AAFA,SADJ;AAKJ,cAAM,EAAE,IAAI,CAAC;AALT,OADI;AAQV,SAAG,EAAE,GAAG,CAAC,GARC;AASV,UAAI,EAAE,GAAG,CAAC;AATA;AAzC+B,GAA7C;AAsDA,GAAC,CAAC,IAAF;AACA,GAAC,CAAC,IAAF;AACA,IAAE,CAAC,IAAH;AACA,IAAE,CAAC,IAAH;AACA,IAAE,CAAC,IAAH;AACA,IAAE,CAAC,IAAH;AACA,IAAE,CAAC,IAAH;AACA,IAAE,CAAC,IAAH;AACA,IAAE,CAAC,IAAH;AACA,MAAI,CAAC,IAAL;AACA,KAAG,CAAC,IAAJ;AACA,gBAAc,CAAC,IAAf;AACA,SAAO,oBAAP;AACD;;AClTM,MAAM,gBAAU,GAAI;AAGzB;AACA;AACA,QAAM,WAAW,GACf,iBAAiB,IAAI,CAAC,SAAtB,IACA,OAAQ,IAAI,CAAC,SAAL,CAAwB,aAAxB,CAAR,KAAmD,UADnD,GAEK,IAAD,IAAgB,IAAI,CAAC,aAAD,CAAJ,EAFpB,GAGK,IAAD,IACE,IAAI,OAAJ,CAAY,CAAC,OAAD,EAAU,MAAV,KAAoB;AAC9B,UAAM,UAAU,GAAG,IAAI,UAAJ,EAAnB;AACA,cAAU,CAAC,gBAAX,CAA4B,MAA5B,EAAoC,MAAK;AACvC,aAAO,CAAC,UAAU,CAAC,MAAZ,CAAP;AACD,KAFD;AAGA,cAAU,CAAC,gBAAX,CAA4B,OAA5B,EAAqC,MAAK;AACxC,YAAM;AACP,KAFD;AAGA,cAAU,CAAC,iBAAX,CAA6B,IAA7B;AACD,GATD,CALR;AAgBA,SAAO;AACL;AADK,GAAP;AAGD,CAxByB,EAAnB;AA0BD,MAAO,cAAP,CAAqB;AAEzB,cAAY,GAAZ,EAAuB;AACrB,SAAK,GAAL,GAAW,GAAX;AACD;;AACM,UAAQ;AACb,QAAI,KAAK,GAAL,KAAa,SAAjB,EAA4B;AAC1B;AACD;;AACD,WAAO,GAAG,KAAK,GAAL,CAAS,OAAT,CAAiB,CAAjB,CAAmB,GAA7B;AACD;;AAVwB;AAapB,MAAM,yBAAyB,GAAG,CACvC,oBADuC,EAEvC,QAFuC,EAGvC,sBAHuC,KAIrB;AAClB,SAAO,IAAI,cAAJ,CACL,oBAAoB,GAAG,CAAC,QAAQ,GAAG,sBAAZ,IAAsC,IADxD,CAAP;AAGD,CARM;AAUD,SAAU,kBAAV,CAA6B,aAA7B,EAAoD,UAApD,EAAsE;AAC1E,QAAM,CAAC,YAAP,CAAoB,OAApB,CACE,iBADF,EAEE,IAAI,CAAC,SAAL,CAAe;AACb,cADa;AAEb;AAFa,GAAf,CAFF;AAOD;AAEK,SAAU,uBAAV,CACJ,aADI,EAEJ,UAFI,EAGJ,qBAAqB,GAAG,IAHpB,EAGwB;AAE5B,QAAM,eAAe,GAAG,MAAM,CAAC,YAAP,CAAoB,OAApB,CAA4B,iBAA5B,CAAxB;;AACA,MAAI,eAAJ,EAAqB;AACnB,QAAI;AACF,YAAM,WAAW,GAAG,IAAI,CAAC,KAAL,CAAW,eAAX,CAApB;;AACA,UACE,aAAa,IACb,UADA,KAEC,WAAW,CAAC,aAAZ,IAA6B,aAA7B,IACC,WAAW,CAAC,UAAZ,IAA0B,UAH5B,CADF,EAKE;AACA,YAAI,qBAAJ,EAA2B;AACzB,iBAAO,CAAC,GAAR,CACE,gCADF,EAEE,IAAI,CAAC,SAAL,CAAe,WAAf,CAFF,EAGE,aAHF,EAIE,UAJF;AAMA,gBAAM,CAAC,QAAP,CAAgB,MAAhB;AACD,SARD,MAQO;AACL,4BAAkB,CAAC,aAAD,EAAgB,UAAhB,CAAlB,CADK,CAEL;;AACA,iBAAO,IAAP;AACD;AACF;AACF,KAtBD,CAsBE,OAAO,CAAP,EAAU;AACV,wBAAkB,CAAC,aAAD,EAAgB,UAAhB,CAAlB;AACA,aAAO,KAAP;AACD;AACF,GA3BD,MA2BO;AACL,sBAAkB,CAAC,aAAD,EAAgB,UAAhB,CAAlB;AACD;;AACD,SAAO,KAAP;AACD;;AChGD,IAAI,6DAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,oCAAoC,OAAO,+BAA+B,sBAAsB,8BAA8B,qBAAqB,OAAO,cAAc,QAAQ,yCAAyC,YAAY,mBAAmB,sCAAsC,mBAAmB,aAAa,6BAA6B,MAAM,YAAY,GAAG,wEAAwE,OAAO,UAAU,KAAK,mBAAmB,6CAA6C,OAAO,eAAe,QAAQ,yCAAyC,YAAY,mBAAmB,sCAAsC,wBAAwB,aAAa,mBAAmB,gBAAgB,MAAM;AACj0B,IAAI,sEAAe;;;;ACDnB,IAAI,mEAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,oBAAoB,OAAO,gCAAgC,oBAAoB,mBAAmB,eAAe,2BAA2B,WAAW,0DAA0D,OAAO,sSAAsS,4BAA4B,8BAA8B,eAAe,6FAA6F,OAAO,uCAAuC,KAAK,yBAAyB,yBAAyB,sBAAsB,+BAA+B,YAAY,eAAe,OAAO,2BAA2B,2EAA2E,OAAO,kBAAkB,QAAQ,2DAA2D,8BAA8B,qCAAqC,gIAAgI,OAAO,iTAAiT,6LAA6L,OAAO,+DAA+D,KAAK,8BAA8B,mCAAmC,IAAI,sBAAsB,yCAAyC,eAAe,OAAO,YAAY,gEAAgE,IAAI,sBAAsB,0CAA0C,eAAe,OAAO,YAAY,8FAA8F,OAAO,kCAAkC,KAAK,yBAAyB,oCAAoC,mCAAmC,OAAO,mCAAmC,KAAK,uBAAuB,mCAAmC,sEAAsE,OAAO,qCAAqC,KAAK,+CAA+C,QAAQ,+DAA+D,kCAAkC,yCAAyC,mCAAmC,OAAO,iKAAiK,KAAK,wBAAwB,gCAAgC,QAAQ,gEAAgE,mCAAmC,0CAA0C,aAAa,4CAA4C,kDAAkD,mEAAmE,OAAO,2BAA2B,0BAA0B,OAAO,YAAY,iBAAiB,OAAO,4BAA4B,KAAK,wBAAwB,gCAAgC,QAAQ,qDAAqD,wBAAwB,+BAA+B,kBAAkB,OAAO,YAAY,iBAAiB,OAAO,6BAA6B,KAAK,wBAAwB,gCAAgC,QAAQ,sDAAsD,yBAAyB,gCAAgC,kBAAkB,OAAO,YAAY,iBAAiB,OAAO,2BAA2B,KAAK,wBAAwB,gCAAgC,QAAQ,oDAAoD,uBAAuB,8BAA8B,sCAAsC,OAAO,+BAA+B;AACtzI,IAAI,4EAAe;;;;ACDnB,IAAI,2DAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,iBAAiB,wBAAwB,0BAA0B,QAAQ,+BAA+B,eAAe,0BAA0B,mDAAmD,eAAe,wBAAwB,mDAAmD,qEAAqE,OAAO,uBAAuB,KAAK,kCAAkC,yCAAyC,QAAQ,yBAAyB,QAAQ,mEAAmE,KAAK,4BAA4B,oFAAoF,qBAAqB;AAClyB,IAAI,oEAAe;;;;ACDnB,IAAI,iEAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,iBAAiB,iBAAiB,gBAAgB,sBAAsB,0CAA0C,kBAAkB,KAAK,2BAA2B,0BAA0B,0BAA0B,wBAAwB,6BAA6B,0BAA0B,2BAA2B,0BAA0B,YAAY,OAAO,8DAA8D,aAAa,OAAO,2WAA2W,gBAAgB,2CAA2C,mBAAmB,KAAK,2BAA2B,0BAA0B,0BAA0B,wBAAwB,6BAA6B,0BAA0B,2BAA2B,0BAA0B,YAAY,OAAO,8DAA8D,aAAa,OAAO,6WAA6W,gBAAgB,4CAA4C,oBAAoB,KAAK,2BAA2B,0BAA0B,0BAA0B,wBAAwB,6BAA6B,0BAA0B,2BAA2B,0BAA0B,YAAY,OAAO,8DAA8D,aAAa,OAAO,6WAA6W,gBAAgB,6CAA6C,qBAAqB,KAAK,2BAA2B,0BAA0B,0BAA0B,wBAAwB,6BAA6B,0BAA0B,2BAA2B,0BAA0B,YAAY,OAAO,8DAA8D,aAAa,OAAO,2WAA2W;AACjnG,IAAI,0EAAe;;;;;ACuEnB;AAIA,IAAqB,iBAAiB,GAAtC,MAAqB,iBAArB,SAA+C,kCAA/C,CAAkD;AAAlD;;AAGU,yBAAuC,IAAvC;AACA,2BAAiE,IAAjE;AACA,wBAA4C,IAA5C;AAgIT;;AAtHC,SAAO;AACL,SAAK,YAAL,GAAoB,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAApB;AACA,UAAM,CAAC,gBAAP,CAAwB,SAAxB,EAAmC,KAAK,YAAxC;AACA,UAAM,CAAC,gBAAP,CAAwB,UAAxB,EAAoC,KAAK,YAAzC;AACD;;AAED,SAAO;AACL,UAAM;AAAE,SAAF;AAAO,UAAP;AAAa,WAAb;AAAoB;AAApB,QAA+B,KAAK,OAA1C,CADK,CAEL;;AACA,SAAK,KAAL,CAAW,GAAX,CAAe,KAAf,CAAqB,GAArB,GAA2B,GAAG,GAAG,GAAjC;AACA,SAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB,CAAuB,KAAvB,GAA+B,GAAG,KAAK,GAAvC;AACA,SAAK,KAAL,CAAW,MAAX,CAAkB,KAAlB,CAAwB,MAAxB,GAAiC,GAAG,MAAM,GAA1C;AACA,SAAK,KAAL,CAAW,IAAX,CAAgB,KAAhB,CAAsB,IAAtB,GAA6B,GAAG,IAAI,GAApC;AACA,QAAI,MAAM,GAAG,GAAG,GAAG,CAAC,OAAO,MAAM,GAAG,GAAhB,CAAD,IAAyB,GAA5C;AACA,SAAK,KAAL,CAAW,IAAX,CAAgB,KAAhB,CAAsB,GAAtB,GAA4B,GAAG,MAAM,GAArC;AACA,SAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB,CAAuB,GAAvB,GAA6B,GAAG,MAAM,GAAtC;AACA,UAAM,GAAG,IAAI,GAAG,CAAC,OAAO,IAAI,GAAG,KAAd,CAAD,IAAyB,GAAzC;AACA,SAAK,KAAL,CAAW,GAAX,CAAe,KAAf,CAAqB,IAArB,GAA4B,GAAG,MAAM,GAArC;AACA,SAAK,KAAL,CAAW,MAAX,CAAkB,KAAlB,CAAwB,IAAxB,GAA+B,GAAG,MAAM,GAAxC;AACD;;AAED,eAAa;AACX,QAAI,KAAK,YAAT,EAAuB;AACrB,YAAM,CAAC,mBAAP,CAA2B,SAA3B,EAAsC,KAAK,YAA3C;AACA,YAAM,CAAC,mBAAP,CAA2B,UAA3B,EAAuC,KAAK,YAA5C;AACD;AACF;;AAED,WAAS,CAAC,KAAD,EAAa;AACpB,QAAI,KAAK,eAAL,KAAyB,IAA7B,EAAmC;AACjC,WAAK,eAAL,GAAuB,KAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB,CAAvB;AACD;;AACD,UAAM,SAAS,GAAG,KAAK,CAAC,IAAN,KAAe,WAAf,GAA6B,WAA7B,GAA2C,WAA7D;AACA,SAAK,aAAL,GAAqB,KAAK,CAAC,MAA3B;;AACA,QAAI,KAAK,eAAT,EAA0B;AACxB,YAAM,CAAC,gBAAP,CAAwB,SAAxB,EAAmC,KAAK,eAAxC;AACD;AACF;;AAED,SAAO,CAAC,KAAD,EAAa;AAClB,UAAM,SAAS,GAAG,KAAK,CAAC,IAAN,KAAe,SAAf,GAA2B,WAA3B,GAAyC,WAA3D;AACA,SAAK,aAAL,GAAqB,IAArB;;AACA,QAAI,KAAK,eAAT,EAA0B;AACxB,YAAM,CAAC,mBAAP,CAA2B,SAA3B,EAAsC,KAAK,eAA3C;AACD;AACF;;AAED,YAAU,CAAC,KAAD,EAA+B;AACvC,UAAM,OAAO,GAAG,KAAK,OAArB;AACA,UAAM,aAAa,GAAG,KAAK,KAAL,CAAW,GAAjC;AACA,UAAM,eAAe,GAAG,KAAK,KAAL,CAAW,KAAnC;AACA,UAAM,gBAAgB,GAAG,KAAK,KAAL,CAAW,MAApC;AACA,UAAM,cAAc,GAAG,KAAK,KAAL,CAAW,IAAlC;AACA,QAAI,QAAJ;;AACA,QAAI,EAAE,KAAK,YAAY,UAAnB,CAAJ,EAAoC;AAClC,cAAQ,GAAI,KAAoB,CAAC,OAArB,CAA6B,CAA7B,CAAZ;AACD,KAFD,MAEO;AACL,cAAQ,GAAG,KAAX;AACD;;AACD,UAAM;AAAE,aAAO,EAAE,CAAX;AAAc,aAAO,EAAE;AAAvB,QAA6B,QAAnC;AACA,UAAM,aAAa,GAAG,EAAtB;AACA,QAAI,kBAAkB,GAAG,EAAzB;AACA,UAAM,MAAM,GAAG,KAAK,KAAL,CAAW,GAAX,CAAe,qBAAf,EAAf;AACA,QAAI,MAAJ;;AACA,QAAI,KAAK,aAAT,EAAwB;AACtB,YAAM,CAAC,GAAc,MAArB;AACA,YAAM,CAAC,GAAc,OAArB;;AACA,cAAQ,KAAK,aAAL,CAAmB,EAA3B;AACE,aAAK,YAAL;AACE,4BAAkB,GAAG,OAAO,OAAO,CAAC,MAAR,GAAiB,aAAxB,CAArB;AACA,iBAAO,CAAC,GAAR,GAAc,IAAI,CAAC,GAAL,CACZ,kBADY,EAEZ,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,OAAO,CAAC,CAAC,GAAG,MAAM,CAAC,GAAZ,IAAmB,MAAM,CAAC,MAAjC,CAAZ,CAFY,CAAd;AAIA,uBAAa,CAAC,KAAd,CAAoB,GAApB,GAA0B,GAAG,OAAO,CAAC,GAAG,GAAxC;AACA,gBAAM,GAAG,OAAO,CAAC,GAAR,GAAc,CAAC,OAAO,OAAO,CAAC,MAAR,GAAiB,OAAO,CAAC,GAAhC,CAAD,IAAyC,GAAhE;AACA,wBAAc,CAAC,KAAf,CAAqB,GAArB,GAA2B,GAAG,MAAM,GAApC;AACA,yBAAe,CAAC,KAAhB,CAAsB,GAAtB,GAA4B,GAAG,MAAM,GAArC;AACA;;AACF,aAAK,cAAL;AACE,4BAAkB,GAAG,OAAO,OAAO,CAAC,CAAD,CAAP,GAAa,aAApB,CAArB;AACA,iBAAO,CAAC,CAAD,CAAP,GAAa,IAAI,CAAC,GAAL,CACX,kBADW,EAEX,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,OAAO,CAAC,MAAM,CAAC,KAAP,GAAe,CAAhB,IAAqB,MAAM,CAAC,KAAnC,CAAZ,CAFW,CAAb;AAIA,yBAAe,CAAC,KAAhB,CAAsB,KAAtB,GAA8B,GAAG,OAAO,CAAC,CAAD,CAAG,GAA3C;AACA,gBAAM,GAAG,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,OAAO,OAAO,CAAC,CAAD,CAAP,GAAa,OAAO,CAAC,CAAD,CAA3B,CAAD,IAAoC,GAA1D;AACA,uBAAa,CAAC,KAAd,CAAoB,IAApB,GAA2B,GAAG,MAAM,GAApC;AACA,0BAAgB,CAAC,KAAjB,CAAuB,IAAvB,GAA8B,GAAG,MAAM,GAAvC;AACA;;AACF,aAAK,eAAL;AACE,4BAAkB,GAAG,OAAO,OAAO,CAAC,GAAR,GAAc,aAArB,CAArB;AACA,iBAAO,CAAC,MAAR,GAAiB,IAAI,CAAC,GAAL,CACf,kBADe,EAEf,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,OAAO,CAAC,MAAM,CAAC,MAAP,GAAgB,CAAjB,IAAsB,MAAM,CAAC,MAApC,CAAZ,CAFe,CAAjB;AAIA,0BAAgB,CAAC,KAAjB,CAAuB,MAAvB,GAAgC,GAAG,OAAO,CAAC,MAAM,GAAjD;AACA,gBAAM,GAAG,OAAO,CAAC,GAAR,GAAc,CAAC,OAAO,OAAO,CAAC,MAAR,GAAiB,OAAO,CAAC,GAAhC,CAAD,IAAyC,GAAhE;AACA,wBAAc,CAAC,KAAf,CAAqB,GAArB,GAA2B,GAAG,MAAM,GAApC;AACA,yBAAe,CAAC,KAAhB,CAAsB,GAAtB,GAA4B,GAAG,MAAM,GAArC;AACA;;AACF,aAAK,aAAL;AACE,4BAAkB,GAAG,OAAO,OAAO,CAAC,CAAD,CAAP,GAAa,aAApB,CAArB;AACA,iBAAO,CAAC,CAAD,CAAP,GAAa,IAAI,CAAC,GAAL,CACX,kBADW,EAEX,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,OAAO,CAAC,CAAC,GAAG,MAAM,CAAC,IAAZ,IAAoB,MAAM,CAAC,KAAlC,CAAZ,CAFW,CAAb;AAIA,wBAAc,CAAC,KAAf,CAAqB,IAArB,GAA4B,GAAG,OAAO,CAAC,CAAD,CAAG,GAAzC;AACA,gBAAM,GAAG,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,OAAO,OAAO,CAAC,CAAD,CAAP,GAAa,OAAO,CAAC,CAAD,CAA3B,CAAD,IAAoC,GAA1D;AACA,uBAAa,CAAC,KAAd,CAAoB,IAApB,GAA2B,GAAG,MAAM,GAApC;AACA,0BAAgB,CAAC,KAAjB,CAAuB,IAAvB,GAA8B,GAAG,MAAM,GAAvC;AACA;AA5CJ,OAHsB,CAiDtB;;;AACA,WAAK,KAAL,CAAW,cAAX,EAA2B,OAA3B;AACA,WAAK,OAAL,CAAa,KAAb,CAAmB,cAAnB,EAAmC,OAAnC;AACD;AACF;;AApI+C,CAAlD;;AAC4B,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,gDAAkB,CAAlB;;AADP,iBAAiB,qCADrC,wCACqC,GAAjB,iBAAiB,CAAjB;gFAAA;;AC5Esb,CAAC,2FAAe,yCAAG,EAAC;;;;ACAnX;AACvC;AACL;AAChE,CAAsG;;;AAGtG;AACmG;AACnG,gBAAgB,sCAAU;AAC1B,EAAE,oDAAM;AACR,EAAE,iEAAM;AACR,EAAE,0EAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,mEAAe;;;ACUf;AACA;AAEA;AAIA,IAAqB,WAAW,GAAhC,MAAqB,WAArB,SAAyC,kCAAzC,CAA4C;AAA5C;;AAYU,2BAAkB,KAAlB;AAYA,kBAAmC;AAAE,OAAC,EAAE,CAAL;AAAQ,OAAC,EAAE;AAAX,KAAnC;AAiMT;;AArMa,MAAR,QAAQ;AACV,WAAO,oBAAP;AACD;;AAID,SAAO;AACL,UAAM,SAAS,GAAG,KAAK,KAAL,CAAW,SAA7B;AACA,aAAS,CAAC,KAAV,CAAgB,KAAhB,GAAwB,GAAG,MAAM,KAAK,KAAK,IAA3C;AACA,aAAS,CAAC,KAAV,CAAgB,MAAhB,GAAyB,GAAG,MAAM,KAAK,KAAK,IAA5C;;AAEA,QAAI,KAAK,UAAT,EAAqB;AACnB,eAAS,CAAC,gBAAV,CAA2B,WAA3B,EAAwC,KAAK,WAA7C;AACD;;AAED,QAAI,KAAK,KAAT,EAAgB;AACd,WAAK,aAAL,CAAmB,KAAK,KAAxB;AACA,WAAK,mBAAL;AACD;AACF;;AAED,aAAW,CAAC,CAAD,EAAc;AACvB,UAAM,IAAI,GAAI,CAAC,CAAC,MAAF,CAAyB,qBAAzB,EAAd;AACA,UAAM,CAAC,GAAG,IAAI,CAAC,KAAL,CACR,IAAI,CAAC,GAAL,CAAU,CAAC,CAAC,CAAC,OAAF,GAAY,IAAI,CAAC,CAAlB,IAAuB,IAAI,CAAC,KAA7B,GAAsC,GAA/C,EAAoD,GAApD,CADQ,CAAV;AAGA,UAAM,CAAC,GAAG,IAAI,CAAC,KAAL,CACR,IAAI,CAAC,GAAL,CAAU,CAAC,CAAC,CAAC,OAAF,GAAY,IAAI,CAAC,CAAlB,IAAuB,IAAI,CAAC,MAA7B,GAAuC,GAAhD,EAAqD,GAArD,CADQ,CAAV;AAGA,SAAK,MAAL,GAAc;AAAE,OAAF;AAAK;AAAL,KAAd;AACD;;AAED,eAAa;AACX,QAAI,KAAK,UAAT,EAAqB;AACnB,WAAK,KAAL,CAAW,SAAX,CAAqB,mBAArB,CAAyC,WAAzC,EAAsD,KAAK,WAA3D;AACD;AACF;;AAED,qBAAmB;AACjB,UAAM,QAAQ,GAAG,KAAK,KAAL,CAAW,YAA5B;AACA,UAAM,MAAM,GAAG,KAAK,KAAL,CAAW,UAA1B;AACA,UAAM,WAAW,GAAG,MAAM,CAAC,KAAP,GAAe,MAAM,CAAC,gBAA1C;AACA,UAAM,YAAY,GAAG,MAAM,CAAC,MAAP,GAAgB,MAAM,CAAC,gBAA5C;AACA,UAAM,OAAO,GAAG,MAAM,CAAC,UAAP,CAAkB,IAAlB,CAAhB;AACA,WAAO,CAAC,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,WAAxB,EAAqC,YAArC;;AACA,QAAI,KAAK,UAAT,EAAqB;AACnB,aAAO,CAAC,IAAR;AACA,YAAM,MAAM,GAAG,WAAW,IAAI,QAAQ,CAAC,MAAT,GAAkB,MAAM,CAAC,gBAA7B,CAA1B;AACA,YAAM,MAAM,GAAG,YAAY,IAAI,QAAQ,CAAC,KAAT,GAAiB,MAAM,CAAC,gBAA5B,CAA3B;AACA,aAAO,CAAC,KAAR,CAAc,MAAd,EAAsB,MAAtB;AACA,aAAO,CAAC,SAAR,GAAoB,sBAApB;AACA,aAAO,CAAC,SAAR;AACA,aAAO,CAAC,GAAR,CACE,KAAK,UAAL,CAAgB,MAAhB,CAAuB,CADzB,EAEE,KAAK,UAAL,CAAgB,MAAhB,CAAuB,CAFzB,EAGE,KAAK,UAAL,CAAgB,MAHlB,EAIE,CAJF,EAKE,IAAI,CAAC,EAAL,GAAU,CALZ;AAOA,aAAO,CAAC,IAAR;AACA,aAAO,CAAC,OAAR;AACD;;AACD,QAAI,KAAK,YAAT,EAAuB;AACrB,aAAO,CAAC,IAAR;AACA,YAAM,MAAM,GAAG,WAAW,IAAI,QAAQ,CAAC,MAAT,GAAkB,MAAM,CAAC,gBAA7B,CAA1B;AACA,YAAM,MAAM,GAAG,YAAY,IAAI,QAAQ,CAAC,KAAT,GAAiB,MAAM,CAAC,gBAA5B,CAA3B;AACA,aAAO,CAAC,KAAR,CAAc,MAAd,EAAsB,MAAtB;AACA,YAAM,IAAI,GAAG,KAAK,IAAlB;;AACA,UAAI,IAAJ,EAAU;AACR;AACA,eAAO,CAAC,SAAR,GAAoB,IAApB;;AACA,YAAI,IAAI,CAAC,OAAT,EAAkB;AAChB,cAAI,KAAK,GAAY,IAAI,CAAC,OAA1B;;AACA,cAAI,IAAI,CAAC,QAAL,IAAiB,GAArB,EAA0B;AACxB,mBAAO,CAAC,WAAR,GAAsB,KAAtB;AACA,mBAAO,CAAC,SAAR,GAAoB,GAApB;AACD,WAHD,MAGO,IAAI,IAAI,CAAC,QAAL,KAAkB,GAAtB,EAA2B;AAChC,mBAAO,CAAC,WAAR,GAAsB,MAAtB;AACD,WAFM,MAEA;AACL,mBAAO,CAAC,WAAR,GAAsB,QAAtB;AACA,iBAAK,GAAG,KAAR;AACD;;AACD,cAAI,KAAJ,EAAW;AACT,kBAAM,KAAK,GAAG,IAAI,CAAC,WAAnB;AAEA,mBAAO,CAAC,SAAR;AACA,mBAAO,CAAC,WAAR,GAAsB,sBAAtB;AACA,mBAAO,CAAC,SAAR,GAAoB,CAApB;AACA,mBAAO,CAAC,GAAR,CAAY,KAAK,CAAC,CAAN,GAAU,GAAtB,EAA2B,KAAK,CAAC,CAAN,GAAU,GAArC,EAA0C,CAA1C,EAA6C,CAA7C,EAAgD,IAAI,CAAC,EAAL,GAAU,CAA1D;AACA,mBAAO,CAAC,MAAR;AAEA,mBAAO,CAAC,SAAR;AACA,mBAAO,CAAC,MAAR,CAAe,IAAI,CAAC,IAAL,CAAU,UAAV,CAAqB,CAApC,EAAuC,IAAI,CAAC,IAAL,CAAU,UAAV,CAAqB,CAA5D;AACA,mBAAO,CAAC,MAAR,CAAe,IAAI,CAAC,IAAL,CAAU,OAAV,CAAkB,CAAjC,EAAoC,IAAI,CAAC,IAAL,CAAU,OAAV,CAAkB,CAAtD;AACA,mBAAO,CAAC,MAAR,CAAe,IAAI,CAAC,IAAL,CAAU,QAAV,CAAmB,CAAlC,EAAqC,IAAI,CAAC,IAAL,CAAU,QAAV,CAAmB,CAAxD;AACA,mBAAO,CAAC,MAAR,CAAe,IAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,CAArC,EAAwC,IAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,CAA9D;AACA,mBAAO,CAAC,MAAR,CAAe,IAAI,CAAC,IAAL,CAAU,UAAV,CAAqB,CAApC,EAAuC,IAAI,CAAC,IAAL,CAAU,UAAV,CAAqB,CAA5D;AACA,mBAAO,CAAC,MAAR;AACD;AACF;AACF;;AACD,aAAO,CAAC,OAAR;AACD;AAED;;;;;;;;;;;;;;;;;;;;;;;AAuBD;;AAEqB,MAAlB,kBAAkB;AACpB,UAAM,OAAO,GAAG,KAAK,OAArB;AACA,UAAM,KAAK,GAAG,GAAd;AACA,UAAM,MAAM,GAAG,GAAf;AACA,UAAM,eAAe,GAAG,KAAK,GAAG,GAAhC;AACA,UAAM,gBAAgB,GAAG,MAAM,GAAG,GAAlC;AACA,UAAM,MAAM,GAAG;AACb,QAAE,EAAE,IAAI,CAAC,KAAL,CAAW,eAAe,GAAG,OAAO,CAAC,IAArC,CADS;AAEb,QAAE,EAAE,KAAK,GAAG,IAAI,CAAC,KAAL,CAAW,eAAe,GAAG,OAAO,CAAC,KAArC,CAFC;AAGb,QAAE,EAAE,IAAI,CAAC,KAAL,CAAW,gBAAgB,GAAG,OAAO,CAAC,GAAtC,CAHS;AAIb,QAAE,EAAE,MAAM,GAAG,IAAI,CAAC,KAAL,CAAW,gBAAgB,GAAG,OAAO,CAAC,MAAtC;AAJA,KAAf;AAMA,WAAO,MAAP;AACD;;AAED,gBAAc;AACZ,SAAK,eAAL,GAAuB,CAAC,KAAK,eAA7B;;AACA,QAAI,CAAC,KAAK,eAAV,EAA2B;AACzB,WAAK,eAAL;AACD;AACF;;AAED,iBAAe;AACb,SAAK,OAAL,CAAa,KAAb,CAAmB,mBAAnB;AACD;;AAGD,eAAa,CAAC,IAAD,EAAkB;AAC7B,UAAM,MAAM,GAAG,KAAK,KAAL,CAAW,YAA1B;AACA,UAAM,OAAO,GAAG,MAAM,CAAC,UAAP,CAAkB,IAAlB,CAAhB;AACA,UAAM,OAAO,GAAG,OAAO,CAAC,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,MAAM,CAAC,KAAlC,EAAyC,MAAM,CAAC,MAAhD,CAAhB;AACA,UAAM,SAAS,GAAG,IAAlB;AACA,UAAM,GAAG,GAAG,KAAK,GAAjB;AACA,UAAM,GAAG,GAAG,KAAK,GAAjB;;AACA,QAAI,GAAG,KAAK,MAAM,CAAC,gBAAnB,EAAqC;AACnC,YAAM,IAAI,GAAG,IAAI,WAAJ,CAAgB,OAAO,CAAC,IAAR,CAAa,MAA7B,CAAb;AACA,YAAM,KAAK,GAAG,GAAG,GAAG,GAApB;;AACA,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,IAAI,CAAC,MAAzB,EAAiC,CAAC,EAAlC,EAAsC;AACpC,cAAM,CAAC,GAAG,IAAI,CAAC,GAAL,CACR,CADQ,EAER,IAAI,CAAC,GAAL,CAAS,GAAT,EAAe,CAAC,SAAS,CAAC,CAAD,CAAT,GAAe,GAAhB,IAAuB,KAAxB,GAAiC,KAA/C,CAFQ,CAAV;AAIA,YAAI,CAAC,CAAD,CAAJ,GAAW,OAAO,EAAR,GAAe,CAAC,IAAI,EAApB,GAA2B,CAAC,IAAI,CAAhC,GAAqC,CAA/C;AACD;;AACD,aAAO,CAAC,YAAR,CAAqB,OAArB,EAA8B,CAA9B,EAAiC,CAAjC;AACD;AACF;;AAGD,eAAa;AACX,SAAK,mBAAL;AACD;;AAGD,2BAAyB;AACvB,SAAK,mBAAL;AACD;;AAGD,eAAa;AACX,SAAK,mBAAL;AACD;;AAGD,eAAa,CAAC,OAAD,EAAiB;AAC5B,SAAK,mBAAL;AACA,WAAO,OAAP;AACD;;AAxNyC,CAA5C;;AACU,kCAAP,uCAAI,EAAG,wCAA2B,CAA3B;;AACkB,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,sCAAoB,CAApB;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,sCAAoB,CAApB;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,uCAA8B,CAA9B;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,0CAAyB,CAAzB;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,8CAA6B,CAA7B;;AACF,kCAAvB,uCAAI,CAAC;AAAE,SAAO,EAAE;AAAX,CAAD,CAAmB,wCAAsB,CAAtB;;AACG,kCAA1B,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAsB,6CAAkC,CAAlC;;AACD,kCAAzB,uCAAI,CAAC;AAAE,SAAO,EAAE;AAAX,CAAD,CAAqB,+CAA8B,CAA9B;;AACA,kCAAzB,uCAAI,CAAC;AAAE,SAAO,EAAE;AAAX,CAAD,CAAqB,4CAA2B,CAA3B;;AACA,kCAAzB,uCAAI,CAAC;AAAE,SAAO,EAAE;AAAX,CAAD,CAAqB,6CAA4B,CAA5B;;AAqK1B,kCADC,wCAAK,CAAC,OAAD,CACN,2CAmBC,IAnBD;;AAsBA,kCADC,wCAAK,CAAC,MAAD,CACN,2CAEC,IAFD;;AAKA,kCADC,wCAAK,CAAC,kBAAD,CACN,uDAEC,IAFD;;AAKA,kCADC,wCAAK,CAAC,SAAD,CACN,2CAEC,IAFD;;AAKA,kCADC,uCAAI,CAAC,cAAD,CACL,2CAGC,IAHD;;AArNmB,WAAW,qCAD/B,4CAAS,CAAC;AAAE,YAAU,EAAE;AAAE,qBAAiB;AAAnB;AAAd,CAAD,CACsB,GAAX,WAAW,CAAX;0EAAA;;ACpCgb,CAAC,qFAAe,mCAAG,EAAC;;;;;;;;;ACAnX;AACvC;AACL;AAC1D,CAAgG;;;AAGhG;AACmG;AACnG,IAAI,qBAAS,GAAG,sCAAU;AAC1B,EAAE,8CAAM;AACR,EAAE,2DAAM;AACR,EAAE,oEAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,6DAAe,qBAAS,QAAQ;;AAEhC;AACA,CAAmG;AAChD;AACE;AACrD,2BAAiB,CAAC,qBAAS,GAAG,IAAI,2BAAM,uBAAC;;;;;;;;;ACrBzC,MAAM,QAAQ,GACZ,mEADF;;AAEA,MAAM,eAAe,GAAI,QAAD,IACtB,+EAA+E,QAAQ,EADzF;;AAGO,MAAM,yBAAyB,GAAG;AACvC,QAAM,SAAN,CAAgB,QAAhB,EAAgC;AAC9B,UAAM,OAAO,GAAG,KAAK,CAAC,eAAe,CAAC,QAAD,CAAhB,EAA4B;AAC/C,YAAM,EAAE,KADuC;AAE/C,aAAO,EAAE;AACP,wBAAgB;AADT;AAFsC,KAA5B,CAArB;AAMA,UAAM,QAAQ,GAAG,MAAM,OAAvB;;AAEA,QAAI,QAAQ,CAAC,MAAT,KAAoB,GAAxB,EAA6B;AAC3B,YAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAT,EAAnB;AACA,aAAO,IAAP;AACD,KAHD,MAGO;AACL,aAAO,CAAC,KAAR,CAAc,QAAd;AACD;AACF;;AAhBsC,CAAlC;AAmBA,MAAM,YAAY,GAAG;AAC1B,QAAM,oBAAN,CACE,QADF,EAEE,YAFF,EAGE,IAHF,EAIE,gCAJF,EAKE,IALF,EAKe;AAEb,QAAI,QAAQ,KAAK,EAAjB,EAAqB;AACnB,YAAM,UAAU,GAAG,IAAI,CAAC,KAAL,CAAW,SAAX,CAAqB,UAAxC;AACA,YAAM,OAAO,GACX,UAAU,CAAC,QAAX,CAAoB,MAApB,KAA+B,UAAU,CAAC,QAAX,CAAoB,SAApB,CAA/B,GACI,MADJ,GAEI,QAHN;AAIA,YAAM,OAAO,GAAG,KAAK,CAAC,QAAD,EAAW;AAC9B,cAAM,EAAE,MADsB;AAE9B,YAAI,EAAE,IAAI,CAAC,SAAL;AACJ,iBADI;AAEJ,kBAAQ,EAAE,GAAG,QAAQ,EAFjB;AAGJ,cAAI,EAAE,QAHF;AAIJ,mBAAS,EAAE,IAAI,CAAC,SAAL,CACR,WADQ,GAER,OAFQ,CAEA,IAFA,EAEM,GAFN,EAGR,OAHQ,CAGA,KAHA,EAGO,GAHP,CAJP;AAQJ,8BAAoB,EAAE,IAAI,CAAC,eARvB;AASJ,oBAAU,EAAE,UATR;AAUJ,wBAAc,EAAE,gCAVZ;AAWJ,cAAI,EAAE;AACJ,gBAAI,EAAE;AACJ,gBAAE,EAAE,IAAI,CAAC,IAAL,CAAU,IAAV,CAAe,OADf;AAEJ,gBAAE,EAAE,IAAI,CAAC,IAAL,CAAU,IAAV,CAAe,QAFf;AAGJ,gBAAE,EAAE,IAAI,CAAC,IAAL,CAAU,IAAV,CAAe,UAHf;AAIJ,gBAAE,EAAE,IAAI,CAAC,IAAL,CAAU,IAAV,CAAe;AAJf,aADF;AAOJ,kBAAM,EAAE;AAAE,eAAC,EAAE,IAAI,CAAC,OAAV;AAAmB,eAAC,EAAE,IAAI,CAAC;AAA3B,aAPJ;AAQJ,qBAAS,EAAE,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,mBAAhB,CARP;AASJ,mBAAO,EAAE,IAAI,CAAC,gBAAL,CAAsB,IAT3B;AAUJ,kBAAM,EAAE,IAAI,CAAC,gBAAL,CAAsB,GAV1B;AAWJ,qBAAS,EAAE,IAAI,CAAC,KAAL,CAAW,SAAX,CAAqB;AAX5B;AAXF,WAwBA,IAAI,IAAI;AAAE;AAAF,SAxBR;AAFwB,OAAX,CAArB;AA6BA,YAAM,QAAQ,GAAG,MAAM,OAAvB;AACA,YAAM,YAAY,GAAG,MAAM,QAAQ,CAAC,IAAT,EAA3B,CApCmB,CAqCnB;;AACA,UAAI,YAAJ,EAAkB;AAChB;AACA,aAAK,CAAC,YAAD,EAAe;AAClB,gBAAM,EAAE,KADU;AAElB,cAAI,EAAE,IAAI,CAAC,KAAL,CAAW,KAFC;AAGlB,iBAAO,EAAE;AACP,4BAAgB,0BADT;AAEP,gCAAoB;AAFb;AAHS,SAAf,CAAL;AAQD;AACF,KAjDD,MAiDO;AACL,aAAO,CAAC,KAAR,CAAc,wCAAd;AACD;AACF,GA5DyB;;AA6D1B,QAAM,sBAAN,CACE,QADF,EAEE,YAFF,EAGE,kBAHF,EAIE,gBAJF,EAKE,WALF,EAME,KANF,EAOE,CAPF,EAQE,CARF,EAQW;AAET,QAAI,QAAQ,KAAK,EAAjB,EAAqB;AACnB,YAAM,UAAU,GAAG,KAAK,CAAC,SAAN,CAAgB,UAAnC;AACA,YAAM,OAAO,GACX,UAAU,CAAC,QAAX,CAAoB,MAApB,KAA+B,UAAU,CAAC,QAAX,CAAoB,SAApB,CAA/B,GACI,MADJ,GAEI,QAHN;AAIA,YAAM,kBAAkB,GAAG;AACzB,eADyB;AAEzB,gBAAQ,EAAE,GAAG,QAAQ,EAFI;AAGzB,YAAI,EAAE,WAHmB;AAIzB,iBAAS,EAAE,WAAW,CAAC,SAAZ,CACR,WADQ,GAER,OAFQ,CAEA,IAFA,EAEM,GAFN,EAGR,OAHQ,CAGA,KAHA,EAGO,GAHP,CAJc;AAQzB,sBAAc,EAAE,UAAU,CACxB,WAAW,CAAC,sBAAZ,CAAmC,GAAnC,CAAuC,OAAvC,CAA+C,CAA/C,CADwB,CARD;AAWzB,yBAAiB,EAAE,WAAW,CAAC,iBAXN;AAYzB,sBAAc,EAAE,UAAU,CACxB,WAAW,CAAC,qBAAZ,CAAkC,GAAlC,CAAsC,OAAtC,CAA8C,CAA9C,CADwB,CAZD;AAezB,kBAAU,EAAE,UAfa;AAgBzB,YAAI,EAAE;AACJ,cAAI,EAAE,WAAW,CAAC,IADd;AAEJ,gBAAM,EAAE;AAAE,aAAF;AAAK;AAAL,WAFJ;AAGJ,mBAAS,EAAE,IAAI,CAAC,KAAL,CAAW,WAAW,CAAC,0BAAvB,CAHP;AAIJ,gBAAM,EAAE,IAAI,CAAC,KAAL,CAAW,WAAW,CAAC,wBAAvB,CAJJ;AAKJ,mBAAS,EAAE,KAAK,CAAC,SAAN,CAAgB;AALvB;AAhBmB,OAA3B;AAwBA,YAAM,OAAO,GAAG,KAAK,CAAC,QAAD,EAAW;AAC9B,cAAM,EAAE,MADsB;AAE9B,YAAI,EAAE,IAAI,CAAC,SAAL,CAAe,kBAAf;AAFwB,OAAX,CAArB;AAIA,YAAM,QAAQ,GAAG,MAAM,OAAvB,CAlCmB,CAmCnB;;AACA,UAAI,QAAQ,CAAC,MAAT,KAAoB,GAApB,IAA2B,kBAA/B,EAAmD;AACjD,cAAM,YAAY,GAAG,MAAM,QAAQ,CAAC,IAAT,EAA3B,CADiD,CAEjD;;AACA,YAAI,YAAJ,EAAkB;AAChB;AACA,eAAK,CAAC,YAAD,EAAe;AAClB,kBAAM,EAAE,KADU;AAElB,gBAAI,EAAE,KAAK,CAAC,KAFM;AAGlB,mBAAO,EAAE;AACP,8BAAgB,0BADT;AAEP,kCAAoB;AAFb;AAHS,WAAf,CAAL;AAQD;AACF;AACF,KAnDD,MAmDO;AACL,aAAO,CAAC,KAAR,CAAc,gDAAd;AACD;AACF;;AA7HyB,CAArB;AAgIA,MAAM,SAAS,GAAG;AACvB;AACA,oBAAkB,EAAE,KAFG;AAGvB,2BAAyB,EAAE,IAHJ;AAIvB,cAAY,EAAE,KAJS;;AAKvB,MAAI,yBAAJ,GAA6B;AAC3B,WAAO,KAAK,yBAAZ;AACD,GAPsB;;AAQvB,MAAI,yBAAJ,CAA8B,OAA9B,EAA8C;AAC5C,SAAK,yBAAL,GAAiC,OAAjC;AACA,SAAK,aAAL,CAAmB,KAAnB;AACD,GAXsB;;AAYvB,MAAI,YAAJ,GAAgB;AACd,WAAO,KAAK,YAAZ;AACD,GAdsB;;AAevB,MAAI,YAAJ,CAAiB,MAAjB,EAAgC;AAC9B,SAAK,YAAL,GAAoB,MAApB;AACA,UAAM,CAAC,YAAP,CAAoB,OAApB,CAA4B,cAA5B,EAA4C,MAAM,GAAG,MAAH,GAAY,OAA9D;AACD,GAlBsB;;AAmBvB,MAAI,kBAAJ,GAAsB;AACpB,WAAO,KAAK,kBAAZ;AACD,GArBsB;;AAsBvB,MAAI,kBAAJ,CAAuB,MAAvB,EAAsC;AACpC,SAAK,kBAAL,GAA0B,MAA1B;AACA,UAAM,CAAC,YAAP,CAAoB,OAApB,CACE,oBADF,EAEE,MAAM,GAAG,MAAH,GAAY,OAFpB;AAIA,SAAK,aAAL,CAAmB,KAAnB;AACD,GA7BsB;;AA8BvB,MAAI,WAAJ,GAAe;AACb,QAAI,MAAM,CAAC,QAAP,CAAgB,IAAhB,KAAyB,MAAzB,IAAmC,MAAM,CAAC,QAAP,CAAgB,IAAhB,KAAyB,MAAhE,EAAwE;AACtE;AACA;AACA;AACA;AACA,aAAO,sBAAP,CALsE,CAMtE;AACA;AACA;AACD;;AACD,WAAO,EAAP;AACD,GA1CsB;;AA2CvB,MAAI,gBAAJ,GAAoB;AAClB,WAAO,GAAG,KAAK,WAAW,cAA1B;AACD,GA7CsB;;AA8CvB,MAAI,WAAJ,GAAe;AACb,WAAO,GAAG,KAAK,WAAW,kBAA1B;AACD,GAhDsB;;AAiDvB,MAAI,WAAJ,GAAe;AACb,WAAO,GAAG,KAAK,WAAW,YAA1B;AACD,GAnDsB;;AAoDvB,MAAI,OAAJ,GAAW;AACT,WAAO,GAAG,KAAK,WAAW,qBAA1B;AACD,GAtDsB;;AAuDvB,MAAI,aAAJ,GAAiB;AACf,WAAO,GAAG,KAAK,WAAW,aAA1B;AACD,GAzDsB;;AA0DvB,MAAI,YAAJ,GAAgB;AACd,WAAO,GAAG,KAAK,WAAW,mBAA1B;AACD,GA5DsB;;AA6DvB,MAAI,gBAAJ,GAAoB;AAClB,WAAO,GAAG,KAAK,WAAW,uBAA1B;AACD,GA/DsB;;AAgEvB,MAAI,gBAAJ,GAAoB;AAClB,WAAO,GAAG,KAAK,WAAW,sBAA1B;AACD,GAlEsB;;AAmEvB,MAAI,eAAJ,GAAmB;AACjB,WAAO,GAAG,KAAK,WAAW,iBAA1B;AACD,GArEsB;;AAsEvB,MAAI,eAAJ,GAAmB;AACjB,WAAO,GAAG,KAAK,WAAW,oBAA1B;AACD,GAxEsB;;AAyEvB,MAAI,cAAJ,GAAkB;AAChB,WAAO,GAAG,KAAK,WAAW,iCAA1B;AACD,GA3EsB;;AA4EvB,MAAI,kBAAJ,GAAsB;AACpB,WAAO,GAAG,KAAK,WAAW,iCAA1B;AACD,GA9EsB;;AA+EvB,QAAM,GAAN,CAAU,GAAV,EAAqB;AACnB,WAAO,KAAK,CAAC,GAAD,EAAM;AAChB,YAAM,EAAE,KADQ;AAEhB,aAAO,EAAE;AACP,qBAAa,EAAE,SAAS,IAAI,CAAC,gBAAD,CAAkB;AADvC;AAFO,KAAN,CAAZ;AAMD,GAtFsB;;AAuFvB,QAAM,IAAN,CACE,GADF,EAEE,IAFF,EASU;AAER,WAAO,KAAK,CAAC,GAAD,EAAM;AAChB,YAAM,EAAE,MADQ;AAEhB,aAAO,EAAE;AACP,qBAAa,EAAE,SAAS,IAAI,CAAC,gBAAD,CAAkB,EADvC;AAEP,wBAAgB;AAFT,OAFO;AAMhB,UAAI,EAAE;AANU,KAAN,CAAZ;AAQD,GA1GsB;;AA2GvB,QAAM,GAAN,CAAU,GAAV,EAAqB;AACnB,WAAO,KAAK,CAAC,GAAD,EAAM;AAChB,YAAM,EAAE,KADQ;AAEhB,aAAO,EAAE;AACP,qBAAa,EAAE,SAAS,IAAI,CAAC,gBAAD,CAAkB,EADvC;AAEP,wBAAgB;AAFT;AAFO,KAAN,CAAZ;AAOD,GAnHsB;;AAoHvB,QAAM,OAAN,CAAc,GAAd,EAAyB;AACvB,UAAM,QAAQ,GAAG,MAAM,KAAK,GAAL,CAAS,GAAT,CAAvB;;AACA,QAAI;AACF,aAAO,QAAQ,CAAC,IAAT,EAAP;AACD,KAFD,CAEE,OAAO,CAAP,EAAU;AACV,aAAO,EAAP;AACD;AACF,GA3HsB;;AA4HvB,QAAM,OAAN,CAAc,GAAd,EAAyB;AACvB,UAAM,QAAQ,GAAG,MAAM,KAAK,GAAL,CAAS,GAAT,CAAvB;AACA,WAAO,QAAQ,CAAC,IAAT,EAAP;AACD,GA/HsB;;AAgIvB,QAAM,eAAN,GAAqB;AAKnB,WAAO,KAAK,OAAL,CAAa,KAAK,gBAAlB,CAAP;AACD,GAtIsB;;AAuIvB,QAAM,cAAN,GAAoB;AAClB,UAAM,MAAM,GAAG,MAAM,KAAK,OAAL,CAAa,KAAK,eAAlB,CAArB;AACA,WAAO,MAAM,KAAK,OAAlB;AACD,GA1IsB;;AA2IvB,QAAM,aAAN,CAAoB,QAAQ,GAAG,IAA/B,EAAmC;AACjC,UAAM,MAAM,GAAG,MAAM,KAAK,OAAL,CACnB,QAAQ,GAAG,KAAK,kBAAR,GAA6B,KAAK,cADvB,CAArB;AAGA,WAAO,MAAP;AACD,GAhJsB;;AAiJvB,QAAM,UAAN,GAAgB;AAMd,WAAO,KAAK,OAAL,CAAa,KAAK,WAAlB,CAAP;AACD,GAxJsB;;AAyJvB,QAAM,UAAN,GAAgB;AACd,WAAO,KAAK,OAAL,CAAa,KAAK,WAAlB,CAAP;AACD,GA3JsB;;AA4JvB,QAAM,cAAN,GAAoB;AAClB,WAAO,KAAK,OAAL,CAAa,KAAK,eAAlB,CAAP;AACD,GA9JsB;;AA+JvB,QAAM,YAAN,GAAkB;AAChB,WAAO,KAAK,OAAL,CAAa,KAAK,aAAlB,CAAP;AACD,GAjKsB;;AAkKvB,QAAM,MAAN,GAAY;AACV,WAAO,CAAC,GAAR,CAAY,aAAZ;AACA,WAAO,KAAK,GAAL,CAAS,KAAK,OAAd,CAAP;AACD,GArKsB;;AAsKvB,QAAM,WAAN,GAAiB;AAIf,WAAO,KAAK,OAAL,CAAa,KAAK,YAAlB,CAAP;AACD,GA3KsB;;AA4KvB,QAAM,eAAN,CAAsB,IAAtB,EAA2C;AACzC;AACA,UAAM,QAAQ,GAAG,IAAI,eAAJ,EAAjB;AACA,YAAQ,CAAC,MAAT,CAAgB,aAAhB,EAA+B,IAAI,CAAC,SAAL,CAAe,IAAf,CAA/B;AACA,WAAO,KAAK,IAAL,CAAU,KAAK,gBAAf,EAAiC,QAAjC,CAAP;AACD,GAjLsB;;AAkLvB,QAAM,cAAN,GAAoB;AAClB,WAAO,KAAK,OAAL,CAAa,KAAK,gBAAlB,CAAP;AACD;;AApLsB,CAAlB;;;ACbP;AACA;AAQA;AACA;AACA;AACA;AACA;AAKA,IAAqB,mBAAmB,GAAxC,MAAqB,mBAArB,SAAiD,kCAAjD,CAAoD;AAApD;;AACU,qCAA4B,KAA5B;AACA,sCAA6B,CAA7B;AACA,iCAAwB,KAAxB;AACA,yBAAgC,IAAhC;AACA,6BAAoC,IAAI,cAAJ,CAAmB,CAAnB,CAApC;AACA,8BAAqC,IAAI,cAAJ,CAAmB,CAAnB,CAArC;AACA,kCAAgD,IAAhD;AACA,2BAAkB,IAAlB;AACA,4BAAmB,IAAnB;AACA,0BAAiB,IAAjB;AACA,sBAAa,EAAb;AACA,oBAAW,EAAX;AACA,oBAAW,EAAX;AA2NA,kBAAS,KAAT;AAcT;;AAvOC,mCAAiC,CAAC,GAAD,EAAa;AAC5C,QAAI,GAAJ,EAAS;AACP,WAAK,0BAAL,GAAkC,KAAK,KAAL,CAAW,kBAAX,CAA8B,iBAAhE;AACD;;AACD,QAAI,CAAC,GAAL,EAAU;AACR,WAAK,0BAAL,GAAkC,2BAAlC;AACD;;AACD,SAAK,eAAL,GAP4C,CAQ5C;AACD;;AAE2B,MAAxB,wBAAwB;AAC1B,WAAO,GAAG,IAAI,cAAJ,CAAmB,KAAK,0BAAxB,CAAmD,EAA7D;AACD;;AAEe,MAAZ,YAAY;AACd,UAAM,QAAQ,GAAG;AACf,UAAI,EAAE,KAAK,KAAL,CAAW,kBAAX,CAA8B,IADrB;AAEf,0BAAoB,EAAE,KAAK,KAAL,CAAW,kBAAX,CAA8B,iBAFrC;AAGf,iBAAW,EAAE,UAAU,CACrB,KAAK,KAAL,CAAW,kBAAX,CAA8B,sBAA9B,CAAqD,GAArD,CAAyD,OAAzD,CAAiE,CAAjE,CADqB,CAHR;AAMf,YAAM,EAAE;AACN,eAAO,EAAE,KAAK,KAAL,CAAW,kBAAX,CAA8B,gBADjC;AAEN,cAAM,EAAE,KAAK,KAAL,CAAW,kBAAX,CAA8B,eAFhC;AAGN,aAAK,EAAE,KAAK,KAAL,CAAW,kBAAX,CAA8B;AAH/B;AANO,KAAjB;AAYA,UAAM,MAAM,GAAG;AACb,UAAI,EAAE,KAAK,KAAL,CAAW,kBAAX,CAA8B,IADvB;AAEb,0BAAoB,EAAE,KAAK,0BAFd;AAGb,iBAAW,EAAE,UAAU,CAAC,KAAK,iBAAL,CAAuB,GAAvB,CAA2B,OAA3B,CAAmC,CAAnC,CAAD,CAHV;AAIb,YAAM,EAAE;AACN,eAAO,EAAE,KAAK,gBADR;AAEN,cAAM,EAAE,KAAK,eAFP;AAGN,aAAK,EAAE,KAAK;AAHN;AAJK,KAAf;AAUA,UAAM,CAAC,GAAG,IAAI,CAAC,SAAL,CAAe,MAAf,CAAV;AACA,UAAM,CAAC,GAAG,IAAI,CAAC,SAAL,CAAe,QAAf,CAAV;AACA,WAAO,CAAC,IAAI,CAAZ;AACD;;AAEW,MAAR,QAAQ;AACV,WAAO,oBAAP;AACD;;AAEa,MAAV,UAAU;AACZ,WAAO,qBAAP;AACD;;AAEY,MAAT,SAAS;AACX,WAAO,qBAAP;AACD;;AAEQ,MAAL,KAAK;AACP,WAAO,KAAP;AACD;;AAEe,MAAZ,YAAY;AACd,WAAO,KAAK,oBAAL,KAA8B,IAArC;AACD;;AAEiB,MAAd,cAAc;AAChB,WAAO,KAAK,KAAL,CAAW,qBAAlB;AACD;;AAEuB,MAApB,oBAAoB;AACtB,WAAO,KAAK,KAAL,CAAW,qBAAlB;AACD;;AAEc,MAAX,WAAW;AACb,WAAO,KAAK,kBAAZ;AACD;;AAED,iBAAe;AACb,SAAK,iBAAL,GAAyB,IAAI,cAAJ,CAAmB,KAAK,WAAL,CAAiB,GAApC,CAAzB;AACA,SAAK,sBAAL,GAA8B,KAAK,oBAAnC;AACA,SAAK,qBAAL,GAA6B,IAA7B;AACD;;AAEsB,QAAjB,iBAAiB;AACrB,SAAK,kBAAL,GAA0B,IAAI,cAAJ,CAAmB,KAAK,iBAAL,CAAuB,GAA1C,CAA1B;AACA,SAAK,qBAAL,GAA6B,KAA7B;AACA,UAAM,KAAK,eAAL,EAAN;AACD;;AAEoB,QAAf,eAAe;AACnB;AACA,UAAM,kBAAkB,GAAG,KAAK,kBAAhC;AACA,QAAI,cAAc,GAAG,KAAK,KAAL,CAAW,kBAAX,CAA8B,qBAA9B,CAClB,GADH;AAEA,QAAI,aAAa,GAAG,KAAK,KAAL,CAAW,kBAAX,CAA8B,wBAAlD;AACA,QAAI,YAAY,GAAG,KAAK,KAAL,CAAW,kBAAX,CAA8B,0BAAjD;AACA,UAAM,iBAAiB,GAAG,KAAK,0BAA/B;AACA,QAAI,OAAO,GAAG,CAAC,CAAf;AACA,QAAI,OAAO,GAAG,CAAC,CAAf;AACA,QAAI,KAAK,GAAG,KAAK,KAAL,CAAW,YAAvB;AACA,QAAI,IAAI,GAAG;AACT,QAAE,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX,OADK;AAET,QAAE,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX,OAFK;AAGT,QAAE,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX,OAHK;AAIT,QAAE,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX;AAJK,KAAX;;AAMA,QAAI,KAAK,sBAAT,EAAiC;AAC/B,WAAK,GAAG,KAAK,sBAAL,CAA4B,KAApC;AACA,UAAI,GAAG;AACL,UAAE,EAAE,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAsC,OADrC;AAEL,UAAE,EAAE,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAsC,QAFrC;AAGL,UAAE,EAAE,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAsC,UAHrC;AAIL,UAAE,EAAE,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAsC;AAJrC,OAAP;AAMA,mBAAa,GAAG,KAAK,sBAAL,CAA4B,gBAA5B,CAA6C,GAA7D;AACA,kBAAY,GAAG,KAAK,sBAAL,CAA4B,mBAA3C;AACA,oBAAc,GACZ,kBAAkB,CAAC,GAAnB,GAAyB,CAAC,YAAY,GAAG,aAAhB,IAAiC,IAD5D;AAEA,aAAO,GAAG,KAAK,sBAAL,CAA4B,OAAtC;AACA,aAAO,GAAG,KAAK,sBAAL,CAA4B,OAAtC;AACD;;AACD,UAAM,SAAS,GAAG,IAAI,IAAJ,EAAlB;AACA,UAAM,kBAAkB,GACtB,kBAAkB,CAAC,GAAnB,KACA,KAAK,KAAL,CAAW,kBAAX,CAA8B,sBAA9B,CAAqD,GAFvD;AAGA,UAAM,gBAAgB,GACpB,iBAAiB,KAAK,KAAK,KAAL,CAAW,kBAAX,CAA8B,iBADtD;AAEA,UAAM,iBAAiB,GACrB,IAAI,CAAC,SAAL,CAAe,IAAf,MACA,IAAI,CAAC,SAAL,CAAe,KAAK,KAAL,CAAW,kBAAX,CAA8B,IAA7C,CAFF;;AAGA,QAAI,kBAAkB,IAAI,gBAAtB,IAA0C,iBAA9C,EAAiE;AAC/D;AACA,0CACE,KAAK,QADP,EAEE,KAAK,QAFP,EAGE,kBAHF,EAIE,gBAJF,EAKE;AACE,YADF;AAEE,iBAAS,EAAE,SAFb;AAGE,8BAAsB,EAAE,kBAH1B;AAIE,kCAA0B,EAAE,YAJ9B;AAKE,6BAAqB,EAAE,IAAI,cAAJ,CAAmB,cAAnB,CALzB;AAME,gCAAwB,EAAE,aAN5B;AAOE,yBAPF;AAQE,sBAAc,EAAE,KAAK,cARvB;AASE,wBAAgB,EAAE,KAAK,gBATzB;AAUE,uBAAe,EAAE,KAAK;AAVxB,OALF,EAiBE,KAjBF,EAkBE,OAlBF,EAmBE,OAnBF;AAqBD;;AACD;AACE;AACA,oDAA8C,cAA9C;AACA,wDAAkD,UAAU,CAC1D,kBAAkB,CAAC,GAAnB,CAAuB,OAAvB,CAA+B,CAA/B,CAD0D,CAA5D;AAGA,mDAA6C,KAAK,cAAlD;AACA,oDAA8C,KAAK,eAAnD;AACA,qDAA+C,KAAK,gBAApD;AACD;AACD,UAAM,cAAc,GAAG;AACrB,uBAAiB,EAAE,iBADE;AAErB,oBAAc,EAAE,cAFK;AAGrB,wBAAkB,EAAE,UAAU,CAAC,kBAAkB,CAAC,GAAnB,CAAuB,OAAvB,CAA+B,CAA/B,CAAD,CAHT;AAIrB,aAAO,EAAE,IAAI,CAAC,EAAL,CAAQ,CAJI;AAKrB,aAAO,EAAE,IAAI,CAAC,EAAL,CAAQ,CALI;AAMrB,aAAO,EAAE,IAAI,CAAC,EAAL,CAAQ,CANI;AAOrB,aAAO,EAAE,IAAI,CAAC,EAAL,CAAQ,CAPI;AAQrB,aAAO,EAAE,IAAI,CAAC,EAAL,CAAQ,CARI;AASrB,aAAO,EAAE,IAAI,CAAC,EAAL,CAAQ,CATI;AAUrB,aAAO,EAAE,IAAI,CAAC,EAAL,CAAQ,CAVI;AAWrB,aAAO,EAAE,IAAI,CAAC,EAAL,CAAQ,CAXI;AAYrB,mBAAa,EAAE,KAAK,KAAL,CAAW,IAZL;AAarB,8BAAwB,EAAE,KAAK,KAAL,CAAW,YAAX,CAAyB,SAAzB,CACvB,aAdkB;AAerB,kBAAY,EAAE,SAAS,CAAC,OAAV,EAfO;AAgBrB,mBAAa,EAAE,YAhBM;AAiBrB,oBAAc,EAAE,KAAK,eAjBA;AAkBrB,qBAAe,EAAE,KAAK,gBAlBD;AAmBrB,mBAAa,EAAE,KAAK;AAnBC,KAAvB;AAqBA,WAAO,0BAA0B,cAA1B,CAAP;AACD;;AAED,sBAAoB,CAAC,MAAD,EAAe;AACjC,SAAK,iBAAL,GAAyB,IAAI,cAAJ,CACvB,KAAK,iBAAL,CAAuB,GAAvB,GAA6B,MADN,CAAzB;AAGD;;AAED,mBAAiB,CAAC,KAAD,EAAkB;AACjC,UAAM,KAAK,GAAI,KAAK,CAAC,MAAN,CAAkC,KAAlC,CACZ,OADY,CACJ,OADI,EACK,EADL,EAEZ,OAFY,CAEJ,GAFI,EAEC,EAFD,CAAf;;AAGA,QAAI,KAAK,CAAC,MAAM,CAAC,KAAD,CAAP,CAAT,EAA0B;AACxB,WAAK,iBAAL,GAAyB,IAAI,cAAJ,CAAmB,EAAnB,CAAzB;AACD;;AACD,SAAK,iBAAL,GAAyB,IAAI,cAAJ,CAAmB,MAAM,CAAC,KAAD,CAAzB,CAAzB;AACD;;AAED,YAAU;AACR,SAAK,kBAAL,GAA0B,IAAI,cAAJ,CACxB,KAAK,KAAL,CAAW,kBAAX,CAA8B,sBAA9B,CAAqD,GAD7B,CAA1B;AAGA,SAAK,iBAAL,GAAyB,IAAI,cAAJ,CACvB,KAAK,KAAL,CAAW,kBAAX,CAA8B,sBAA9B,CAAqD,GAD9B,CAAzB;AAGA,SAAK,0BAAL,GAAkC,KAAK,KAAL,CAAW,kBAAX,CAA8B,iBAAhE;AACA,SAAK,yBAAL,GACE,KAAK,0BAAL,KAAoC,2BADtC;AAEA,SAAK,eAAL,GAAuB,KAAK,KAAL,CAAW,kBAAX,CAA8B,eAArD;AACA,SAAK,gBAAL,GAAwB,KAAK,KAAL,CAAW,kBAAX,CAA8B,gBAAtD;AACA,SAAK,cAAL,GAAsB,KAAK,KAAL,CAAW,kBAAX,CAA8B,cAApD;AACD;;AAGc,QAAT,SAAS;AACb,SAAK,MAAL,GAAc,IAAd;AACA,UAAM,KAAK,eAAL,EAAN;AACA,SAAK,MAAL,GAAc,KAAd;AACD;;AAEgB,QAAX,WAAW;AACf,UAAM;AAAE,cAAF;AAAY,gBAAZ;AAAwB;AAAxB,QAAmC,MAAM,sBAA/C;AACA,SAAK,QAAL,GAAgB,QAAhB;AACA,SAAK,UAAL,GAAkB,UAAlB;AACA,SAAK,QAAL,GAAgB,MAAhB;AACA,SAAK,UAAL;AACD;;AArPiD,CAApD;AAAqB,mBAAmB,qCAHvC,4CAAS,CAAC;AACT,YAAU,EAAE;AAAE,eAAW;AAAb;AADH,CAAD,CAG8B,GAAnB,mBAAmB,CAAnB;kFAAA;;ACjKwb,CAAC,6FAAe,2CAAG,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;ACAnX;AACvC;AACL;AAClE,CAAwG;;;AAGxG;AACmG;AACnG,IAAI,6BAAS,GAAG,sCAAU;AAC1B,EAAE,sDAAM;AACR,EAAE,mEAAM;AACR,EAAE,4EAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,qEAAe,6BAAS,QAAQ;;AAEhC;AACA,CAAmG;AAChD;AACE;AACO;AACC;AACJ;AACC;AACG;AACT;AACM;AACD;AACJ;AACM;AACP;AACK;AACF;AACE;AACM;AAC/D,2BAAiB,CAAC,6BAAS,GAAG,IAAI,2BAAM,mCAAa,qDAAc,kDAAU,+CAAW,+CAAU,+BAAK,gCAAW,mCAAQ,8BAAM,+BAAS,8BAAK,6BAAQ,gCAAQ,gCAAQ,mCAAW,4BAAC;;;ACxClL,IAAI,0DAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,oBAAoB,OAAO,WAAW,mCAAmC,qBAAqB,4BAA4B,sCAAsC,wBAAwB,qCAAqC,wBAAwB;AAC9U;AACA;AACA,gBAAgB,SAAS,oEAAoE,MAAM,YAAY,wBAAwB;AACvI,IAAI,mEAAe;;;;;;;;;;;ACkBnB;AAEA;AACA;AAIA,IAAqB,UAAU,GAA/B,MAAqB,UAArB,SAAwC,kCAAxC,CAA2C;AAA3C;;AACU,gBAIJ,EAJI;AAKA,uBAKJ,EALI;AAMA,2BAIJ,EAJI;AAuDT;;AAjDU,MAAL,KAAK;AACP,WAAO,CACL,GAAG,MAAM,CAAC,OAAP,CAAe,KAAK,IAApB,CADE,EAEL,GAAG,MAAM,CAAC,OAAP,CAAe,KAAK,eAApB,CAFE,EAGL,GAAG,MAAM,CAAC,OAAP,CAAe,KAAK,WAApB,CAHE,EAIL,GAAG,MAAM,CAAC,OAAP,CAAe,KAAK,UAApB,CAJE,CAAP;AAMD;;AAEa,MAAV,UAAU;AAAA;;AACZ,UAAM,MAAM,6EACP,kBADO,wDACP,oBAAoB,SAApB,CAA8B,MADvB,CAAZ;;AAGA,WAAO,MAAP;AACD;;AAEQ,MAAL,KAAK;AACP,WAAO,KAAP;AACD;;AAEgB,QAAX,WAAW;AACf;AACA,UAAM,IAAI,GAAG,MAAM,sBAAnB;AAEA,SAAK,IAAL,GAAY,IAAZ;AACA,UAAM,WAAW,GAAG,MAAM,uBAA1B;AACA,QAAI,SAAS,GAAG,WAAW,CAAC,UAAZ,CAAuB,MAAvB,CACb,GAAD,IAAS,GAAG,CAAC,WAAJ,KAAoB,IADf,EAEd,GAFc,CAET,GAAD,IAAS,GAAG,CAAC,WAAJ,CAAiB,CAAjB,CAFC,EAEoB,CAFpB,CAAhB;AAGA,aAAS,GAAG,SAAS,CAAC,SAAV,CAAoB,CAApB,EAAuB,SAAS,CAAC,OAAV,CAAkB,GAAlB,CAAvB,CAAZ;AACA,SAAK,WAAL,GAAmB;AACjB,YAAM,EAAE,WAAW,CAAC,MAAZ,CAAmB,MADV;AAEjB;AAFiB,KAAnB;AAKA,UAAM,eAAe,GAAG,MAAM,2BAA9B;AACA,mBAAe,CAAC,aAAhB,GAAgC,eAAe,CAAC,aAAhB,CAA8B,SAA9B,CAC9B,CAD8B,EAE9B,EAF8B,CAAhC;AAIA,UAAM,OAAO,GAAG,eAAe,CAAC,UAAhB,CAA2B,OAA3B,CAAmC,IAAnC,CAAhB;;AACA,QAAI,OAAO,KAAK,CAAC,CAAjB,EAAoB;AAClB,qBAAe,CAAC,UAAhB,GAA6B,eAAe,CAAC,UAAhB,CAA2B,SAA3B,CAC3B,CAD2B,EAE3B,OAF2B,CAA7B;AAID;;AACD,SAAK,eAAL,GAAuB,eAAvB;AACD;;AAlEwC,CAA3C;AAAqB,UAAU,qCAD9B,wCAC8B,GAAV,UAAU,CAAV;yEAAA;;AC7B+a,CAAC,oFAAe,kCAAG,EAAC;;;;ACAnX;AACvC;AACL;;;AAGzD;AACA,CAAmG;AACnG,IAAI,oBAAS,GAAG,sCAAU;AAC1B,EAAE,6CAAM;AACR,EAAE,0DAAM;AACR,EAAE,mEAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,4DAAe,oBAAS,QAAQ;;AAEhC;AACA,CAAmG;AAC9C;AACY;AACjE,2BAAiB,CAAC,oBAAS,GAAG,KAAK,mCAAa,8BAAC;;;ACxBjD,IAAI,kEAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,oBAAoB,OAAO,0CAA0C,oBAAoB,mBAAmB,iCAAiC,OAAO,oQAAoQ,KAAK,kCAAkC,YAAY,sBAAsB,uKAAuK,0BAA0B,YAAY,KAAK,6BAA6B,mIAAmI,uBAAuB,wBAAwB,iFAAiF,0BAA0B,iCAAiC,QAAQ,wDAAwD,2BAA2B,kCAAkC,0BAA0B,0BAA0B,wDAAwD,QAAQ,4CAA4C,eAAe,sBAAsB;AACz6C,IAAI,2EAAe;;;;;AC+CnB;AACA;AACA;AAEA;;AAEA,SAAS,QAAT,CAAkB,OAAlB,EAAiC;AAC/B,QAAM,CAAC,GAAG,QAAQ,CAAC,aAAT,CAAuB,GAAvB,CAAV;AACA,GAAC,CAAC,IAAF,GAAS,OAAT;AACA,GAAC,CAAC,YAAF,CAAe,UAAf,EAA2B,OAA3B;AACA,GAAC,CAAC,KAAF;AACD;;AAOD,IAAqB,kBAAkB,GAAvC,MAAqB,kBAArB,SAAgD,kCAAhD,CAAmD;AAAnD;;AACU,gCAAuC,IAAvC;AACA,uBAAc,KAAd;AA0DT;;AAxDoB,MAAf,eAAe;AACjB,WAAO,SAAS,CAAC,YAAV,KAA2B,SAAlC;AACD;;AAEqB,MAAlB,kBAAkB;AACpB,WAAO,sCAAP;AACD;;AACqB,MAAlB,kBAAkB,CAAC,MAAD,EAAgB;AACpC,6CAA+B,MAA/B;AACD;;AAE4B,MAAzB,yBAAyB;AAC3B,WAAO,6CAAP;AACD;;AAES,MAAN,MAAM;AACR,WAAO,gCAAP;AACD;;AAES,MAAN,MAAM,CAAC,MAAD,EAAgB;AACxB,uCAAyB,MAAzB;AACD;;AAED,YAAU;AACR,SAAK,KAAL,CAAW,SAAX,CAAqB,CAArB,EAAwB,SAAxB,CAAkC,CAAlC,EAAqC,KAArC,CAA2C,aAA3C;AACD;;AAED,eAAa,CAAC,GAAD,EAAa;AACxB,SAAK,oBAAL,GAA4B,GAA5B;AACD;;AAEQ,MAAL,KAAK;AACP,WAAO,KAAP;AACD;;AAE4B,MAAzB,yBAAyB;AAC3B,WAAO,MAAM,CAAC,SAAP,CAAiB,SAAjB,KAA+B,iBAAtC;AACD;;AAEoB,QAAf,eAAe;AACnB,UAAM;AAAE,eAAF;AAAa;AAAb,QAA2B,MAAM,oCAAvC;;AACA,QAAI,CAAC,SAAL,EAAgB;AACd,aAAO,KAAP;AACD;;AACD,QAAI,SAAJ,EAAe;AACb,cAAQ,CAAC,sCAAD,CAAR;AACA,WAAK,WAAL,GAAmB,KAAnB;AACD,KAHD,MAGO;AACL,WAAK,WAAL,GAAmB,MAAM,oCAAzB;AACD;AACF;;AAEY,QAAP,OAAO;AACX,UAAM;AAAE;AAAF,QAAgB,MAAM,oCAA5B;AACA,SAAK,WAAL,GAAmB,SAAnB;AACD;;AA3DgD,CAAnD;AAAqB,kBAAkB,qCALtC,4CAAS,CAAC;AACT,YAAU,EAAE;AACV,eAAW;AADD;AADH,CAAD,CAK6B,GAAlB,kBAAkB,CAAlB;iFAAA;;AClEub,CAAC,4FAAe,0CAAG,EAAC;;ACAnX;AACvC;AACL;AACjE,CAAuG;;;AAGvG;AACmG;AACnG,IAAI,4BAAS,GAAG,sCAAU;AAC1B,EAAE,qDAAM;AACR,EAAE,kEAAM;AACR,EAAE,2EAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,oEAAe,4BAAS,QAAQ;;AAEhC;AACA,CAAmG;AAChD;AACE;AACO;AACF;AACD;AACzD,2BAAiB,CAAC,4BAAS,GAAG,IAAI,2BAAM,mCAAa,kDAAW,mCAAQ,yBAAC;;;;ACLzE;AACA;AACA;AACA;AAcA,IAAqB,aAAa,GAAlC,MAAqB,aAArB,SAA2C,kCAA3C,CAA8C;AAA9C;;AACU,eAAsB,IAAtB;AACA,oBAAsB,CAC5B;AACE,SAAG,EAAE,aADP;AAEE,aAAO,EAAE,8BAAmB;AAF9B,KAD4B,EAK5B;AACE,SAAG,EAAE,aADP;AAEE,aAAO,EAAE,qBAAU;AAFrB,KAL4B,EAS5B;AACE,SAAG,EAAE,WADP;AAEE,aAAO,EAAE,6BAAkB;AAF7B,KAT4B,CAAtB;AAmBT;;AAHC,OAAK;AACH,WAAO,IAAP;AACD;;AApB2C,CAA9C;;AAkBE,kCADC,uCAAI,CAAC,QAAD,CACL,qCAEC,IAFD;;AAlBmB,aAAa,qCAPjC,4CAAS,CAAC;AACT,YAAU,EAAE;AACV,uBADU;AAEV,cAFU;AAGV,sBAAkB;AAHR;AADH,CAAD,CAOwB,GAAb,aAAa,CAAb;4EAAA;;ACxCkb,CAAC,uFAAe,qCAAG,EAAC;;;;;;;;;;;;;;ACAnX;AACvC;AACL;;;AAG5D;AACA,CAAmG;AACnG,IAAI,uBAAS,GAAG,sCAAU;AAC1B,EAAE,gDAAM;AACR,EAAE,6DAAM;AACR,EAAE,sEAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,+DAAe,uBAAS,QAAQ;;AAEhC;AACA,CAAmG;AAChD;AACE;AACE;AACH;AACI;AACH;AACK;AACC;AACK;AAChE,2BAAiB,CAAC,uBAAS,GAAG,IAAI,2BAAM,8BAAQ,6BAAK,8BAAS,+BAAM,iCAAW,oCAAS,uCAAc,4CAAC;;;AC6CvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;CAEA;AACA;AACA;AACA;;AACA;AACA;AACA;AAMA;AACA;AACA;AAGA,MAAM,mBAAmB,GAAG,IAA5B;AACA,MAAM,eAAe,GAAG,EAAxB;;AAEA,SAAS,IAAT,CAAc,CAAd,EAAyB,GAAzB,EAAsC,CAAtC,EAA+C;AAC7C,SAAO,CAAC,GAAG,GAAJ,GAAU,CAAC,IAAI,IAAI,GAAR,CAAlB;AACD;;AAED,SAAS,QAAT,CAAkB,IAAlB,EAAgC,CAAhC,EAAyC;AACvC,QAAM,IAAI,GAAG,IAAI,CACd,GADU,CACL,CAAD,KAAQ;AAAE,KAAC,EAAE,IAAI,CAAC,GAAL,CAAS,MAAM,CAAC,CAAC,CAAC,CAAH,CAAN,GAAc,CAAvB,CAAL;AAAgC;AAAhC,GAAR,CADM,EAEV,IAFU,CAEL,CAAC,CAAD,EAAI,CAAJ,KAAU,CAAC,CAAC,CAAF,GAAM,CAAC,CAAC,CAFb,EAGV,GAHU,EAAb;AAIA,SAAO,IAAI,CAAC,IAAL,CAAW,CAAD,IAAO,CAAC,CAAC,CAAF,KAAQ,IAAI,CAAC,CAAL,CAAO,CAAhC,CAAP;AACD;;AAED,SAAS,iBAAT,CAA2B,IAA3B,EAAwC,GAAxC,EAAqD,IAArD,EAAgE;AAC9D;AACA;AACA,KAAG,GAAG,IAAI,GAAV;AACA,QAAM,MAAM,GAAG,EAAf,CAJ8D,CAK9D;;AAEA,OAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,IAAI,CAAC,MAAzB,EAAiC,CAAC,EAAlC,EAAsC;AACpC,UAAM,OAAO,GAAG,IAAI,CAAC,CAAD,CAApB;AACA,UAAM,CAAC,GAAG,OAAO,CAAC,CAAlB;;AACA,QAAI,IAAI,CAAC,CAAD,CAAR,EAAa;AACX;AACA,YAAM,OAAO,GAAG,IAAI,CAAC,CAAD,CAApB;AACA,YAAM,CAAC,IAAP,CAAY;AACV,UAAE,EAAE,IAAI,CAAC,OAAO,CAAC,EAAT,EAAa,GAAb,EAAkB,OAAO,CAAC,EAA1B,CADE;AAEV,UAAE,EAAE,IAAI,CAAC,OAAO,CAAC,EAAT,EAAa,GAAb,EAAkB,OAAO,CAAC,EAA1B,CAFE;AAGV,SAAC,EAAE,MAAM,CAAC,CAAD;AAHC,OAAZ;AAKD,KARD,MAQO;AACL;AACA;AACA,YAAM,OAAO,GAAG,QAAQ,CAAC,IAAD,EAAO,CAAP,CAAxB,CAHK,CAIL;AACA;;AACA,YAAM,CAAC,IAAP,CAAY;AACV,UAAE,EAAE,IAAI,CAAC,OAAO,CAAC,EAAT,EAAa,GAAb,EAAkB,OAAO,CAAC,EAA1B,CADE;AAEV,UAAE,EAAE,IAAI,CAAC,OAAO,CAAC,EAAT,EAAa,GAAb,EAAkB,OAAO,CAAC,EAA1B,CAFE;AAGV,SAAC,EAAE,MAAM,CAAC,CAAD;AAHC,OAAZ;AAKD;AACF;;AACD,SAAO,MAAP;AACD;;AAED,IAAI,QAAQ,GAAG,CAAf;AAEA,IAAI,YAAJ;AAOA,MAAM,KAAK,GAAG,IAAI,KAAJ,EAAd;AAOA,IAAqB,mBAAmB,GAAxC,MAAqB,mBAArB,SAAiD,kCAAjD,CAAoD;AAApD;;AAgBU,uBAAc,KAAd;AAEA,wBAAe,KAAf;AACA,uBAAc,KAAd;AACA,4BAAmB,KAAnB;AACA,yBAAgB,WAAW,CAAC,GAAZ,EAAhB;AAOR,sBAAwB,EAAxB;AA0BQ,uBAAc,GAAd;AACA,wBAAe,IAAf;AAqcT;;AAhfY,MAAP,OAAO;AACT,WAAO,MAAM,CAAC,QAAP,CAAgB,IAAhB,KAAyB,MAAzB,IAAmC,MAAM,CAAC,QAAP,CAAgB,IAAhB,KAAyB,MAAnE;AACD;;AAgBD,qBAAmB;AACjB,SAAK,YAAL,GAAoB,KAApB;AACA,cAAU,CAAC,MAAK;AACd,WAAK,WAAL,GAAmB,KAAnB;AACD,KAFS,EAEP,GAFO,CAAV;AAGD;;AAEa,MAAV,UAAU,CAAC,GAAD,EAAa;AACzB;AACA,SAAK,WAAL,GAAmB,GAAnB;AACA,cAAU,CAAC,MAAO,KAAK,WAAL,GAAmB,KAA3B,EAAmC,IAAnC,CAAV;AACD;;AAEa,MAAV,UAAU;AACZ,WAAO,KAAK,WAAZ;AACD;;AAEU,MAAP,OAAO;AACT,WAAO,mBAAP;AACD;;AAEgB,QAAX,WAAW;AACf,gBAAY,GAAG,MAAM,mGAArB;AACD;;AAID,SAAO;AACL,QAAI,KAAK,KAAL,CAAW,OAAf,EAAwB;AACtB,YAAM,WAAW,GAAG,IAAI,CAAxB;;AACA,UAAI,SAAS,CAAC,SAAV,CAAoB,QAApB,CAA6B,kBAA7B,CAAJ,EAAsD;AACpD,aAAK,YAAL,GAAoB,QAAQ,CAAC,IAAT,CAAc,qBAAd,GAAsC,MAA1D;AACD,OAFD,MAEO;AACL,aAAK,YAAL,GACE,KAAK,KAAL,CAAW,OAAX,CAAmB,aAAnB,CACA,qBADA,GACwB,MAF1B;AAGD;;AACD,WAAK,WAAL,GAAmB,KAAK,YAAL,GAAoB,WAAvC;AACA,WAAK,KAAL,CAAW,OAAX,CAAmB,KAAnB,CAAyB,KAAzB,GAAiC,GAAG,KAAK,WAAW,IAApD;AACA,WAAK,KAAL,CAAW,OAAX,CAAmB,KAAnB,CAAyB,MAAzB,GAAkC,GAAG,KAAK,YAAY,IAAtD;AACA,YAAM,GAAG,GAAG,KAAK,KAAL,CAAW,OAAX,CAAmB,UAAnB,CACV,IADU,CAAZ;AAGA,SAAG,CAAC,SAAJ,GAAgB,CAAhB;AACA,SAAG,CAAC,WAAJ,GAAkB,0BAAlB;AACA,SAAG,CAAC,SAAJ,GAAgB,0BAAhB;AACA,SAAG,CAAC,SAAJ,GAAgB,CAAhB;AACA,SAAG,CAAC,OAAJ,GAAc,OAAd;AACD;;AACD,UAAM,CAAC,qBAAP,CAA6B,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAA7B;AACD;;AAEc,MAAX,WAAW;AACb,QAAI,OAAO,GAAG,OAAd;;AACA,QAAI,KAAK,WAAT,EAAsB;AACpB,aAAO,GAAG,qBAAqB,KAAK,mBAAmB,mBAAvD;AACD,KAFD,MAEO,IAAI,KAAK,eAAT,EAA0B;AAC/B,aAAO,GAAG,eAAV;AACD,KAFM,MAEA,IAAI,KAAK,UAAT,EAAqB;AAC1B,aAAO,GAAG,eAAV;AACD,KAFM,MAEA,IAAI,KAAK,QAAT,EAAmB;AACxB,aAAO,GAAG,aAAV;AACD,KAFM,MAEA,IAAI,KAAK,UAAT,EAAqB;AAC1B,aAAO,GAAG,mBAAV;AACD;;AACD,SAAK,UAAL,CAAgB,OAAhB;AACA,WAAO,OAAP;AACD;;AAEkB,MAAf,eAAe;AACjB,QAAI,KAAK,mBAAT,EAA8B;AAC5B,aAAO,oBAAP;AACD,KAFD,MAEO,IAAI,KAAK,6BAAT,EAAwC;AAC7C,aAAO,sBAAP;AACD,KAFM,MAEA;AACL,aAAO,0BAAP;AACD;AACF;;AAEa,MAAV,UAAU;AACZ,WAAO,KAAK,KAAL,KAAe,uBAAtB;AACD;;AAGD,wBAAsB,CAAC,KAAD,EAA6B;AACjD,QAAI,KAAK,KAAK,IAAd,EAAoB;AAClB,YAAM,WAAW,GAAG,KAAK,CAAC,KAAN,CAAY,SAAZ,CAAsB,WAA1C;;AACA,UAAI,KAAK,mBAAT,EAA8B;AAC5B,YAAI,WAAW,CAAC,cAAhB,EAAgC;AAC9B,eAAK,CAAC,GAAN,GAAY,GAAG,eAAoB,8BAAnC;AACA,eAAK,CAAC,IAAN;AACD;AACF,OALD,MAKO,IAAI,KAAK,6BAAT,EAAwC;AAC7C,YAAI,WAAW,CAAC,eAAhB,EAAiC;AAC/B,eAAK,CAAC,GAAN,GAAY,GAAG,eAAoB,8BAAnC;AACA,eAAK,CAAC,IAAN;AACD;AACF,OALM,MAKA,IAAI,KAAK,4BAAT,EAAuC;AAC5C,YAAI,WAAW,CAAC,aAAhB,EAA+B;AAC7B,eAAK,CAAC,GAAN,GAAY,GAAG,eAAoB,8BAAnC;AACA,eAAK,CAAC,IAAN;AACD;AACF;AACF;AACF;;AAED,mBAAiB;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA,QACE,KAAK,cAAL,IACA,IAAI,IAAJ,GAAW,OAAX,KAAuB,KAAK,cAAL,CAAoB,SAApB,CAA8B,OAA9B,EAAvB,GAAiE,IAFnE,EAGE;AACA,WAAK,gBAAL,GAAwB,IAAxB;AACD,KALD,MAKO;AACL,WAAK,gBAAL,GAAwB,KAAxB;AACD;;AACD,YAAQ;AACR,UAAM,GAAG,GAAG,KAAK,KAAL,CAAW,OAAX,CAAmB,UAAnB,CAA8B,IAA9B,CAAZ;AACA,UAAM,UAAU,GAAG,CAAnB;AACA,UAAM,WAAW,GAAG,MAAM,eAA1B;;AAEA,QAAI,GAAJ,EAAS;AACP,SAAG,CAAC,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB,GAApB,EAAyB,IAAzB;AACA,SAAG,CAAC,IAAJ;AACA,SAAG,CAAC,SAAJ,CAAc,eAAe,GAAG,CAAhC,EAAmC,CAAnC;AACA,SAAG,CAAC,KAAJ,CAAU,IAAV,EAAgB,IAAhB;;AACA,UAAI,KAAK,MAAL,CAAY,MAAZ,KAAuB,CAA3B,EAA8B;AAC5B;AACA,cAAM,SAAS,GAAG,KAAK,MAAL,CAAY,CAAZ,CAAlB;AACA,cAAM,SAAS,GAAG,KAAK,MAAL,CAAY,CAAZ,CAAlB,CAH4B,CAK5B;AACA;;AACA,YAAI,SAAS,IAAI,SAAb,IAA0B,SAAS,CAAC,MAApC,IAA8C,SAAS,CAAC,MAA5D,EAAoE;AAClE,gBAAM,iBAAiB,GAAG,iBAAiB,CACzC,SAAS,CAAC,CAAD,CADgC,EAEzC,iBAFyC,EAGzC,SAAS,CAAC,CAAD,CAHgC,CAA3C;AAMA,gBAAM,GAAG,GAAG,WAAW,CAAC,GAAZ,EAAZ;AACA,gBAAM,qBAAqB,GAAG,GAAG,GAAG,KAAK,aAAzC;AACA,eAAK,aAAL,GAAqB,GAArB;AACA,+BAAqB,qBAAqB,GAAG,GAA7C;AACA,8BAAoB,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,iBAAZ,CAApB;AAEA,gBAAM,WAAW,GAAG,IAAI,UAAJ,CAAe,iBAAiB,CAAC,MAAlB,GAA2B,CAA1C,CAApB;AACA,cAAI,CAAC,GAAG,CAAR;AACA,2BAAiB,CAAC,OAAlB;AACA,cAAI,MAAM,GAAG,CAAb;;AACA,cAAI,KAAK,cAAL,KAAwB,MAA5B,EAAoC;AAClC,kBAAM,GAAG,eAAT;AACD;;AACD,eAAK,MAAM,GAAX,IAAkB,iBAAlB,EAAqC;AACnC,uBAAW,CAAC,CAAC,EAAF,CAAX,GAAmB,GAAG,CAAC,EAAJ,GAAS,MAA5B;AACA,uBAAW,CAAC,CAAC,EAAF,CAAX,GAAmB,GAAG,CAAC,CAAvB;AACD;;AACD,2BAAiB,CAAC,OAAlB;;AACA,eAAK,MAAM,GAAX,IAAkB,iBAAlB,EAAqC;AACnC,uBAAW,CAAC,CAAC,EAAF,CAAX,GAAmB,GAAG,CAAC,EAAJ,GAAS,MAA5B;AACA,uBAAW,CAAC,CAAC,EAAF,CAAX,GAAmB,GAAG,CAAC,CAAvB;AACD;;AACD,cAAI,SAAS,GAAa,EAA1B;;AACA,cAAI,WAAW,CAAC,MAAZ,IAAsB,CAA1B,EAA6B;AAC3B,qBAAS,GAAG,YAAY,CAAC,qBAAb,CAAmC,WAAnC,CAAZ;AACD;;AACD,cAAI,SAAS,CAAC,MAAd,EAAsB;AACpB;AACE;AACE,oBAAI,SAAS,GAAG,CAAhB;;AACA,oBAAI,KAAK,IAAT,EAAe;AACb,wBAAM,QAAQ,GAAG,CAAC,CAAD,EAAW,CAAX,KAAuB;AACtC,0BAAM,EAAE,GAAG,CAAC,CAAC,CAAF,GAAM,CAAC,CAAC,CAAnB;AACA,0BAAM,EAAE,GAAG,CAAC,CAAC,CAAF,GAAM,CAAC,CAAC,CAAnB;AACA,2BAAO,IAAI,CAAC,IAAL,CAAU,EAAE,GAAG,EAAL,GAAU,EAAE,GAAG,EAAzB,CAAP;AACD,mBAJD;;AAKA,2BAAS,GAAG,QAAQ,CAClB,KAAK,IAAL,CAAU,IAAV,CAAe,UADG,EAElB,KAAK,IAAL,CAAU,IAAV,CAAe,WAFG,CAApB;AAID;;AACD,sBAAM,WAAW,GAAG,MAAM,SAAS,GAAG,GAAtC;AACA,mBAAG,CAAC,WAAJ,GAAkB,uBAAuB,WAAW,GAApD;AACA,mBAAG,CAAC,WAAJ,CAAgB,CAAC,CAAD,EAAI,CAAJ,CAAhB;AACA,mBAAG,CAAC,cAAJ,GAAsB,QAAQ,GAAG,CAAZ,GAAiB,EAAtC,CAhBF,CAgB4C;;AAC1C,mBAAG,CAAC,SAAJ;AACA,mBAAG,CAAC,MAAJ,CAAW,SAAS,CAAC,CAAD,CAApB,EAAyB,SAAS,CAAC,CAAD,CAAlC;;AACA,qBAAK,IAAI,EAAC,GAAG,CAAb,EAAgB,EAAC,GAAG,SAAS,CAAC,MAA9B,EAAsC,EAAC,IAAI,CAA3C,EAA8C;AAC5C,qBAAG,CAAC,aAAJ,CACE,SAAS,CAAC,EAAD,CADX,EAEE,SAAS,CAAC,EAAC,GAAG,CAAL,CAFX,EAGE,SAAS,CAAC,EAAC,GAAG,CAAL,CAHX,EAIE,SAAS,CAAC,EAAC,GAAG,CAAL,CAJX,EAKE,SAAS,CAAC,EAAC,GAAG,CAAL,CALX,EAME,SAAS,CAAC,EAAC,GAAG,CAAL,CANX;AAQD;;AACD,mBAAG,CAAC,MAAJ;AACD;AACF;AACD;AACE,kBAAI,KAAK,cAAT,EAAyB;AACvB,oBAAI,eAAe,GAAG,IAAI,CAAC,GAAL,CACpB,GADoB,EAEpB,CAAC,IAAI,IAAJ,GAAW,OAAX,KACC,KAAK,cAAL,CAAoB,SAApB,CAA8B,OAA9B,EADF,IAEE,GAJkB,CAAtB;AAMA,+BAAe,IAAI,eAAnB;AACA,mBAAG,CAAC,SAAJ;AACA,mBAAG,CAAC,SAAJ,GAAgB,uBACd,IAAI,CAAC,GAAL,CAAS,MAAM,eAAf,IAAkC,GACpC,GAFA;AAGA,mBAAG,CAAC,GAAJ,CACE,KAAK,cAAL,CAAoB,OAApB,GAA8B,MADhC,EAEE,KAAK,cAAL,CAAoB,OAFtB,EAGE,eAAe,GAAG,CAHpB,EAIE,CAJF,EAKE,IAAI,CAAC,EAAL,GAAU,CALZ;AAOA,mBAAG,CAAC,IAAJ;AACD;AACF;AACD,eAAG,CAAC,IAAJ,GAzDoB,CA0DpB;;AACA,eAAG,CAAC,wBAAJ,GAA+B,iBAA/B;AACA,kBAAM,YAAY,GAAG,GAAG,CAAC,oBAAJ,CAAyB,UAAzB,EAAqC,CAArC,EAAwC,EAAxC,EAA4C,CAA5C,CAArB;AACA,wBAAY,CAAC,YAAb,CAA0B,CAA1B,EAA6B,kBAA7B;AACA,wBAAY,CAAC,YAAb,CAA0B,IAA1B,EAAgC,oBAAhC;AACA,wBAAY,CAAC,YAAb,CAA0B,CAA1B,EAA6B,oBAA7B;AACA,kBAAM,aAAa,GAAG,GAAG,CAAC,oBAAJ,CACpB,WAAW,GAAG,EADM,EAEpB,CAFoB,EAGpB,WAHoB,EAIpB,CAJoB,CAAtB;AAMA,yBAAa,CAAC,YAAd,CAA2B,CAA3B,EAA8B,oBAA9B;AACA,yBAAa,CAAC,YAAd,CAA2B,IAA3B,EAAiC,oBAAjC;AACA,yBAAa,CAAC,YAAd,CAA2B,CAA3B,EAA8B,kBAA9B;AAEA,kBAAM,WAAW,GAAG,GAAG,CAAC,oBAAJ,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,EAAlC,CAApB;AACA,uBAAW,CAAC,YAAZ,CAAyB,CAAzB,EAA4B,oBAA5B;AACA,uBAAW,CAAC,YAAZ,CAAyB,IAAzB,EAA+B,oBAA/B;AACA,uBAAW,CAAC,YAAZ,CAAyB,CAAzB,EAA4B,kBAA5B;AAEA,kBAAM,cAAc,GAAG,GAAG,CAAC,oBAAJ,CAAyB,CAAzB,EAA4B,GAA5B,EAAiC,CAAjC,EAAoC,GAApC,CAAvB;AACA,0BAAc,CAAC,YAAf,CAA4B,CAA5B,EAA+B,oBAA/B;AACA,0BAAc,CAAC,YAAf,CAA4B,IAA5B,EAAkC,oBAAlC;AACA,0BAAc,CAAC,YAAf,CAA4B,CAA5B,EAA+B,kBAA/B;AAEA,eAAG,CAAC,SAAJ,GAAgB,YAAhB;AACA,eAAG,CAAC,QAAJ,CAAa,UAAb,EAAyB,CAAzB,EAA4B,EAA5B,EAAgC,GAAhC;AACA,eAAG,CAAC,SAAJ,GAAgB,aAAhB;AACA,eAAG,CAAC,QAAJ,CAAa,WAAW,GAAG,EAA3B,EAA+B,CAA/B,EAAkC,EAAlC,EAAsC,GAAtC;AACA,eAAG,CAAC,SAAJ,GAAgB,WAAhB;AACA,eAAG,CAAC,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB,MAAM,eAAzB,EAA0C,EAA1C;AACA,eAAG,CAAC,SAAJ,GAAgB,cAAhB;AACA,eAAG,CAAC,QAAJ,CAAa,CAAb,EAAgB,GAAhB,EAAqB,MAAM,eAA3B,EAA4C,EAA5C;AACA,eAAG,CAAC,OAAJ;AACD;AACF,SAtI2B,CAwI5B;;;AACA,WAAG,CAAC,WAAJ,CAAgB,EAAhB;AAEA,cAAM,MAAM,GAAG,EAAf;AACA,cAAM,MAAM,GAAG,CAAf;AACA,cAAM,GAAG,GAAG,EAAZ;AACA,cAAM,KAAK,GAAG,MAAM,eAApB;AACA,cAAM,MAAM,GAAG,GAAf;AACA,WAAG,CAAC,SAAJ;AACA,WAAG,CAAC,MAAJ,CAAW,MAAM,GAAG,GAApB,EAAyB,MAAzB;AACA,WAAG,CAAC,MAAJ,CAAW,MAAX,EAAmB,MAAnB;AACA,WAAG,CAAC,MAAJ,CAAW,MAAX,EAAmB,MAAM,GAAG,GAA5B;AAEA,WAAG,CAAC,MAAJ,CAAW,MAAM,GAAG,GAApB,EAAyB,MAAM,GAAG,MAAlC;AACA,WAAG,CAAC,MAAJ,CAAW,MAAX,EAAmB,MAAM,GAAG,MAA5B;AACA,WAAG,CAAC,MAAJ,CAAW,MAAX,EAAmB,MAAM,IAAI,MAAM,GAAG,GAAb,CAAzB;AAEA,WAAG,CAAC,MAAJ,CAAW,KAAK,IAAI,MAAM,GAAG,GAAb,CAAhB,EAAmC,MAAnC;AACA,WAAG,CAAC,MAAJ,CAAW,KAAK,GAAG,MAAnB,EAA2B,MAA3B;AACA,WAAG,CAAC,MAAJ,CAAW,KAAK,GAAG,MAAnB,EAA2B,MAAM,GAAG,GAApC;AAEA,WAAG,CAAC,MAAJ,CAAW,KAAK,IAAI,MAAM,GAAG,GAAb,CAAhB,EAAmC,MAAM,GAAG,MAA5C;AACA,WAAG,CAAC,MAAJ,CAAW,KAAK,GAAG,MAAnB,EAA2B,MAAM,GAAG,MAApC;AACA,WAAG,CAAC,MAAJ,CAAW,KAAK,GAAG,MAAnB,EAA2B,MAAM,IAAI,MAAM,GAAG,GAAb,CAAjC;AACA,WAAG,CAAC,MAAJ;AACA,WAAG,CAAC,OAAJ;AACD;AACF;;AACD,yBAAqB,CAAC,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAD,CAArB;AACD;;AAEc,MAAX,WAAW;AACb,QAAI,KAAK,cAAT,EAAyB;AACvB,YAAM,IAAI,GAAG,IAAI,cAAJ,CAAmB,KAAK,cAAL,CAAoB,IAApB,CAAyB,UAA5C,CAAb;AACA,WAAK,UAAL,CAAgB,kBAAkB,IAAI,EAAtC;AACA,aAAO,IAAP;AACD;;AACD,WAAO,IAAI,cAAJ,CAAmB,CAAnB,CAAP;AACD;;AAEsB,MAAnB,mBAAmB;AACrB,WAAO,KAAK,WAAL,CAAiB,GAAjB,GAAuB,KAAK,WAAL,CAAiB,iBAA/C;AACD;;AAEgC,MAA7B,6BAA6B;AAC/B,WACE,KAAK,WAAL,CAAiB,GAAjB,IAAwB,KAAK,WAAL,CAAiB,iBAAzC,IACA,KAAK,WAAL,CAAiB,GAAjB,IAAwB,mBAF1B;AAID;;AAE+B,MAA5B,4BAA4B;AAC9B,WAAO,KAAK,WAAL,CAAiB,GAAjB,GAAuB,mBAA9B;AACD;;AAEoB,MAAjB,iBAAiB;AACnB,WAAO,KAAK,KAAL,CAAW,WAAX,GAAyB,OAAzB,CAAiC,GAAjC,EAAsC,GAAtC,CAAP;AACD;;AAEuB,MAApB,oBAAoB;AACtB,QAAI,KAAK,cAAT,EAAyB;AACvB,UAAI,KAAK,mBAAT,EAA8B;AAC5B,eAAO,MAAP,CAD4B,CACb;AAChB,OAFD,MAEO,IAAI,KAAK,6BAAT,EAAwC;AAC7C,eAAO,gBAAP;AACD,OAFM,MAEA,IAAI,KAAK,4BAAT,EAAuC;AAC5C,eAAO,OAAP;AACD;AACF;;AAED,WAAO,IAAP;AACD;;AAEqB,MAAlB,kBAAkB;AACpB,WAAO,KAAK,oBAAL,KAA8B,IAArC;AACD;;AAEW,MAAR,QAAQ;AACV,WAAO,KAAK,KAAL,KAAe,sBAAtB;AACD;;AAEc,MAAX,WAAW;AACb,WAAO,KAAK,KAAL,KAAe,yBAAtB;AACD;;AAEyB,MAAtB,sBAAsB;AACxB;AACA,UAAM,QAAQ,GAAG,EAAjB;AACA,UAAM,eAAe,GAAG,EAAxB;AACA,UAAM,cAAc,GAAG,EAAvB;AAEA,UAAM,MAAM,GAAG,GAAf;AACA,UAAM,aAAa,GAAG,GAAtB;AACA,UAAM,YAAY,GAAG,EAArB;AAEA,UAAM,GAAG,GAAG,IAAI,CAAC,GAAL,CACV,CADU,EAEV,CAAC,mBAAmB,GAAG,KAAK,sBAA5B,IAAsD,mBAF5C,CAAZ;AAKA,UAAM,GAAG,GAAG,IAAI,CAAC,MAAD,EAAS,GAAT,EAAc,QAAd,CAAhB;AACA,UAAM,UAAU,GAAG,IAAI,CAAC,aAAD,EAAgB,GAAhB,EAAqB,eAArB,CAAvB;AACA,UAAM,SAAS,GAAG,IAAI,CAAC,YAAD,EAAe,GAAf,EAAoB,cAApB,CAAtB;AACA,WAAO,OAAO,GAAG,KAAK,UAAU,MAAM,SAAS,IAA/C;AACD;;AAEkB,MAAf,eAAe;AACjB,WAAO,KAAK,KAAL,KAAe,8BAAtB;AACD;;AAEa,MAAV,UAAU;AACZ,WACE,KAAK,KAAL,KAAe,yBAAf,IACA,KAAK,KAAL,KAAe,wBADf,IAEA,KAAK,KAAL,KAAe,wBAFf,IAGA,KAAK,KAAL,KAAe,2BAHf,IAIA,KAAK,KAAL,KAAe,sBAJf,IAKA,KAAK,KAAL,KAAe,0BANjB;AAQD;;AAEa,MAAV,UAAU;AACZ,WAAO,KAAK,KAAL,KAAe,kCAAtB;AACD;;AAEsB,MAAnB,mBAAmB;AACrB,UAAM,gBAAgB,GAAG,KAAK,sBAA9B;AACA,UAAM,aAAa,GAAG,IAAI,CAAC,KAAL,CAAW,gBAAgB,GAAG,EAA9B,CAAtB;AACA,UAAM,OAAO,GAAG,gBAAgB,GAAG,aAAa,GAAG,EAAnD;AACA,WAAO,IAAI,MAAM,CAAC,aAAD,CAAN,CAAsB,QAAtB,CAA+B,CAA/B,EAAkC,GAAlC,CAAsC,IAAI,MAAM,CACzD,IAAI,CAAC,KAAL,CAAW,OAAX,CADyD,CAAN,CAEnD,QAFmD,CAE1C,CAF0C,EAEvC,GAFuC,CAEnC,EAFlB;AAGD;;AAEU,MAAP,OAAO;AACT,YAAQ,KAAK,KAAb;AACE,WAAK,yBAAL;AACE,eAAO;AAAE,iBAAO,EAAE,aAAX;AAA0B,eAAK,EAAE,MAAM,CAAC;AAAxC,SAAP;;AACF,WAAK,6BAAL;AACE,eAAO;AACL,iBAAO,EAAE,kDADJ;AAEL,eAAK,EAAE;AAFF,SAAP;;AAKF,WAAK,wBAAL;AACA,WAAK,wBAAL;AACE,eAAO;AACL,iBAAO,EAAE,4BADJ;AAEL,eAAK,EAAE,CAAC;AAFH,SAAP;;AAIF,WAAK,2BAAL;AACA,WAAK,sBAAL;AACE,eAAO;AAAE,iBAAO,EAAE,gCAAX;AAA6C,eAAK,EAAE;AAApD,SAAP;;AACF,WAAK,0BAAL;AACE,YAAI,KAAK,cAAT,EAAyB;AACvB,cAAI,KAAK,mBAAT,EAA8B;AAC5B,mBAAO;AAAE,qBAAO,EAAE,4BAAX;AAAyC,mBAAK,EAAE;AAAhD,aAAP;AACD,WAFD,MAEO,IAAI,KAAK,6BAAT,EAAwC;AAC7C,mBAAO;AACL,qBAAO,EACL,4DAFG;AAGL,mBAAK,EAAE;AAHF,aAAP;AAKD,WANM,MAMA,IAAI,KAAK,4BAAT,EAAuC;AAC5C,mBAAO;AACL,qBAAO,EAAE,6CADJ;AAEL,mBAAK,EAAE;AAFF,aAAP;AAID;AACF;;AACD;;AACF,WAAK,uBAAL;AACE,YAAI,KAAK,cAAT,EAAyB;AACvB,cAAI,KAAK,mBAAT,EAA8B;AAC5B,mBAAO;AAAE,qBAAO,EAAE,oBAAX;AAAiC,mBAAK,EAAE,CAAC;AAAzC,aAAP;AACD,WAFD,MAEO;AACL,mBAAO;AACL,qBAAO,EAAE,6CADJ;AAEL,mBAAK,EAAE,CAAC;AAFH,aAAP;AAID;AACF,SATD,MASO;AACL,iBAAO;AACL,mBAAO,EAAE,EADJ;AAEL,iBAAK,EAAE,CAAC;AAFH,WAAP;AAID;;AACH,WAAK,oBAAL;AACA;AACE,eAAO;AAAE,iBAAO,EAAE,iBAAX;AAA8B,eAAK,EAAE,MAAM,CAAC;AAA5C,SAAP;AAtDJ;;AAwDA,WAAO;AAAE,aAAO,EAAE,EAAX;AAAe,WAAK,EAAE;AAAtB,KAAP;AACD;;AAED,YAAU,CAAC,OAAD,EAAgB;AACxB,QAAI,KAAK,SAAT,EAAoB;AAClB,WAAK,KAAL,CAAW,aAAX,EAA0B,OAA1B;AACD;AACF;;AA3fiD,CAApD;;AAC4B,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,gDAAuB,CAAvB;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,yDAAuC,CAAvC;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,sDAAgC,CAAhC;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,4DAA4B,CAA5B;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,+CAAuB,CAAvB;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,iDAA4B,CAA5B;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,iEAAgC,CAAhC;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,oDAAmB,CAAnB;;AACA,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,yDAAkC,CAAlC;;AACD,kCAAxB,uCAAI,CAAC;AAAE,SAAO,EAAE;AAAX,CAAD,CAAoB,qDAAqB,CAArB;;AAwGzB,kCADC,wCAAK,CAAC,gBAAD,CACN,4DAoBC,IApBD;;AAlHmB,mBAAmB,qCALvC,4CAAS,CAAC;AACT,YAAU,EAAE;AACV,iBAAa;AADH;AADH,CAAD,CAK8B,GAAnB,mBAAmB,CAAnB;kFAAA;;ACzKwb,CAAC,6FAAe,2CAAG,EAAC;;ACAnX;AACvC;AACL;AAClE,CAAwG;;;AAGxG;AACmG;AACnG,IAAI,6BAAS,GAAG,sCAAU;AAC1B,EAAE,sDAAM;AACR,EAAE,mEAAM;AACR,EAAE,4EAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,qEAAe,6BAAS,QAAQ;;AAEhC;AACA,CAAmG;AAChD;AACE;AACO;AACH;AACJ;AACrD,2BAAiB,CAAC,6BAAS,GAAG,IAAI,2BAAM,mCAAa,+CAAQ,8BAAM,uBAAC;;;;;;;;;AC5BpE;AAEA;AAcA,IAAY,qBAAZ;;AAAA,WAAY,qBAAZ,EAAiC;AAC/B;AACA;AACA;AACD,CAJD,EAAY,qBAAqB,KAArB,qBAAqB,MAAjC;;AAMA,MAAM,IAAI,GAAG,IAAI,IAAJ,GAAW,OAAX,EAAb;AAiBM,MAAO,gBAAP,CAAuB;AAC3B,cACS,IADT,EAEE,IAFF,EAGS,OAHT,EAIS,uBAJT,EAMW;AALF;AAEA;AACA;AAaD,iBAAqB;AAC3B,YAAM,EAAE,IADmB;AAE3B,UAAI,EAAE,IAAI,IAAJ,GAAW,OAAX,EAFqB;AAG3B,WAAK,EAAE;AACL,2BAAmB,EAAE,CADhB;AAEL,2BAAmB,EAAE;AAFhB,OAHoB;AAO3B,kBAAY,EAAE,IAPa;AAQ3B,kBAAY,EAAE,CAAC,CARY;AAS3B,uBAAiB,EAAE,CATQ;AAU3B,YAAM,EAAE;AAVmB,KAArB;;AATN,QAAI,IAAI,KAAK,MAAT,IAAmB,IAAI,KAAK,MAAhC,EAAwC;AACtC;AACA;AACA,WAAK,IAAL,GAAY,eAAZ,CAHsC,CAItC;AACA;AACD;;AACD,SAAK,OAAL;AACD;;AAcD,iBAAe,CAAC,SAAD,EAAkB;AAC/B,QAAI,SAAS,GAAG,CAAhB,EAAmB;AACjB,gBAAU,CAAC,MAAM,KAAK,eAAL,CAAqB,SAAS,GAAG,CAAjC,CAAP,EAA4C,IAA5C,CAAV;AACD,KAFD,MAEO;AACL,WAAK,OAAL;AACD;AACF;;AACD,UAAQ;AACN,QAAI,KAAK,KAAL,CAAW,MAAX,KAAsB,IAA1B,EAAgC;AAC9B,UAAI,KAAK,KAAL,CAAW,MAAX,CAAkB,UAAlB,KAAiC,SAAS,CAAC,IAA/C,EAAqD;AACnD;AACA,aAAK,KAAL,CAAW,MAAX,CAAkB,IAAlB,CACE,IAAI,CAAC,SAAL,CAAe;AACb,cAAI,EAAE,UADO;AAEb,cAAI,EAAE,SAAS,CAAC,SAFH;AAGb,cAAI,EAAE;AAHO,SAAf,CADF;AAOA,aAAK,uBAAL,CAA6B,qBAAqB,CAAC,SAAnD;AAEA,aAAK,KAAL,CAAW,iBAAX,GAAgC,WAAW,CAAC,MAAK;AAC/C,eAAK,KAAL,CAAW,MAAX,IACE,KAAK,KAAL,CAAW,MAAX,CAAkB,IAAlB,CACE,IAAI,CAAC,SAAL,CAAe;AACb,gBAAI,EAAE,WADO;AAEb,gBAAI,EAAE;AAFO,WAAf,CADF,CADF;AAOD,SAR0C,EAQxC,IARwC,CAA3C;AASD,OApBD,MAoBO;AACL,kBAAU,CAAC,KAAK,QAAL,CAAc,IAAd,CAAmB,IAAnB,CAAD,EAA2B,GAA3B,CAAV;AACD;AACF;AACF;;AACD,SAAO;AAAA;;AACL,SAAK,KAAL,CAAW,MAAX,GAAoB,IAAI,SAAJ,CAAc,QAAQ,KAAK,IAAI,KAA/B,CAApB;AACA,SAAK,uBAAL,CAA6B,qBAAqB,CAAC,UAAnD;AACA,SAAK,KAAL,CAAW,MAAX,CAAkB,gBAAlB,CAAmC,OAAnC,EAA4C,CAAC,IAAG;AAC9C,aAAO,CAAC,IAAR,CAAa,4BAAb,EAA2C,CAA3C,EAD8C,CAE9C;AACD,KAHD,EAHK,CAOL;;AACA,SAAK,KAAL,CAAW,MAAX,CAAkB,gBAAlB,CAAmC,MAAnC,EAA2C,KAAK,QAAL,CAAc,IAAd,CAAmB,IAAnB,CAA3C;AACA,SAAK,KAAL,CAAW,MAAX,CAAkB,gBAAlB,CAAmC,OAAnC,EAA4C,MAAK;AAC/C;AACA,aAAO,CAAC,IAAR,CAAa,kBAAb;AACA,WAAK,KAAL,CAAW,MAAX,GAAoB,IAApB;AACA,WAAK,uBAAL,CAA6B,qBAAqB,CAAC,YAAnD;AACA,mBAAa,CAAC,KAAK,KAAL,CAAW,iBAAZ,CAAb;AACA,WAAK,eAAL,CAAqB,CAArB;AACD,KAPD;AAQA,SAAK,KAAL,CAAW,MAAX,CAAkB,gBAAlB,CAAmC,SAAnC,EAA8C,gBAAM,KAAN,EAAc;AAC1D,UAAI,KAAK,CAAC,IAAN,YAAsB,IAA1B,EAAgC;AAC9B;AACA,cAAM,cAAc,GAAG,KAAvB;;AACA,YAAI,cAAJ,EAAoB;AAClB,eAAI,CAAC,KAAL,CAAW,MAAX,CAAkB,IAAlB,CACG,MAAM,KAAI,CAAC,UAAL,CAAgB,KAAK,CAAC,IAAtB,CADT,EADkB,CAIlB;AACA;;;AACA,eAAI,CAAC,KAAL,CAAW,YAAX,GAA2B,UAAU,CACnC,KAAI,CAAC,cAAL,CAAoB,IAApB,CAAyB,KAAzB,CADmC,EAEnC,CAFmC,CAArC;AAID,SAVD,MAUO;AACL,eAAI,CAAC,OAAL,CACG,MAAM,KAAI,CAAC,UAAL,CAAgB,KAAK,CAAC,IAAtB,CADT;AAGD,SAjB6B,CAkB9B;;AACD;AACF,KArBD;AAsBD;;AACe,QAAV,UAAU,CACd,IADc,EACJ;AAEV;AACA,UAAM,IAAI,GAAG,MAAM,UAAU,CAAC,WAAX,CAAuB,IAAvB,CAAnB;AACA,UAAM,eAAe,GAAG,IAAI,WAAJ,CAAgB,IAAI,CAAC,KAAL,CAAW,CAAX,EAAc,CAAd,CAAhB,EAAkC,CAAlC,CAAxB;AACA,UAAM,gBAAgB,GAAG,IAAI,eAA7B;;AACA,QAAI;AACF,YAAM,SAAS,GAAG,IAAI,CAAC,KAAL,CAChB,MAAM,CAAC,YAAP,CAAoB,GAAG,IAAI,UAAJ,CAAe,IAAI,CAAC,KAAL,CAAW,CAAX,EAAc,gBAAd,CAAf,CAAvB,CADgB,CAAlB;;AAIA,UAAI,SAAS,CAAC,WAAV,KAA0B,IAA9B,EAAoC;AAClC,iBAAS,CAAC,WAAV,2BAA6B,yBAA7B;AACA,iBAAS,CAAC,WAAV,CAAsB,aAAtB,GAAsC,IAAtC;AACA,iBAAS,CAAC,WAAV,CAAsB,wBAAtB,GACE,SAAS,CAAC,aADZ;AAED;;AAED,YAAM,WAAW,GAAG,SAAS,CAAC,SAAV,CAAoB,UAAxC;;AACA,UAAI,WAAW,GAAG,EAAd,KAAqB,CAAzB,EAA4B;AAC1B,mBAAW,CAAC,UAAZ;AACA,mBAAW,CAAC,aAAZ;AACA,mBAAW,CAAC,oBAAZ;AACD;;AACD,iBAAW,CAAC,IAAZ,CAAiB,eAAe,WAAW,EAA3C;;AACA,UACE,KAAK,KAAL,CAAW,YAAX,KAA4B,CAAC,CAA7B,IACA,KAAK,KAAL,CAAW,YAAX,GAA0B,CAA1B,KAAgC,SAAS,CAAC,SAAV,CAAoB,UAFtD,EAGE;AACA,aAAK,KAAL,CAAW,KAAX,CAAiB,mBAAjB,IACE,SAAS,CAAC,SAAV,CAAoB,UAApB,GAAiC,KAAK,KAAL,CAAW,YAD9C,CADA,CAGA;AACD;;AACD,WAAK,KAAL,CAAW,YAAX,GAA0B,SAAS,CAAC,SAAV,CAAoB,UAA9C;AACA,YAAM,gBAAgB,GACpB,SAAS,CAAC,MAAV,CAAiB,IAAjB,GAAwB,SAAS,CAAC,MAAV,CAAiB,IAAzC,GAAgD,CADlD,CA5BE,CA8BF;;AACA,YAAM,KAAK,GAAG,IAAI,WAAJ,CACZ,IAAI,CAAC,KAAL,CAAW,gBAAX,EAA6B,gBAAgB,GAAG,gBAAhD,CADY,CAAd;AAGA,aAAO;AACL,iBADK;AAEL;AAFK,OAAP;AAID,KAtCD,CAsCE,OAAO,CAAP,EAAU;AACV,aAAO,CAAC,KAAR,CAAc,wBAAd,EAAwC,CAAxC;AACD;;AACD,WAAO,IAAP;AACD;;AACmB,QAAd,cAAc;AAClB,QAAI,KAAK,KAAL,CAAW,YAAf,EAA6B;AAC3B,kBAAY,CAAC,KAAK,KAAL,CAAW,YAAZ,CAAZ;AACD;;AACD,QAAI,mBAAmB,GAAG,CAA1B;AACA,QAAI,WAAW,GAAwB,IAAvC,CALkB,CAMlB;;AACA,UAAM,YAAY,GAAmB,EAArC;;AACA,WAAO,KAAK,KAAL,CAAW,MAAX,CAAkB,MAAlB,KAA6B,CAApC,EAAuC;AACrC,YAAM,KAAK,GAAG,KAAK,KAAL,CAAW,MAAX,CAAkB,KAAlB,EAAd;AACA,YAAM,WAAW,GAAG,KAAK,CAAC,SAA1B;AACA,YAAM,MAAM,GAAG,WAAW,CAAC,SAAZ,CAAsB,MAAtB,GAA+B,IAA/B,GAAsC,IAArD;;AACA,UAAI,MAAM,GAAG,mBAAb,EAAkC;AAChC,YAAI,WAAW,KAAK,IAApB,EAA0B;AACxB,sBAAY,CAAC,IAAb,CAAkB,WAAlB;AACD;;AACD,2BAAmB,GAAG,MAAtB;AACA,mBAAW,GAAG,KAAd;AACD;AACF,KAnBiB,CAoBlB;;;AACA,WAAO,YAAY,CAAC,MAAb,KAAwB,CAA/B,EAAkC;AAChC,YAAM,SAAS,GAAG,YAAY,CAAC,KAAb,EAAlB;AACA,YAAM,MAAM,GAAG,SAAS,CAAC,SAAV,CAAoB,SAApB,CAA8B,MAA9B,GAAuC,IAAvC,GAA8C,IAA7D;AACA,WAAK,KAAL,CAAW,KAAX,CAAiB,mBAAjB;;AACA,UAAI,KAAK,KAAL,CAAW,MAAf,EAAuB;AACpB,aAAK,KAAL,CAAW,MAAX,CAAgC,IAAhC,CACC,IAAI,CAAC,SAAL,CAAe;AACb,cAAI,EAAE,oBADO;AAEb,cAAI,EAAE,GAAG,mBAAmB,GAAG,MAAM,4BACnC,SAAS,CAAC,SAAV,CAAoB,SAApB,CAA8B,UAChC,EAJa;AAKb,cAAI,EAAE;AALO,SAAf,CADD;AASF,OAVD,MAUO;AACL,eAAO,CAAC,IAAR,CAAa,4BAAb;AACD;AACF,KAtCiB,CAwClB;;;AACA,QAAI,WAAW,KAAK,IAApB,EAA0B;AACxB,YAAM,KAAK,OAAL,CAAa,WAAb,CAAN,CADwB,CAExB;AACA;AACA;AACA;AACA;AACD;;AACD,SAAK,KAAL,CAAW,KAAX,CAAiB,mBAAjB,GAAuC,CAAvC;AACA,SAAK,KAAL,CAAW,KAAX,CAAiB,mBAAjB,GAAuC,CAAvC;AACD;;AA9M0B;;;;;ACvC7B,IAAI,2CAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,iBAAiB,2BAA2B,mBAAmB,OAAO,eAAe,6BAA6B,yCAAyC,uGAAuG,aAAa,OAAO,qFAAqF,cAAc,8BAA8B,wGAAwG,aAAa,OAAO,g/EAAg/E,aAAa,OAAO,2CAA2C,aAAa,OAAO,yDAAyD,aAAa,OAAO,2CAA2C,aAAa,OAAO,2DAA2D,aAAa,OAAO,2CAA2C,aAAa,OAAO,2DAA2D,qBAAqB,OAAO,6BAA6B,uBAAuB,OAAO,6BAA6B,uBAAuB,OAAO,6BAA6B,gBAAgB,sBAAsB;AACztH,IAAI,oDAAe;;;;;ACoDnB;AAGA,IAAqB,OAAO,GAA5B,MAAqB,OAArB,SAAqC,kCAArC,CAAwC;AAEzB,MAAT,SAAS;AACX,WAAO,KAAK,UAAL,GAAkB,YAAlB,GAAiC,wBAAxC;AACD;;AAJqC,CAAxC;;AAC4B,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,yCAAqB,CAArB;;AADP,OAAO,qCAD3B,wCAC2B,GAAP,OAAO,CAAP;sEAAA;;ACxD4a,CAAC,iFAAe,+BAAG,EAAC;;ACA/X;AAC3B;AACL;AACtD,CAAoE;;;AAGpE;AACmG;AACnG,IAAI,iBAAS,GAAG,sCAAU;AAC1B,EAAE,0CAAM;AACR,EAAE,2CAAM;AACR,EAAE,oDAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,yDAAe,iBAAS;;ACnBxB,IAAI,4DAAM,gBAAgB,aAAa,0BAA0B,wBAAwB,iBAAiB,8BAA8B,cAAc,yBAAyB,0BAA0B,WAAW,wBAAwB,mBAAmB,OAAO,eAAe,eAAe;AACpS;AACA;AACA,QAAQ;AACR,IAAI,qEAAe;;;;;;;;ACkBnB;AACA;AACA;AAGA,IAAqB,OAAO,GAA5B,MAAqB,OAArB,SAAqC,kCAArC,CAAwC;AAAxC;;AAME,kBAAS,EAAT;AACA,uBAAc,CAAd;AACA,wBAAe,KAAf;AA2DD;;AApDc,QAAP,OAAO;AACX;AACA,QAAI;AACF,WAAK,MAAL,GAAc,MAAM,SAAS,CAAC,YAAV,CAAuB,YAAvB,CAAoC;AACtD,aAAK,EAAE;AAD+C,OAApC,CAApB;AAIA,2BAAqB,CAAC,KAAK,SAAN,CAArB;AACD,KAND,CAME,OAAO,CAAP,EAAU;AACV,aAAO,CAAC,KAAR,CAAc,CAAd;AACA,yCAAyB,KAAzB;AACD;AACF;;AAED,WAAS;AACP,UAAM,KAAK,GAAG,KAAK,KAAL,CAAW,WAAzB;;AACA,QAAI,KAAJ,EAAW;AACT,YAAM;AAAE,kBAAF;AAAc;AAAd,UAAmC,KAAzC;;AACA,UAAI,UAAU,KAAK,gBAAnB,EAAqC;AACnC,cAAM,KAAK,GAAG,KAAK,CAAC,WAAN,GAAoB,KAAK,CAAC,UAAxC;AACA,cAAM,KAAK,GAAG,GAAd;AACA,cAAM,MAAM,GAAG,KAAK,GAAG,KAAvB;;AACA,YAAI,CAAC,KAAK,YAAV,EAAwB;AACtB,eAAK,KAAL,CAAW,WAAX,CAAuB,KAAvB,GAA+B,KAA/B;AACA,eAAK,KAAL,CAAW,WAAX,CAAuB,MAAvB,GAAgC,MAAhC;AACD;;AACD,cAAM,MAAM,GAAG,KAAK,KAAL,CAAW,WAA1B;AACA,cAAM,aAAa,GAAG,MAAM,CAAC,UAAP,CAAkB,IAAlB,CAAtB;AAEA,qBAAa,SAAb,iBAAa,WAAb,yBAAa,CAAE,SAAf,CAAyB,KAAzB,EAAgC,CAAhC,EAAmC,CAAnC,EAAsC,KAAtC,EAA6C,MAA7C;AACA,cAAM,KAAK,GAAG,aAAH,aAAG,aAAH,uBAAG,aAAa,CAAE,YAAf,CAA4B,CAA5B,EAA+B,CAA/B,EAAkC,KAAlC,EAAyC,MAAzC,CAAd;AACA,aAAK,YAAL,GAAoB,IAApB;;AAEA,YAAI,KAAJ,EAAW;AACT,cAAI,OAAJ,CAAY,MAAK;AACf,kBAAM,EAAE,GAAG,cAAI,CAAC,KAAK,CAAC,IAAP,EAAa,KAAK,CAAC,KAAnB,EAA0B,KAAK,CAAC,MAAhC,CAAf;AACA,kBAAM,iBAAiB,GAAG,IAAI,CAAC,KAAL,CACxB,CAAC,IAAI,CAAC,GAAL,KAAa,KAAK,WAAnB,IAAkC,IADV,CAA1B;;AAIA,gBAAI,EAAE,IAAI,EAAE,CAAC,IAAH,KAAY,EAAtB,EAA0B;AACxB,mBAAK,SAAL,CAAe,EAAf,EAAmB,iBAAnB,EAAsC;AACpC,qBAAK,EAAE,KAAK,CAAC,UADuB;AAEpC,sBAAM,EAAE,KAAK,CAAC;AAFsB,eAAtC;AAID;AACF,WAZD;AAaD;AACF;AACF;;AACD,yBAAqB,CAAC,KAAK,SAAN,CAArB;AACD;;AAlEqC,CAAxC;;AAC4B,kCAAzB,uCAAI,CAAC;AAAE,UAAQ,EAAE;AAAZ,CAAD,CAAqB,wCAIhB,CAJgB;;AADP,OAAO,qCAD3B,wCAC2B,GAAP,OAAO,CAAP;2EAAA;;AC3Bib,CAAC,sFAAe,oCAAG,EAAC;;ACAnX;AACvC;AACL;AAC3D,CAAiG;;;AAGjG;AACmG;AACnG,IAAI,sBAAS,GAAG,sCAAU;AAC1B,EAAE,+CAAM;AACR,EAAE,4DAAM;AACR,EAAE,qEAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,mDAAe,sBAAS;;ACnBxB;AAEA;;AAEA,SAAS,YAAT,GAAqB;AACnB,QAAM,qBAAqB,GAAI,OAAD,IAAqB,OAAO,GAAG,IAA7D;;AACA,QAAM,iBAAiB,GAAG,MACxB,qCAA2B,IAA3B,CAAgC,CAAC;AAAE;AAAF,GAAD,KAAmB,SAAnD,CADF;;AAEA,SAAO;AACL,oBAAgB,EAAE,CADb;AAEL,qBAAiB,EAAE,CAFd;AAGL,eAAW,EAAE,iBAAiB,EAHzB;AAIL,eAAW,EAAE,KAJR;;AAKL,UAAM,OAAN,CAAc,KAAd,EAA0B;AACxB,YAAM,WAAW,GAAG,KAAK,cAAL,CAAoB,KAApB,CAApB;AACA,YAAM;AAAE,eAAF;AAAW;AAAX,UAAyB,KAAK,oBAAL,CAA0B,KAA1B,CAA/B;AACA,WAAK,eAAL,CAAqB,KAArB;;AACA,UAAI,SAAS,IAAI,CAAC,KAAK,WAAvB,EAAoC;AAClC,cAAM,oCAAN;AACA,aAAK,WAAL,GAAmB,MAAM,iBAAiB,EAA1C;AACD,OAHD,MAGO,IAAI,OAAO,IAAI,KAAK,WAApB,EAAiC;AACtC,cAAM,YAAY,GAChB,WAAW,GAAG,qBAAqB,CAAC,CAAD,CAAnC,IACC,KAAK,WAAL,IAAoB,WAAW,GAAG,qBAAqB,CAAC,CAAD,CAF1D;AAGA,aAAK,WAAL,GAAmB,KAAnB;AACA,cAAM,kCAAwB,YAAxB,CAAN;AACA,aAAK,WAAL,GAAmB,MAAM,iBAAiB,EAA1C;AACD;AACF,KApBI;;AAqBL,mBAAe,CAAC,KAAD,EAAa;AAC1B,YAAM,KAAK,GAAG,KAAK,CAAC,cAAN,CAAqB,SAAnC;AACA,WAAK,WAAL,GACE,KAAK,KAAK,uBAAV,GAAoC,IAApC,GAA2C,KAAK,WADlD;AAED,KAzBI;;AA0BL,mBAAe,CAAC,KAAD,EAAa;AAC1B,YAAM,KAAK,GAAG,KAAK,CAAC,cAAN,CAAqB,SAAnC;AACA,aACE,KAAK,KAAK,wBAAV,IACA,KAAK,KAAK,yBADV,IAEA,KAAK,KAAK,2BAFV,IAGA,KAAK,KAAK,0BAHV,IAIA,KAAK,KAAK,6BAJV,IAKA,KAAK,KAAK,uBALV,IAMA,KAAK,KAAK,sBAPZ;AASD,KArCI;;AAsCL,sBAAkB,CAAC,KAAD,EAAa;AAC7B,YAAM,SAAS,GAAG,KAAK,eAAL,CAAqB,KAArB,CAAlB;AACA,YAAM,gBAAgB,GAAG,qBAAqB,CAAC,CAAD,CAA9C;AACA,YAAM,GAAG,GAAG,IAAI,CAAC,GAAL,EAAZ;AACA,WAAK,iBAAL,GAAyB,SAAS,GAAG,GAAH,GAAS,KAAK,iBAAhD;AACA,YAAM,gBAAgB,GAAG,IAAI,CAAC,GAAL,CAAS,GAAG,GAAG,KAAK,iBAApB,CAAzB;AACA,YAAM,OAAO,GAAG,gBAAgB,GAAG,gBAAnC;AACA,WAAK,iBAAL,GAAyB,OAAO,GAAG,QAAH,GAAc,KAAK,iBAAnD;AAEA,aAAO,OAAP;AACD,KAhDI;;AAiDL;AACA,wBAAoB,CAClB,KADkB,EACN;AAEZ,YAAM,SAAS,GAAG,KAAK,eAAL,CAAqB,KAArB,CAAlB;AACA,YAAM,OAAO,GAAG,KAAK,kBAAL,CAAwB,KAAxB,CAAhB;AACA,aAAO;AAAE,iBAAF;AAAa;AAAb,OAAP;AACD,KAxDI;;AAyDL,kBAAc,CAAC,KAAD,EAAa;AACzB,YAAM,GAAG,GAAG,IAAI,CAAC,GAAL,EAAZ;AACA,YAAM;AAAE,iBAAF;AAAa;AAAb,UAAyB,KAAK,oBAAL,CAA0B,KAA1B,CAA/B;;AACA,UAAI,SAAJ,EAAe;AACb,aAAK,gBAAL,GACE,KAAK,gBAAL,KAA0B,CAA1B,GAA8B,GAA9B,GAAoC,KAAK,gBAD3C;AAEA,eAAO,GAAG,GAAG,KAAK,gBAAlB;AACD,OAJD,MAIO,IAAI,KAAK,gBAAL,KAA0B,CAA9B,EAAiC;AACtC,eAAO,CAAP;AACD,OAFM,MAEA,IAAI,OAAJ,EAAa;AAClB;AACA,cAAM,gBAAgB,GAAG,GAAG,GAAG,KAAK,gBAApC;AACA,aAAK,gBAAL,GAAwB,CAAxB;AACA,eAAO,gBAAP;AACD,OALM,MAKA;AACL,eAAO,GAAG,GAAG,KAAK,gBAAlB;AACD;AACF;;AA1EI,GAAP;AA4ED;;AAED,oDAAe,YAAf;;;;;;;;;ACzBA;AACA;AACA;AACA;AAEA;AAIA;AASA;AACA;AAQA;AACA;AACA;AAGA;AAWA,IAAqB,GAAG,GAAxB,MAAqB,GAArB,SAAiC,kCAAjC,CAAoC;AAApC;;AACU,oBAAW,EAAX;AACA,sBAAa,EAAb;AACA,oBAAW,EAAX;AACA,sBAAa,EAAb;AAEA,oBAAqB,KAArB;AACA,2BAAkB,IAAlB;AACA,0CAAiC,KAAjC;AACA,wBAAe,aAAY,EAA3B;AAsCA,kBAIJ;AAAE,UAAI,EAAE,IAAR;AAAc,gBAAU,EAAE;AAAE,cAAM,EAAE,CAAV;AAAa,aAAK,EAAE;AAApB,OAA1B;AAAmD,cAAQ,EAAE;AAA7D,KAJI;AAMA,4BAAmB,CAAnB;AACA,6BAAoB,QAApB;AACA,uBAAc,KAAd;AACA,yBAAgB,KAAhB;AACA,0BAAmC,MAAnC;AACA,qBAA8B,EAA9B;AACA,qBAA8B,EAA9B;AAkSA,4CAAmC,KAAnC;AACA,yBAAgB,IAAhB;AACA,yBAAgB,KAAhB;AA0ET;;AA9ZsB,MAAjB,iBAAiB;AACnB,WACE,MAAM,CAAC,SAAP,CAAiB,SAAjB,CAA2B,QAA3B,CAAoC,kBAApC,KACA,KAAK,yBAFP;AAID;;AAEO,MAAJ,IAAI;AAAA;;AACN,WAAO,+BAAK,QAAL,CAAc,YAAd,gFAA4B,cAA5B,CAA2C,IAA3C,KAAmD,IAA1D;AACD;;AAEa,MAAV,UAAU;AACZ,WAAO,KAAK,QAAL,CAAc,qBAAd,KAAwC,uBAA/C;AACD;;AAES,MAAN,MAAM;AACR,WAAO,gCAAP;AACD;;AAE4B,MAAzB,yBAAyB;AAC3B,WAAO,MAAM,CAAC,SAAP,CAAiB,SAAjB,KAA+B,iBAAtC;AACD;;AAEwB,MAArB,qBAAqB;AACvB,WAAO,MAAM,CAAC,SAAP,CAAiB,SAAjB,CAA2B,QAA3B,CAAoC,MAApC,CAAP;AACD;;AAEqB,QAAhB,gBAAgB;AACpB,QAAI;AACF,YAAM,QAAQ,CAAC,IAAT,CAAc,iBAAd,EAAN;AACA,WAAK,eAAL,GAAuB,KAAvB;AACD,KAHD,CAGE,OAAO,CAAP,EAAU;AACV;AACD;AACF;;AAoBO,YAAU;AAChB,SAAK,aAAL,GAAqB,IAArB;AACD;;AAE2B,MAAjB,iBAAiB;AAC1B;AACA,QAAK,KAAK,QAAL,CAAc,YAAd,CAAqC,SAA1C,EAAqD;AACnD,aAAQ,KAAK,QAAL,CAAc,YAAd,CAAqC,SAArC,CAA+C,SAA/C,CACL,UADH;AAED;;AACD,WAAO,CAAP;AACD;;AAEM,WAAS,CACd,IADc,EAEd,QAAQ,GAAG,CAFG,EAGd,UAHc,EAGgC;AAE9C,SAAK,MAAL,GAAc;AAAE,UAAF;AAAQ,gBAAR;AAAoB;AAApB,KAAd;AACD;;AAEa,MAAV,UAAU;AACZ,QAAI,KAAK,MAAL,CAAY,IAAZ,IAAoB,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,KAA0B,IAAlD,EAAwD;AACtD,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD;;AAED,mBAAiB,CAAC,eAAD,EAAmC,SAAS,GAAG,KAA/C,EAAoD;AACnE,QAAI,CAAC,SAAD,IAAc,KAAK,QAAL,CAAc,IAAd,KAAuB,eAAe,CAAC,aAAzD,EAAwE;AACtE,WAAK,8BAAL,GAAsC,IAAtC;AACA,gBAAU,CAAC,MAAK;AACd,aAAK,8BAAL,GAAsC,KAAtC;AACD,OAFS,EAEP,IAFO,CAAV;AAGD;;AACD,SAAK,QAAL,CAAc,kBAAd,CAAiC,qBAAjC,GAAyD,IAAI,cAAJ,CACvD,eAAe,CAAC,cADuC,CAAzD;AAGA,SAAK,QAAL,CAAc,kBAAd,CAAiC,sBAAjC,GACE,IAAI,cAAJ,CAAmB,eAAe,CAAC,kBAAnC,CADF;AAEA,SAAK,QAAL,CAAc,kBAAd,CAAiC,iBAAjC,GACE,eAAe,CAAC,iBADlB;AAEA,SAAK,QAAL,CAAc,kBAAd,CAAiC,IAAjC,GAAwC;AACtC,QAAE,EAAE;AAAE,SAAC,EAAE,eAAe,CAAC,OAArB;AAA8B,SAAC,EAAE,eAAe,CAAC;AAAjD,OADkC;AAEtC,QAAE,EAAE;AAAE,SAAC,EAAE,eAAe,CAAC,OAArB;AAA8B,SAAC,EAAE,eAAe,CAAC;AAAjD,OAFkC;AAGtC,QAAE,EAAE;AAAE,SAAC,EAAE,eAAe,CAAC,OAArB;AAA8B,SAAC,EAAE,eAAe,CAAC;AAAjD,OAHkC;AAItC,QAAE,EAAE;AAAE,SAAC,EAAE,eAAe,CAAC,OAArB;AAA8B,SAAC,EAAE,eAAe,CAAC;AAAjD;AAJkC,KAAxC;AAMA,SAAK,QAAL,CAAc,kBAAd,CAAiC,eAAjC,GACE,eAAe,CAAC,cADlB;AAEA,SAAK,QAAL,CAAc,kBAAd,CAAiC,gBAAjC,GACE,eAAe,CAAC,eADlB;AAEA,SAAK,QAAL,CAAc,kBAAd,CAAiC,cAAjC,GACE,eAAe,CAAC,aADlB;AAED;;AAEe,MAAZ,YAAY;AACd,WAAO,KAAK,QAAL,CAAc,YAArB;AACD;;AAEkB,MAAf,eAAe;AAAA;;AACjB,UAAM,SAAS,sBAAG,KAAK,SAAR,oDAAG,gBAAgB,SAAlC;;AACA,QAAI,SAAJ,EAAe;AACb,UAAI,UAAJ,CADa,CAEb;AACA;;AACA,UAAI,KAAK,aAAT,EAAwB;AACtB,kBAAU,GAAG,SAAS,CAAC,MAAV,GAAmB,IAAnB,GAA0B,IAA1B,GAAiC,IAA9C;AACD,OAFD,MAEO;AACL,kBAAU,GAAG,SAAS,CAAC,MAAV,GAAmB,IAAhC;AACD;;AACD,aAAO,UAAP;AACD;;AACD,WAAO,mBAAP;AACD;;AAEc,MAAX,WAAW;AACb,WAAO,CAAC,KAAK,aAAN,IAAuB,KAAK,eAAL,GAAuB,mBAArD;AACD;;AAEsB,MAAnB,mBAAmB;AACrB,QAAI,KAAK,aAAT,EAAwB;AACtB,aAAO,CAAP;AACD;;AACD,WAAO,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,mBAAmB,GAAG,KAAK,eAAvC,CAAP;AACD;;AAEmB,MAAhB,gBAAgB;AAAA;;AAClB,UAAM,SAAS,uBAAG,KAAK,SAAR,qDAAG,iBAAgB,SAAlC;;AACA,QAAI,CAAC,KAAK,WAAN,IAAqB,SAAzB,EAAoC;AAClC;AACA,aACE,CAAC,SAAS,CAAC,MAAV,GAAmB,SAAS,CAAC,WAA9B,IAA6C,IAA7C,GACA,2BAFF;AAID;;AACD,WAAO,KAAP;AACD;;AAEkB,MAAf,eAAe;AACjB;AACA,WAAO,KAAK,QAAL,CAAc,aAAd,GAA8B,IAAI,IAAJ,GAAW,OAAX,KAAuB,IAA5D;AACD;;AAEqB,MAAlB,kBAAkB;AACpB;AACA,WAAO,EAAE,KAAK,QAAL,CAAc,aAAd,GAA8B,IAAI,IAAJ,GAAW,OAAX,KAAuB,IAAvD,CAAP;AACD;;AAEc,MAAX,WAAW;AACb,WACE,KAAK,QAAL,CAAc,qBAAd,KAAwC,+BAD1C;AAGD;;AAEe,MAAZ,YAAY;AACd,WACE,KAAK,QAAL,CAAc,qBAAd,KAAwC,gCAD1C;AAGD;;AAEO,mBAAiB,CAAC,IAAD,EAAiB;AACxC,SAAK,SAAL,GAAiB,KAAK,SAAtB;AACA,UAAM,KAAK,GAAG,EAAd;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,IAAI,CAAC,MAAzB,EAAiC,CAAC,IAAI,CAAtC,EAAyC;AACvC,YAAM,CAAC,GAAG,IAAI,CAAC,CAAD,CAAd;AACA,YAAM,EAAE,GAAG,IAAI,CAAC,CAAC,GAAG,CAAL,CAAf;AACA,YAAM,EAAE,GAAG,IAAI,CAAC,CAAC,GAAG,CAAL,CAAf;AACA,WAAK,CAAC,IAAN,CAAW;AAAE,UAAF;AAAM,UAAN;AAAU;AAAV,OAAX;AACD;;AACD,wBAAoB,GAApB;;AACA,QAAI,KAAK,CAAC,MAAV,EAAkB;AAChB,WAAK,SAAL,GAAiB,CAAC,MAAM,CAAC,MAAP,CAAc,KAAd,CAAD,CAAjB;AACD,KAFD,MAEO;AACL,WAAK,SAAL,GAAiB,EAAjB;AACD;AACF;;AAEO,kCAAgC,CAAC,KAAD,EAAa;AACnD,UAAM,OAAO,GAAG,KAAK,CAAC,SAAN,CAAgB,UAAhB,CAA2B,OAA3B,CAAmC,IAAnC,CAAhB;;AACA,QAAI,OAAO,KAAK,CAAC,CAAjB,EAAoB;AAClB,WAAK,CAAC,SAAN,CAAgB,UAAhB,GAA6B,KAAK,CAAC,SAAN,CAAgB,UAAhB,CAA2B,SAA3B,CAC3B,CAD2B,EAE3B,OAF2B,CAA7B;AAID,KAPkD,CAQnD;;;AACA,2BAAuB,CACrB,KAAK,CAAC,SAAN,CAAgB,aADK,EAErB,KAAK,CAAC,SAAN,CAAgB,UAFK,EAGrB,KAAK,aAHgB,CAAvB;AAKD;;AAEO,qCAAmC,CAAC,KAAD,EAAa;AACtD,QAAI,KAAK,SAAT,EAAoB;AAClB,YAAM,eAAe,GAAG,IAAI,CAAC,SAAL,CAAe,KAAK,SAAL,CAAe,WAA9B,CAAxB;AACA,YAAM,eAAe,GAAG,IAAI,CAAC,SAAL,CAAe,KAAK,CAAC,SAAN,CAAgB,WAA/B,CAAxB;;AACA,UAAI,eAAe,KAAK,eAAxB,EAAyC;AACvC,aAAK,iBAAL,CAAuB,KAAK,CAAC,SAAN,CAAgB,WAAvC;AACD;AACF;AACF;;AAEoB,QAAP,OAAO,CAAC,KAAD,EAAa;AAChC,SAAK,gCAAL,CAAsC,KAAtC;AACA,SAAK,mCAAL,CAAyC,KAAzC;AACA,SAAK,iBAAL,CAAuB,KAAK,CAAC,SAA7B;AACA,SAAK,QAAL,CAAc,aAAd,GAA8B,IAAI,IAAJ,GAAW,OAAX,EAA9B;;AAEA,QAAI,sCAAJ,EAAkC;AAChC,WAAK,YAAL,CAAkB,OAAlB,CAA0B,KAA1B;AACD;;AAED,QAAI,KAAK,CAAC,cAAN,CAAqB,UAArB,CAAgC,IAAhC,CAAqC,MAArC,CAA4C,CAA5C,GAAgD,EAApD,EAAwD;AACtD,WAAK,cAAL,GAAsB,MAAtB;AACD,KAFD,MAEO;AACL,WAAK,cAAL,GAAsB,OAAtB;AACD;;AAED,QAAI,KAAK,WAAT,EAAsB;AACpB,WAAK,QAAL,CAAc,qBAAd,GAAsC,yBAAtC;AACD,KAFD,MAEO;AACL;AACA,UAAI,cAAc,GAChB,KAAK,CAAC,SAAN,CAAgB,SAAhB,CAA0B,MAA1B,GACA,KAAK,CAAC,SAAN,CAAgB,SAAhB,CAA0B,WAF5B;;AAGA,UAAI,KAAK,aAAT,EAAwB;AACtB;AACA,sBAAc,GAAG,cAAc,GAAG,IAAjB,GAAwB,IAAzC;AACD;;AAED,YAAM,WAAW,GAAG,mBAAmB,GAAG,cAA1C;AACA,YAAM,kBAAkB,GAAG,KAAK,QAAL,CAAc,qBAAzC;AACA,YAAM,kBAAkB,GAAG,KAAK,CAAC,cAAN,CAAqB,SAAhD;;AAEA,UACE,kBAAkB,KAAK,0BAAvB,IACA,kBAAkB,KAAK,uBAFzB,EAGE;AACA,cAAM,IAAI,GAAG,KAAK,CAAC,cAAN,CAAqB,IAAlC;AACA,cAAM,UAAU,GAAG,KAAK,CAAC,cAAN,CAAqB,UAAxC;AACA,aAAK,sBAAL,CAA4B,UAA5B,EAAwC,IAAxC,EAA8C,KAA9C,sFACK,IAAI,CAAC,WADV;AAEE,WAAC,EAAE,IAAI,CAAC,WAFV;AAGE,WAAC,EAAE,IAAI,CAAC;AAHV;AAKD,OAXD,MAWO,IACL,kBAAkB,KAAK,uBAAvB,IACA,kBAAkB,KAAK,oBAFlB,EAGL;AACA,YAAI,KAAK,iBAAT,EAA4B;AAAA;;AAC1B,cAAI,WAAW,GAAG,KAAK,IAAvB,EAA6B;AAC3B;AACA;AACA;AACD;;AACD,4CACE,KAAK,QADP,EAEE,KAAK,QAFP,EAGE,KAAK,QAAL,CAAc,qBAHhB,EAIE,KAAK,QAAL,CAAc,kBAAd,CAAiC,iBAJnC,uBAKE,KAAK,MAAL,CAAY,IALd,sDAKE,kBAAkB,IALpB;AAOD;;AAED,aAAK,QAAL,CAAc,qBAAd,GAAsC,IAAtC;AACD,OApBM,MAoBA,IAAI,KAAK,iBAAL,IAA0B,WAAW,GAAG,KAAK,IAAjD,EAAuD;AAC5D;AACA;AACA;AACA;AACD;;AACD,WAAK,QAAL,CAAc,qBAAd,GAAsC,kBAAtC;;AACA,UAAI,kBAAkB,KAAK,uBAA3B,EAAoD;AAClD,aAAK,SAAL,CAAe,IAAf;AACD;AACF;;AACD,SAAK,QAAL,CAAc,YAAd,GAA6B,KAA7B;AACD;;AAEY,MAAT,SAAS;AAAA;;AACX,qCAAO,KAAK,QAAL,CAAc,YAArB,2DAAO,uBAA4B,SAAnC;AACD;;AAED,wBAAsB,CACpB,gBADoB,EAEpB,IAFoB,EAGpB,KAHoB,EAIpB,MAJoB,EAIkC;AAEtD,SAAK,QAAL,CAAc,qBAAd,GAAsC;AACpC,yBAAmB,EAAE,MAAM,CAAC,CADQ;AAEpC,qBAAe,EAAE,MAAM,CAAC,CAFY;AAGpC,aAAO,EAAE,MAAM,CAAC,CAHoB;AAIpC,aAAO,EAAE,MAAM,CAAC,CAJoB;AAKpC,WALoC;AAMpC,eAAS,EAAE,IAAI,IAAJ,EANyB;AAOpC,sBAPoC;AAQpC;AARoC,KAAtC;AAUA;AACD;;AAED,yBAAuB,CAAC,UAAD,EAAkC;AACvD,SAAK,QAAL,CAAc,qBAAd,GAAsC,UAAtC;AACD;;AAEO,yBAAuB,CAAC,QAAD,EAAiB;AAC9C,wCAAyB,QAAzB,EAAmC,IAAnC,CAAyC,MAAD,IAAgB;AACtD,UAAI,MAAM,KAAK,SAAf,EAA0B;AACxB,cAAM,MAAM,GAAG,MAAM,CAAC,kBAAP,CAA0B,MAA1B,CAAf;AACA,iDAA+B,MAA/B;AACA,wDAAsC,CAAC,MAAvC;AACD,OAJD,MAIO;AACL,wDAAsC,KAAtC;AACA,iDACE,MAAM,CAAC,YAAP,CAAoB,OAApB,CAA4B,oBAA5B,MAAsD,OAAtD,GACI,KADJ,GAEI,IAHN;AAID;AACF,KAZD;AAaD;;AAMY,QAAP,OAAO;AACX,QAAI,YAAY,GAAG,6CAAnB,CADW,CAEX;;AACA,UAAM,GAAG,GAAG,MAAM,CAAC,QAAP,CAAgB,MAAhB,CAAuB,SAAvB,CAAiC,CAAjC,CAAZ;AACA,UAAM,MAAM,GAAG,IAAI,eAAJ,CAAoB,GAApB,CAAf;;AACA,QAAI,MAAM,CAAC,GAAP,CAAW,UAAX,CAAJ,EAA4B;AAC1B,kBAAY,GAAG,eAAe,MAAM,CAAC,GAAP,CAAW,UAAX,CAAsB,OAApD;AACA,WAAK,aAAL,GAAqB,KAArB;AACD;;AACD,uCACE,MAAM,CAAC,YAAP,CAAoB,OAApB,CAA4B,cAA5B,MAAgD,OAAhD,GAA0D,KAA1D,GAAkE,IADpE,CATW,CAYX;;AACA,QAAI,KAAK,aAAT,EAAwB;AACtB,WAAK,QAAL,CAAc,IAAd,GAAqB,IAAI,IAAJ,GAAW,OAAX,EAArB;AACA,YAAM,kCAAwB,KAAxB,CAAN;AACA,2CAA2B,IAA3B,CAAiC,mBAAD,IAAwB;AACtD,YAAI,mBAAmB,KAAK,IAA5B,EAAkC;AAChC,6BAAmB,GAAG,4CAAK,+BAAR,CAAnB;AACD;;AACD,aAAK,iBAAL,CAAuB,mBAAvB,EAA4C,IAA5C;AACA,8CAA4B,IAA5B,CAAiC,CAAC;AAAE,oBAAF;AAAc;AAAd,SAAD,KAAkC;AACjE,2CAAuB,IAAvB,CAA4B,CAAC;AAAE,oBAAF;AAAY,sBAAZ;AAAwB;AAAxB,WAAD,KAAqC;AAC/D,iBAAK,QAAL,GAAgB,QAAhB;AACA,iBAAK,UAAL,GAAkB,UAAlB;AACA,iBAAK,QAAL,GAAgB,MAAhB;AACA,kBAAM,OAAO,GAAG,UAAU,CAAC,OAAX,CAAmB,IAAnB,CAAhB;AACA,gBAAI,aAAa,GAAG,UAApB;AACA,iBAAK,uBAAL,CAA6B,QAA7B;AACA,uBAAW,CAAC,MAAK;AACf,mBAAK,uBAAL,CAA6B,QAA7B;AACD,aAFU,EAER,OAAO,EAAP,GAAY,EAFJ,CAAX,CAP+D,CAS3C;;AACpB,gBAAI,OAAO,KAAK,CAAC,CAAjB,EAAoB;AAClB,2BAAa,GAAG,aAAa,CAAC,SAAd,CAAwB,CAAxB,EAA2B,OAA3B,CAAhB;AACD;;AACD,iBAAK,UAAL,GAAkB,aAAlB;;AACA,gBACE,uBAAuB,CACrB,aADqB,EAErB,aAFqB,EAGrB,KAAK,aAHgB,CADzB,EAME;AACA,mBAAK,gCAAL,GAAwC,IAAxC;AACD;AACF,WAvBD;AAwBD,SAzBD;AA0BD,OA/BD;AAgCD;;AACD,UAAM,aAAa,GAAG,IAAI,0BAAJ,EAAtB;;AACA,iBAAa,CAAC,SAAd,GAA2B,OAAD,IAAY;AACpC,YAAM,YAAY,GAAG,OAAO,CAAC,IAA7B;;AACA,cAAQ,YAAY,CAAC,IAArB;AACE,aAAK,UAAL;AACE,eAAK,OAAL,CAAa,YAAY,CAAC,OAA1B;AACA,eAAK,aAAL,GAAqB,IAArB;AACA;;AACF,aAAK,uBAAL;AACE,eAAK,uBAAL,CACE,YAAY,CAAC,OADf;AAGA;AATJ;AAWD,KAbD;;AAeA,iBAAa,CAAC,WAAd,CAA0B;AACxB,mBAAa,EAAE,KAAK,aADI;AAExB,cAAQ,EAAE,MAAM,CAAC,QAAP,CAAgB,QAFF;AAGxB,UAAI,EAAE,MAAM,CAAC,QAAP,CAAgB,IAHE;AAIxB,wBAAkB,EAAE;AAJI,KAA1B;AAMD;;AAxaiC,CAApC;AAAqB,GAAG,qCARvB,4CAAS,CAAC;AACT,YAAU,EAAE;AACV,uBADU;AAEV,eAFU;AAGV,WAHU;AAIV,WAAO;AAJG;AADH,CAAD,CAQc,GAAH,GAAG,CAAH;kEAAA;;ACxGsZ,CAAC,sEAAe,2BAAG,EAAC;;;;;;ACA7W;AAC3B;AACL;AAClD,CAAgE;;;AAGhE;AACgG;AAChG,IAAI,aAAS,GAAG,sCAAU;AAC1B,EAAE,+BAAM;AACR,EAAE,MAAM;AACR,EAAE,eAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,8CAAe,aAAS,QAAQ;;AAEhC;AACA,CAAgG;AAC7C;AACA;AACE;AACO;AACF;AACD;AACE;AACE;AAC7D,2BAAiB,CAAC,aAAS,GAAG,IAAI,0BAAK,2BAAM,mCAAa,kDAAW,6CAAQ,iCAAS,mCAAU,2BAAC;;;;;AC/BjG;AACA;AACA,uCAAQ,wBAAR;AAEA,8CAAe,IAAI,wBAAJ,CAAY;AACzB,OAAK,EAAE;AACL,YAAQ,EAAE;AADL;AADkB,CAAZ,CAAf;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,2EAA2B,KAA3B;AAEO,MAAM,mBAAmB,GAAG,EAA5B,EAAgC;;AAChC,MAAM,2BAA2B,GAAG,CAApC;AACA,MAAM,mBAAmB,GAAG,OAAO,EAAP,GAAY,EAAxC,EAA4C;AAEnD;;AACO,MAAM,UAAU,GAAG;AAAE,QAAM,EAAE;AAAV,CAAnB;AACA,MAAM,KAAK,GAAa;AAC7B,cAAY,EAAE,IADe;AAE7B,uBAAqB,EAAE,kCAFM;AAG7B,MAAI,EAAE,IAHuB;AAI7B,QAAM,EAAE,KAJqB;AAK7B,oBAAkB,EAAE;AAClB,0BAAsB,EAAE,IAAI,cAAJ,CAAmB,EAAnB,CADN;AAElB,4BAAwB,EAAE,KAFR;AAGlB,8BAA0B,EAAE,KAHV;AAIlB,aAAS,EAAE,IAAI,IAAJ,EAJO;AAKlB,QAAI,EAAE;AACJ,QAAE,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX,OADA;AAEJ,QAAE,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX,OAFA;AAGJ,QAAE,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX,OAHA;AAIJ,QAAE,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX;AAJA,KALY;AAWlB,qBAAiB,EAAE,2BAXD;AAYlB,yBAAqB,EAAE,IAAI,cAAJ,CAAmB,CAAnB,CAZL;AAalB,kBAAc,EAAE,IAbE;AAclB,mBAAe,EAAE,IAdC;AAelB,oBAAgB,EAAE;AAfA,GALS;AAsB7B,uBAAqB,EAAE,IAtBM;AAuB7B,uBAAqB,EAAE,mBAvBM;AAwB7B,iCAA+B,EAAE,CAAC,CAxBL;AAyB7B,eAAa,EAAE,CAzBc;AA0B7B,MAAI,EAAE,CA1BuB;AA2B7B,gBAAc,EAAE;AACd,gBAAY,EAAE,CADA;AAEd,sBAAkB,EAAE,CAFN;AAGd,aAAS,EAAE;AACT,SAAG,EAAE,CADI;AAET,SAAG,EAAE,CAFI;AAGT,eAAS,EAAE;AAHF,KAHG;AAQd,QAAI,EAAE;AACJ,aAAO,EAAE,KADL;AAEJ,cAAQ,EAAE,CAFN;AAGJ,kBAAY,EAAE,GAHV;AAIJ,iBAAW,EAAE;AAAE,SAAC,EAAE,CAAL;AAAQ,SAAC,EAAE;AAAX,OAJT;AAKJ,iBAAW,EAAE,CALT;AAMJ,gBAAU,EAAE,CANR;AAOJ,UAAI,EAAE;AACJ,eAAO,EAAE;AAAE,WAAC,EAAE,CAAL;AAAQ,WAAC,EAAE;AAAX,SADL;AAEJ,gBAAQ,EAAE;AAAE,WAAC,EAAE,CAAL;AAAQ,WAAC,EAAE;AAAX,SAFN;AAGJ,kBAAU,EAAE;AAAE,WAAC,EAAE,CAAL;AAAQ,WAAC,EAAE;AAAX,SAHR;AAIJ,mBAAW,EAAE;AAAE,WAAC,EAAE,CAAL;AAAQ,WAAC,EAAE;AAAX;AAJT;AAPF,KARQ;AAsBd,cAAU,EAAE;AACV,UAAI,EAAE;AACJ,cAAM,EAAE;AACN,WAAC,EAAE,CADG;AAEN,WAAC,EAAE;AAFG,SADJ;AAKJ,cAAM,EAAE;AALJ,OADI;AAQV,SAAG,EAAE,CARK;AASV,UAAI,EAAE;AATI,KAtBE;AAiCd,WAAO,EAAE,KAjCK;AAkCd,aAAS,EAAE,mBAlCG;AAmCd,aAAS,EAAE,CAnCG;AAoCd,kBAAc,EAAE;AApCF;AA3Ba,CAAxB;AAmEA,MAAM,mBAAmB,GAAG,qDAAe,SAAf,CAA5B;AAEP;;;;;;AAMG;;AAEH,IAAI,8BAAJ,CAAQ;AACN,SADM;AAEN,QAAM,EAAE,CAAC,IAAI,CAAC,CAAC,OAAD;AAFR,CAAR,EAGG,MAHH,CAGU,MAHV;;;;;;;AC7FA;AACA,oBAAoB,qBAAuB;AAC3C;;;;;;UCFA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;;;;;WC5BA;WACA;WACA;WACA;WACA,+BAA+B,wCAAwC;WACvE;WACA;WACA;WACA;WACA,iBAAiB,qBAAqB;WACtC;WACA;WACA,kBAAkB,qBAAqB;WACvC;WACA;WACA,KAAK;WACL;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;;;;WC3BA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,EAAE;WACF;;;;;WCRA;WACA;WACA;WACA;WACA;;;;;WCJA;WACA;WACA;WACA;WACA;;;;;WCJA;WACA;WACA;WACA;WACA,GAAG;WACH;WACA;WACA,CAAC;;;;;WCPD;;;;;WCAA;WACA;WACA;WACA;WACA,uBAAuB,4BAA4B;WACnD;WACA;WACA;WACA,iBAAiB,oBAAoB;WACrC;WACA,mGAAmG,YAAY;WAC/G;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,mEAAmE,iCAAiC;WACpG;WACA;WACA;WACA;;;;;WCzCA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;WCNA;;;;;WCAA;;WAEA;WACA;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA;WACA,iCAAiC;;WAEjC;WACA;WACA;WACA,KAAK;WACL,eAAe;WACf;WACA;WACA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,MAAM;WACN;WACA;WACA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,MAAM,qBAAqB;WAC3B;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA;;;;;WCnFA;WACA;;WAEA,4BAA4B;;WAE5B;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,KAAK;WACL;WACA;WACA;WACA,KAAK;WACL;WACA;WACA;WACA,KAAK;WACL;WACA;WACA;WACA,KAAK;WACL;WACA;WACA;WACA;WACA;WACA;WACA,EAAE;WACF;;WAEA;WACA;WACA;WACA;WACA;;WAEA;WACA;;WAEA;WACA;;WAEA;;WAEA;WACA;;WAEA;WACA;WACA;WACA;WACA;WACA,iDAAiD,OAAO,+BAA+B;WACvF;WACA;WACA;WACA;WACA,KAAK;WACL,KAAK;WACL;WACA,KAAK;WACL,8CAA8C,yBAAyB;WACvE;WACA;WACA,KAAK;WACL;WACA;WACA;WACA,IAAI;WACJ;WACA,EAAE;WACF;;;;;UEhFA;UACA;UACA;UACA;UACA","sources":["webpack://frontend/./src/App.vue?f37f","webpack://frontend/./src/components/UserFacingScreening.vue?4a46","webpack://frontend/./src/types.ts","webpack://frontend/./src/utils.ts","webpack://frontend/./src/components/AdminSettings.vue?7581","webpack://frontend/./src/components/CalibrationSettings.vue?9f86","webpack://frontend/./src/components/VideoStream.vue?a122","webpack://frontend/./src/components/VideoCropControls.vue?a536","webpack://frontend/./src/components/VideoCropControls.vue","webpack://frontend/./src/components/VideoCropControls.vue?f46c","webpack://frontend/./src/components/VideoCropControls.vue?ea43","webpack://frontend/./src/components/VideoStream.vue","webpack://frontend/./src/components/VideoStream.vue?8bbf","webpack://frontend/./src/components/VideoStream.vue?f337","webpack://frontend/./src/api/api.ts","webpack://frontend/./src/components/CalibrationSettings.vue","webpack://frontend/./src/components/CalibrationSettings.vue?368a","webpack://frontend/./src/components/CalibrationSettings.vue?db4f","webpack://frontend/./src/components/DeviceInfo.vue?3a54","webpack://frontend/./src/components/DeviceInfo.vue","webpack://frontend/./src/components/DeviceInfo.vue?a93c","webpack://frontend/./src/components/DeviceInfo.vue?b22e","webpack://frontend/./src/components/DeveloperUtilities.vue?c833","webpack://frontend/./src/components/DeveloperUtilities.vue","webpack://frontend/./src/components/DeveloperUtilities.vue?0f1b","webpack://frontend/./src/components/DeveloperUtilities.vue?5497","webpack://frontend/./src/components/AdminSettings.vue","webpack://frontend/./src/components/AdminSettings.vue?6a19","webpack://frontend/./src/components/AdminSettings.vue?d81e","webpack://frontend/./src/components/UserFacingScreening.vue","webpack://frontend/./src/components/UserFacingScreening.vue?063e","webpack://frontend/./src/components/UserFacingScreening.vue?120d","webpack://frontend/./src/camera.ts","webpack://frontend/./src/components/QRImage.vue?bfe1","webpack://frontend/./src/components/QRImage.vue","webpack://frontend/./src/components/QRImage.vue?2338","webpack://frontend/./src/components/QRImage.vue?187a","webpack://frontend/./src/components/QRCameraFeed.vue?4bd8","webpack://frontend/./src/components/QRCameraFeed.vue","webpack://frontend/./src/components/QRCameraFeed.vue?d988","webpack://frontend/./src/components/QRCameraFeed.vue?484c","webpack://frontend/./src/frame-handler.ts","webpack://frontend/./src/App.vue","webpack://frontend/./src/App.vue?275f","webpack://frontend/./src/App.vue?130d","webpack://frontend/./src/plugins/vuetify.ts","webpack://frontend/./src/main.ts","webpack://frontend/./src/frame-listener.ts","webpack://frontend/webpack/bootstrap","webpack://frontend/webpack/runtime/chunk loaded","webpack://frontend/webpack/runtime/compat get default export","webpack://frontend/webpack/runtime/define property getters","webpack://frontend/webpack/runtime/ensure chunk","webpack://frontend/webpack/runtime/get javascript chunk filename","webpack://frontend/webpack/runtime/get mini-css chunk filename","webpack://frontend/webpack/runtime/global","webpack://frontend/webpack/runtime/hasOwnProperty shorthand","webpack://frontend/webpack/runtime/load script","webpack://frontend/webpack/runtime/make namespace object","webpack://frontend/webpack/runtime/publicPath","webpack://frontend/webpack/runtime/jsonp chunk loading","webpack://frontend/webpack/runtime/wasm chunk loading","webpack://frontend/webpack/before-startup","webpack://frontend/webpack/startup","webpack://frontend/webpack/after-startup"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',{attrs:{\"id\":\"app\"},on:{\"skip-warmup\":_vm.skipWarmup}},[_c('UserFacingScreening',{attrs:{\"on-reference-device\":_vm.isReferenceDevice,\"state\":_vm.appState.currentScreeningState,\"screening-event\":_vm.appState.currentScreeningEvent,\"calibration\":_vm.appState.currentCalibration,\"face\":_vm.face,\"warmup-seconds-remaining\":_vm.remainingWarmupTime,\"shapes\":[_vm.prevShape, _vm.nextShape],\"isTesting\":!_vm.useLiveCamera,\"thermal-ref-side\":_vm.thermalRefSide,\"showCanvas\":!_vm.qrMode || !_vm.finishScan || (_vm.finishScan && _vm.registered)}}),_c('v-dialog',{attrs:{\"width\":\"500\"},model:{value:(_vm.showSoftwareVersionUpdatedPrompt),callback:function ($$v) {_vm.showSoftwareVersionUpdatedPrompt=$$v},expression:\"showSoftwareVersionUpdatedPrompt\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\" This software has been updated. \"+_vm._s(_vm.appVersion)+\" \")]),_c('v-card-actions',{attrs:{\"center\":\"\"}},[_c('v-btn',{attrs:{\"text\":\"\"},on:{\"click\":function (e) { return (_vm.showSoftwareVersionUpdatedPrompt = false); }}},[_vm._v(\" Proceed \")])],1)],1)],1),_c('v-overlay',{attrs:{\"absolute\":\"\",\"width\":\"500\"},model:{value:(_vm.isNotGettingFrames),callback:function ($$v) {_vm.isNotGettingFrames=$$v},expression:\"isNotGettingFrames\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\" Waiting for camera input... \")])],1)],1),_c('v-snackbar',{model:{value:(_vm.showUpdatedCalibrationSnackbar),callback:function ($$v) {_vm.showUpdatedCalibrationSnackbar=$$v},expression:\"showUpdatedCalibrationSnackbar\"}},[_vm._v(\" Calibration was updated \")]),(_vm.qrMode && _vm.finishScan && !_vm.registered)?_c('QRVideo',{attrs:{\"setQRCode\":_vm.setQRCode}}):_vm._e(),_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.qrMode && _vm.finishScan)?_c('QRImage',{attrs:{\"registered\":_vm.registered}}):_vm._e()],1),(!_vm.isReferenceDevice)?_c('div',{staticClass:\"debug-video\"},[(_vm.appState.currentFrame)?_c('VideoStream',{attrs:{\"frame\":_vm.appState.currentFrame.frame,\"face\":_vm.appState.face,\"min\":_vm.appState.currentFrame.analysisResult.heatStats.min,\"max\":_vm.appState.currentFrame.analysisResult.heatStats.max,\"crop-box\":{ Left: 0, Right: 0, Top: 0, Bottom: 0 },\"crop-enabled\":false,\"draw-overlays\":false,\"show-coords\":false}}):_vm._e()],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"user-state\",class:[\n    _vm.classNameForState,\n    _vm.screeningResultClass,\n    { 'mini-view': !_vm.onReferenceDevice } ],style:({ background: _vm.warmupBackgroundColour }),attrs:{\"id\":\"user-facing-screening\"},on:{\"click\":function($event){_vm.interacted = true}}},[_c('canvas',{ref:\"beziers\",attrs:{\"hidden\":!_vm.showCanvas || _vm.isWarmingUp,\"id\":\"beziers\",\"width\":\"710\",\"height\":\"1080\"}}),_c('div',{staticClass:\"center\",class:{ 'warming-up': _vm.isWarmingUp }},[(_vm.hasScreeningResult)?_c('div',{class:['result', { 'should-leave-frame': _vm.shouldLeaveFrame }]},[_vm._v(\" \"+_vm._s(_vm.temperature)+\" \"),_c('br'),(_vm.shouldLeaveFrame)?_c('span',[_vm._v(_vm._s(_vm.screeningAdvice))]):_vm._e(),_c('br')]):_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.messageText)}})]),(_vm.onReferenceDevice || _vm.isLocal)?_c('v-card',{staticClass:\"settings-toggle-button\",class:{ interacted: _vm.interacted },attrs:{\"dark\":\"\",\"flat\":\"\",\"height\":\"44\",\"tile\":\"\",\"color\":\"transparent\"}},[_c('v-card-actions',[_c('v-btn',{attrs:{\"absolute\":\"\",\"dark\":\"\",\"fab\":\"\",\"bottom\":\"\",\"right\":\"\",\"elevation\":\"0\",\"color\":\"transparent\"},on:{\"click\":function (e) {\n            if (_vm.interacted) {\n              _vm.showSettings = true;\n              _vm.hasSettings = true;\n            }\n          }}},[_c('v-icon',{attrs:{\"color\":\"rgba(255, 255, 255, 0.5)\",\"large\":\"\"}},[_vm._v(_vm._s(_vm.cogIcon))])],1)],1)],1):_vm._e(),_c('v-dialog',{attrs:{\"hide-overlay\":\"\",\"attach\":\"#user-facing-screening\",\"fullscreen\":\"\",\"transition\":\"dialog-bottom-transition\"},model:{value:(_vm.showSettings),callback:function ($$v) {_vm.showSettings=$$v},expression:\"showSettings\"}},[(_vm.hasSettings)?_c('AdminSettings',{on:{\"closed\":_vm.closedAdminSettings}}):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { CameraConnectionState, Frame } from \"./camera\";\nimport { DegreesCelsius } from \"@/utils\";\nimport { Point } from \"@/geom\";\nimport { AnalysisResult as ProcessResult } from \"../processing/tko_processing\";\n\nexport const DEFAULT_THRESHOLD_MIN_FEVER = 37.5;\nexport const FactoryDefaultCalibration: CalibrationInfo = {\n  ThermalRefTemp: 37.87441329956055,\n  SnapshotTime: 0,\n  TemperatureCelsius: 37.5,\n  SnapshotValue: 30197.9765625,\n  ThresholdMinFever: DEFAULT_THRESHOLD_MIN_FEVER,\n  HeadBLX: 0,\n  HeadBLY: 0,\n  HeadBRX: 0,\n  HeadBRY: 0,\n  HeadTLX: 0,\n  HeadTLY: 0,\n  HeadTRX: 0,\n  HeadTRY: 0,\n  CalibrationBinaryVersion: \"abcde\", // Fill these out.\n  UuidOfUpdater: 432423432432, // Fill these out.\n  UseNormalSound: true,\n  UseWarningSound: true,\n  UseErrorSound: true\n};\n\nexport interface CalibrationInfo {\n  ThermalRefTemp: number;\n  SnapshotTime: number;\n  TemperatureCelsius: number;\n  SnapshotValue: number;\n  ThresholdMinFever: number;\n  HeadTLX: number;\n  HeadTLY: number;\n  HeadBLX: number;\n  HeadBLY: number;\n  HeadTRX: number;\n  HeadTRY: number;\n  HeadBRX: number;\n  HeadBRY: number;\n  CalibrationBinaryVersion: string;\n  UuidOfUpdater: number;\n  UseNormalSound: boolean;\n  UseWarningSound: boolean;\n  UseErrorSound: boolean;\n}\n\nexport type BoxOffset = \"left\" | \"right\" | \"top\" | \"bottom\";\nexport interface CropBox {\n  left: number;\n  right: number;\n  top: number;\n  bottom: number;\n}\nexport interface BoundingBox {\n  x0: number;\n  x1: number;\n  y0: number;\n  y1: number;\n}\n\nexport enum ScreeningState {\n  INIT = \"INIT\",\n  WARMING_UP = \"WARMING_UP\",\n  READY = \"READY\", // no face\n  HEAD_LOCK = \"HEAD_LOCK\",\n  TOO_FAR = \"TOO_FAR\",\n  LARGE_BODY = \"LARGE_BODY\",\n  MULTIPLE_HEADS = \"MULTIPLE_HEADS\",\n  FACE_LOCK = \"FACE_LOCK\", // has face\n  FRONTAL_LOCK = \"FRONTAL_LOCK\", // Face is front-on\n  STABLE_LOCK = \"STABLE_LOCK\", // Face has not changed in size or position for a couple of frames.\n  MEASURED = \"MEASURED\", // has face, but not front-on\n  MISSING_THERMAL_REF = \"MISSING_REF\",\n  BLURRED = \"BLURRED\",\n  AFTER_FFC_EVENT = \"AFTER_FFC_EVENT\"\n}\n\nexport interface CalibrationConfig {\n  timestamp: Date;\n  thermalReferenceRawValue: number;\n  hotspotRawTemperatureValue: number;\n  calibrationTemperature: DegreesCelsius;\n  thermalRefTemperature: DegreesCelsius;\n  thresholdMinFever: number;\n  playNormalSound: boolean;\n  playErrorSound: boolean;\n  playWarningSound: boolean;\n  head: { tL: Point; tR: Point; bL: Point; bR: Point };\n}\n\nexport interface Circle {\n  center: Point;\n  radius: number;\n}\n\nexport interface ThermalReference {\n  geom: Circle;\n  val: number;\n  temp: number;\n}\n\nexport interface ScreeningEvent {\n  timestamp: Date;\n  rawTemperatureValue: number;\n  calculatedValue: number;\n  sampleX: number;\n  sampleY: number;\n  frame: Frame;\n  thermalReference: ThermalReference;\n  face: FaceInfo;\n}\n\nexport interface FaceInfo {\n  halfwayRatio: number;\n  headLock: number;\n  isValid: boolean;\n  samplePoint: Point;\n  sampleValue: number;\n  sampleTemp: number;\n  head: {\n    topLeft: Point;\n    topRight: Point;\n    bottomLeft: Point;\n    bottomRight: Point;\n  };\n}\n\nexport interface AnalysisResult {\n  motionSum: number;\n  motionThresholdSum: number;\n  thresholdSum: number;\n  frameBottomSum: number;\n  heatStats: {\n    min: number;\n    max: number;\n    threshold: number;\n  };\n  face: FaceInfo;\n  nextState: ScreeningState;\n  hasBody: boolean;\n  thermalRef: ThermalReference;\n}\n\nexport const InitialFrameInfo = {\n  Camera: {\n    ResX: 160,\n    ResY: 120,\n    FPS: 9,\n    Brand: \"flir\",\n    Model: \"lepton3.5\",\n    Firmware: \"3.3.26\",\n    CameraSerial: 12345\n  },\n  Telemetry: {\n    FrameCount: 1,\n    TimeOn: 1,\n    FFCState: \"On\",\n    FrameMean: 0,\n    TempC: 0,\n    LastFFCTempC: 0,\n    LastFFCTime: 0\n  },\n  AppVersion: \"\",\n  BinaryVersion: \"\",\n  Calibration: FactoryDefaultCalibration\n};\n\nexport interface AppState {\n  currentFrame: Frame | null;\n  cameraConnectionState: CameraConnectionState;\n  face: FaceInfo | null;\n  currentCalibration: CalibrationConfig;\n  currentScreeningEvent: ScreeningEvent | null;\n  currentScreeningState: ScreeningState;\n  currentScreeningStateFrameCount: number;\n  paused: boolean;\n  lastFrameTime: number;\n  uuid: number;\n  analysisResult: AnalysisResult;\n}\n\nfunction getScreeningState(state: number): ScreeningState {\n  let screeningState = ScreeningState.INIT;\n  switch (state) {\n    case 0:\n      screeningState = ScreeningState.WARMING_UP;\n      break;\n    case 1:\n      screeningState = ScreeningState.READY;\n      break;\n    case 2:\n      screeningState = ScreeningState.HEAD_LOCK;\n      break;\n    case 3:\n      screeningState = ScreeningState.TOO_FAR;\n      break;\n    case 4:\n      screeningState = ScreeningState.LARGE_BODY;\n      break;\n    case 5:\n      screeningState = ScreeningState.FACE_LOCK;\n      break;\n    case 6:\n      screeningState = ScreeningState.FRONTAL_LOCK;\n      break;\n    case 7:\n      screeningState = ScreeningState.STABLE_LOCK;\n      break;\n    case 8:\n      screeningState = ScreeningState.MEASURED;\n      break;\n    case 9:\n      screeningState = ScreeningState.MISSING_THERMAL_REF;\n      break;\n    case 10:\n      screeningState = ScreeningState.BLURRED;\n      break;\n    case 11:\n      screeningState = ScreeningState.AFTER_FFC_EVENT;\n      break;\n  }\n  return screeningState;\n}\n\nexport function extractResult(analysisResult: ProcessResult) {\n  const f = analysisResult.face;\n  const h = f.head;\n  const tL = h.topLeft;\n  const tR = h.topRight;\n  const bL = h.bottomLeft;\n  const bR = h.bottomRight;\n  const sP = f.samplePoint;\n  const hS = analysisResult.heatStats;\n  const ref = analysisResult.thermalReference;\n  const geom = analysisResult.thermalReference.geom;\n  const cP = geom.center;\n\n  const copiedAnalysisResult: AnalysisResult = {\n    face: {\n      headLock: f.headLock,\n      head: {\n        topLeft: {\n          x: tL.x,\n          y: tL.y\n        },\n        topRight: {\n          x: tR.x,\n          y: tR.y\n        },\n        bottomLeft: {\n          x: bL.x,\n          y: bL.y\n        },\n        bottomRight: {\n          x: bR.x,\n          y: bR.y\n        }\n      },\n      samplePoint: {\n        x: sP.x,\n        y: sP.y\n      },\n      sampleTemp: f.sampleTemp,\n      sampleValue: f.sampleValue,\n      halfwayRatio: f.halfwayRatio,\n      isValid: f.isValid\n    },\n    frameBottomSum: analysisResult.frameBottomSum,\n    motionSum: analysisResult.motionSum,\n    heatStats: {\n      threshold: hS.threshold,\n      min: hS.min,\n      max: hS.max\n    },\n    motionThresholdSum: analysisResult.motionThresholdSum,\n    thresholdSum: analysisResult.thresholdSum,\n    nextState: getScreeningState(analysisResult.nextState),\n    hasBody: analysisResult.hasBody,\n    thermalRef: {\n      geom: {\n        center: {\n          x: cP.x,\n          y: cP.y\n        },\n        radius: geom.radius\n      },\n      val: ref.val,\n      temp: ref.temp\n    }\n  };\n\n  f.free();\n  h.free();\n  tL.free();\n  tR.free();\n  bL.free();\n  bR.free();\n  sP.free();\n  hS.free();\n  cP.free();\n  geom.free();\n  ref.free();\n  analysisResult.free();\n  return copiedAnalysisResult;\n}\n","export const BlobReader = (function(): {\n  arrayBuffer: (blob: Blob) => Promise<ArrayBuffer>;\n} {\n  // For comparability with older browsers/iOS that don't yet support arrayBuffer()\n  // directly off the blob object\n  const arrayBuffer: (blob: Blob) => Promise<ArrayBuffer> =\n    \"arrayBuffer\" in Blob.prototype &&\n    typeof (Blob.prototype as Blob)[\"arrayBuffer\"] === \"function\"\n      ? (blob: Blob) => blob[\"arrayBuffer\"]()\n      : (blob: Blob) =>\n          new Promise((resolve, reject) => {\n            const fileReader = new FileReader();\n            fileReader.addEventListener(\"load\", () => {\n              resolve(fileReader.result as ArrayBuffer);\n            });\n            fileReader.addEventListener(\"error\", () => {\n              reject();\n            });\n            fileReader.readAsArrayBuffer(blob);\n          });\n\n  return {\n    arrayBuffer\n  };\n})();\n\nexport class DegreesCelsius {\n  public val: number;\n  constructor(val: number) {\n    this.val = val;\n  }\n  public toString(): string {\n    if (this.val === undefined) {\n      debugger;\n    }\n    return `${this.val.toFixed(1)}°`;\n  }\n}\n\nexport const temperatureForSensorValue = (\n  savedThermalRefValue: number,\n  rawValue: number,\n  currentThermalRefValue: number\n): DegreesCelsius => {\n  return new DegreesCelsius(\n    savedThermalRefValue + (rawValue - currentThermalRefValue) * 0.01\n  );\n};\n\nexport function saveCurrentVersion(binaryVersion: string, appVersion: string) {\n  window.localStorage.setItem(\n    \"softwareVersion\",\n    JSON.stringify({\n      appVersion,\n      binaryVersion\n    })\n  );\n}\n\nexport function checkForSoftwareUpdates(\n  binaryVersion: string,\n  appVersion: string,\n  shouldReloadIfChanged = true\n): boolean {\n  const prevVersionJSON = window.localStorage.getItem(\"softwareVersion\");\n  if (prevVersionJSON) {\n    try {\n      const prevVersion = JSON.parse(prevVersionJSON);\n      if (\n        binaryVersion &&\n        appVersion &&\n        (prevVersion.binaryVersion != binaryVersion ||\n          prevVersion.appVersion != appVersion)\n      ) {\n        if (shouldReloadIfChanged) {\n          console.log(\n            \"reload because version changed\",\n            JSON.stringify(prevVersion),\n            binaryVersion,\n            appVersion\n          );\n          window.location.reload();\n        } else {\n          saveCurrentVersion(binaryVersion, appVersion);\n          // Display info that the software has updated since last started up.\n          return true;\n        }\n      }\n    } catch (e) {\n      saveCurrentVersion(binaryVersion, appVersion);\n      return false;\n    }\n  } else {\n    saveCurrentVersion(binaryVersion, appVersion);\n  }\n  return false;\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',[_c('v-toolbar',{attrs:{\"color\":\"light-blue\",\"dark\":\"\"},scopedSlots:_vm._u([{key:\"extension\",fn:function(){return [_c('v-tabs',{attrs:{\"centered\":\"\"},model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},_vm._l((_vm.tabItems),function(item){return _c('v-tab',{key:item.tab},[_vm._v(_vm._s(item.tab))])}),1)]},proxy:true}])},[_c('v-toolbar-title',[_vm._v(\"Settings\")]),_c('v-spacer'),_c('v-btn',{attrs:{\"text\":\"\"},on:{\"click\":_vm.close}},[_vm._v(\" close \")])],1),_c('v-tabs-items',{attrs:{\"touchless\":\"\"},model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},_vm._l((_vm.tabItems),function(item){return _c('v-tab-item',{key:item.tab},[_c(item.content,{tag:\"component\"})],1)}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{attrs:{\"height\":\"calc(100vh - 112px)\"}},[_c('v-container',{staticClass:\"cont\"},[_c('v-card',{staticClass:\"split\",attrs:{\"flat\":\"\"}},[_c('v-card',[(_vm.state.currentFrame)?_c('VideoStream',{attrs:{\"frame\":_vm.state.currentFrame.frame,\"face\":_vm.state.face,\"crop-box\":_vm.editedCropBox,\"thermal-ref\":_vm.state.currentFrame.analysisResult.thermalRef.geom,\"min\":_vm.state.currentFrame.analysisResult.heatStats.min,\"max\":_vm.state.currentFrame.analysisResult.heatStats.max,\"crop-enabled\":false}}):_vm._e()],1),_c('v-card',{staticClass:\"settings\",attrs:{\"width\":\"700\"}},[_c('v-card-title',[_vm._v(\" Calibration: \"+_vm._s(_vm.pendingCalibration)+\" \"),_c('v-btn',{attrs:{\"text\":\"\",\"disabled\":!_vm.canCalibrate},on:{\"click\":function($event){$event.stopPropagation();return (function () { return _vm.editCalibration(); })($event)}}},[_c('v-icon',{attrs:{\"color\":\"#999\",\"small\":\"\"}},[_vm._v(_vm._s(_vm.pencilIcon))]),_vm._v(\" Edit \")],1)],1),_c('v-dialog',{attrs:{\"max-width\":\"400\"},model:{value:(_vm.showCalibrationDialog),callback:function ($$v) {_vm.showCalibrationDialog=$$v},expression:\"showCalibrationDialog\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\"Edit calibration\")]),_c('v-container',[(_vm.snapshotScreeningEvent)?_c('VideoStream',{attrs:{\"frame\":_vm.snapshotScreeningEvent.frame.frame,\"face\":_vm.snapshotScreeningEvent.face,\"min\":_vm.state.currentFrame.analysisResult.heatStats.min,\"max\":_vm.state.currentFrame.analysisResult.heatStats.max,\"crop-box\":_vm.state.currentCalibration.cropBox,\"crop-enabled\":false,\"draw-overlays\":true,\"scale\":0.6}}):_vm._e()],1),_c('v-card-subtitle',[_vm._v(\" Take your temperature and enter it here to calibrate the system against the current screening event. \")]),_c('v-card-text',[_c('v-text-field',{attrs:{\"label\":\"calibrated temperature\",\"value\":_vm.editedCalibration},on:{\"blur\":_vm.updateCalibration}}),_c('v-card-actions',[_c('v-btn',{on:{\"click\":function () { return _vm.incrementCalibration(0.1); }}},[_c('v-icon',{attrs:{\"light\":\"\"}},[_vm._v(_vm._s(_vm.plusIcon))])],1),_c('v-spacer'),_c('v-btn',{on:{\"click\":function () { return _vm.incrementCalibration(-0.1); }}},[_c('v-icon',{attrs:{\"light\":\"\"}},[_vm._v(_vm._s(_vm.minusIcon))])],1)],1)],1),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"text\":\"\",\"color\":\"grey darken-1\"},on:{\"click\":function($event){_vm.showCalibrationDialog = false}}},[_vm._v(\" Cancel \")]),_c('v-btn',{attrs:{\"text\":\"\",\"color\":\"green darken-1\"},on:{\"click\":function (e) { return _vm.acceptCalibration(); }}},[_vm._v(\" Accept \")])],1)],1)],1),_c('v-card-text',[_c('v-checkbox',{attrs:{\"label\":\"Use custom alert threshold\"},on:{\"change\":_vm.toggleCustomTemperatureThresholds},model:{value:(_vm.useCustomTemperatureRange),callback:function ($$v) {_vm.useCustomTemperatureRange=$$v},expression:\"useCustomTemperatureRange\"}}),_c('v-card-text',[_c('v-slider',{attrs:{\"disabled\":!_vm.useCustomTemperatureRange,\"min\":\"30\",\"max\":\"40\",\"step\":\"0.1\",\"thumb-label\":\"\",\"ticks\":true,\"color\":'green',\"track-color\":'rgba(255, 0, 0, 0.25)'},on:{\"change\":function (e) { return _vm.persistSettings(); }},model:{value:(_vm.editedTemperatureThreshold),callback:function ($$v) {_vm.editedTemperatureThreshold=$$v},expression:\"editedTemperatureThreshold\"}}),_c('span',{staticClass:\"selected-temp-range\",domProps:{\"innerHTML\":_vm._s(_vm.selectedTemperatureRange)}})],1)],1),_c('v-card-title',[_vm._v(\"Sounds:\")]),_c('v-container',{attrs:{\"fluid\":\"\",\"width\":\"100%\"}},[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"4\"}},[_c('v-switch',{attrs:{\"label\":\"Play normal sound\"},on:{\"change\":function (e) { return _vm.persistSettings(); }},model:{value:(_vm.playNormalSound),callback:function ($$v) {_vm.playNormalSound=$$v},expression:\"playNormalSound\"}})],1),_c('v-col',{attrs:{\"cols\":\"4\"}},[_c('v-switch',{attrs:{\"label\":\"Play warning sound\"},on:{\"change\":function (e) { return _vm.persistSettings(); }},model:{value:(_vm.playWarningSound),callback:function ($$v) {_vm.playWarningSound=$$v},expression:\"playWarningSound\"}})],1),_c('v-col',{attrs:{\"cols\":\"4\"}},[_c('v-switch',{attrs:{\"label\":\"Play error sound\"},on:{\"change\":function (e) { return _vm.persistSettings(); }},model:{value:(_vm.playErrorSound),callback:function ($$v) {_vm.playErrorSound=$$v},expression:\"playErrorSound\"}})],1)],1)],1)],1)],1),_c('v-overlay',{attrs:{\"value\":_vm.saving,\"light\":\"\"}},[_vm._v(\" Saving settings \")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"container\",class:{ recording: _vm.recording },attrs:{\"id\":\"video-stream-container\"}},[_c('canvas',{ref:\"cameraStream\",attrs:{\"id\":\"camera-stream\",\"width\":\"160\",\"height\":\"120\"}}),_c('canvas',{ref:\"vizOverlay\",attrs:{\"id\":\"debug-overlay\",\"width\":\"480\",\"height\":\"640\"}}),(_vm.canEditCropping && _vm.cropEnabled)?_c('video-crop-controls',{attrs:{\"crop-box\":_vm.cropBox},on:{\"crop-changed\":_vm.gotCropChange}}):_vm._e(),(_vm.cropEnabled)?_c('v-btn',{class:{ on: _vm.canEditCropping },attrs:{\"text\":\"\",\"title\":\"Edit cropping\",\"id\":\"toggle-cropping\",\"dark\":\"\"},on:{\"click\":_vm.toggleCropping}},[_c('v-icon',[_vm._v(_vm._s(_vm.cropIcon))])],1):_vm._e(),(_vm.showCoords)?_c('p',{staticClass:\"coords\"},[_vm._v(\"(\"+_vm._s(_vm.coords.x)+\", \"+_vm._s(_vm.coords.y)+\")\")]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"box\",attrs:{\"id\":\"fov-box\"}},[_c('div',[_c('div',{ref:\"top\",staticClass:\"fov-handle\",attrs:{\"id\":\"top-handle\"},on:{\"mousedown\":function (e) { return _vm.startDrag(e); },\"mouseup\":function (e) { return _vm.endDrag(e); },\"touchstart\":function (e) { return _vm.startDrag(e); },\"touchend\":function (e) { return _vm.endDrag(e); }}},[_c('svg',{attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 256 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M214.059 377.941H168V134.059h46.059c21.382 0 32.09-25.851 16.971-40.971L144.971 7.029c-9.373-9.373-24.568-9.373-33.941 0L24.971 93.088c-15.119 15.119-4.411 40.971 16.971 40.971H88v243.882H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.568 9.373 33.941 0l86.059-86.059c15.12-15.119 4.412-40.971-16.97-40.971z\"}})])]),_c('div',{ref:\"left\",staticClass:\"fov-handle\",attrs:{\"id\":\"left-handle\"},on:{\"mousedown\":function (e) { return _vm.startDrag(e); },\"mouseup\":function (e) { return _vm.endDrag(e); },\"touchstart\":function (e) { return _vm.startDrag(e); },\"touchend\":function (e) { return _vm.endDrag(e); }}},[_c('svg',{attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 512 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M377.941 169.941V216H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.568 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296h243.882v46.059c0 21.382 25.851 32.09 40.971 16.971l86.059-86.059c9.373-9.373 9.373-24.568 0-33.941l-86.059-86.059c-15.119-15.12-40.971-4.412-40.971 16.97z\"}})])]),_c('div',{ref:\"right\",staticClass:\"fov-handle\",attrs:{\"id\":\"right-handle\"},on:{\"mousedown\":function (e) { return _vm.startDrag(e); },\"mouseup\":function (e) { return _vm.endDrag(e); },\"touchstart\":function (e) { return _vm.startDrag(e); },\"touchend\":function (e) { return _vm.endDrag(e); }}},[_c('svg',{attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 512 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M377.941 169.941V216H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.568 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296h243.882v46.059c0 21.382 25.851 32.09 40.971 16.971l86.059-86.059c9.373-9.373 9.373-24.568 0-33.941l-86.059-86.059c-15.119-15.12-40.971-4.412-40.971 16.97z\"}})])]),_c('div',{ref:\"bottom\",staticClass:\"fov-handle\",attrs:{\"id\":\"bottom-handle\"},on:{\"mousedown\":function (e) { return _vm.startDrag(e); },\"mouseup\":function (e) { return _vm.endDrag(e); },\"touchstart\":function (e) { return _vm.startDrag(e); },\"touchend\":function (e) { return _vm.endDrag(e); }}},[_c('svg',{attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 256 512\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M214.059 377.941H168V134.059h46.059c21.382 0 32.09-25.851 16.971-40.971L144.971 7.029c-9.373-9.373-24.568-9.373-33.941 0L24.971 93.088c-15.119 15.119-4.411 40.971 16.971 40.971H88v243.882H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.568 9.373 33.941 0l86.059-86.059c15.12-15.119 4.412-40.971-16.97-40.971z\"}})])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\nimport { BoundingBox, BoxOffset, CropBox } from \"@/types\";\n\n@Component\nexport default class VideoCropControls extends Vue {\n  @Prop({ required: true }) cropBox!: CropBox;\n\n  private currentTarget: HTMLDivElement | null = null;\n  private boundDragHandle: ((e: MouseEvent | TouchEvent) => void) | null = null;\n  private boundEndDrag: ((e: Event) => void) | null = null;\n\n  $refs!: {\n    top: HTMLDivElement;\n    right: HTMLDivElement;\n    bottom: HTMLDivElement;\n    left: HTMLDivElement;\n    box: HTMLDivElement;\n  };\n\n  created() {\n    this.boundEndDrag = this.endDrag.bind(this);\n    window.addEventListener(\"mouseup\", this.boundEndDrag);\n    window.addEventListener(\"touchend\", this.boundEndDrag);\n  }\n\n  mounted() {\n    const { top, left, right, bottom } = this.cropBox;\n    // Set the initial handle positions:\n    this.$refs.top.style.top = `${top}%`;\n    this.$refs.right.style.right = `${right}%`;\n    this.$refs.bottom.style.bottom = `${bottom}%`;\n    this.$refs.left.style.left = `${left}%`;\n    let offset = top + (100 - (bottom + top)) * 0.5;\n    this.$refs.left.style.top = `${offset}%`;\n    this.$refs.right.style.top = `${offset}%`;\n    offset = left + (100 - (left + right)) * 0.5;\n    this.$refs.top.style.left = `${offset}%`;\n    this.$refs.bottom.style.left = `${offset}%`;\n  }\n\n  beforeDestroy() {\n    if (this.boundEndDrag) {\n      window.removeEventListener(\"mouseup\", this.boundEndDrag);\n      window.removeEventListener(\"touchend\", this.boundEndDrag);\n    }\n  }\n\n  startDrag(event: Event) {\n    if (this.boundDragHandle === null) {\n      this.boundDragHandle = this.dragHandle.bind(this);\n    }\n    const eventName = event.type === \"mousedown\" ? \"mousemove\" : \"touchmove\";\n    this.currentTarget = event.target as HTMLDivElement;\n    if (this.boundDragHandle) {\n      window.addEventListener(eventName, this.boundDragHandle);\n    }\n  }\n\n  endDrag(event: Event) {\n    const eventName = event.type === \"mouseup\" ? \"mousemove\" : \"touchmove\";\n    this.currentTarget = null;\n    if (this.boundDragHandle) {\n      window.removeEventListener(eventName, this.boundDragHandle);\n    }\n  }\n\n  dragHandle(event: MouseEvent | TouchEvent) {\n    const cropBox = this.cropBox;\n    const cropTopHandle = this.$refs.top;\n    const cropRightHandle = this.$refs.right;\n    const cropBottomHandle = this.$refs.bottom;\n    const cropLeftHandle = this.$refs.left;\n    let position: { clientX: number; clientY: number };\n    if (!(event instanceof MouseEvent)) {\n      position = (event as TouchEvent).touches[0];\n    } else {\n      position = event;\n    }\n    const { clientX: x, clientY: y } = position;\n    const minDimensions = 20;\n    let maxInsetPercentage = 35;\n    const bounds = this.$refs.box.getBoundingClientRect();\n    let offset;\n    if (this.currentTarget) {\n      const l: BoxOffset = \"left\";\n      const r: BoxOffset = \"right\";\n      switch (this.currentTarget.id) {\n        case \"top-handle\":\n          maxInsetPercentage = 100 - (cropBox.bottom + minDimensions);\n          cropBox.top = Math.min(\n            maxInsetPercentage,\n            Math.max(0, 100 * ((y - bounds.top) / bounds.height))\n          );\n          cropTopHandle.style.top = `${cropBox.top}%`;\n          offset = cropBox.top + (100 - (cropBox.bottom + cropBox.top)) * 0.5;\n          cropLeftHandle.style.top = `${offset}%`;\n          cropRightHandle.style.top = `${offset}%`;\n          break;\n        case \"right-handle\":\n          maxInsetPercentage = 100 - (cropBox[l] + minDimensions);\n          cropBox[r] = Math.min(\n            maxInsetPercentage,\n            Math.max(0, 100 * ((bounds.right - x) / bounds.width))\n          );\n          cropRightHandle.style.right = `${cropBox[r]}%`;\n          offset = cropBox[l] + (100 - (cropBox[l] + cropBox[r])) * 0.5;\n          cropTopHandle.style.left = `${offset}%`;\n          cropBottomHandle.style.left = `${offset}%`;\n          break;\n        case \"bottom-handle\":\n          maxInsetPercentage = 100 - (cropBox.top + minDimensions);\n          cropBox.bottom = Math.min(\n            maxInsetPercentage,\n            Math.max(0, 100 * ((bounds.bottom - y) / bounds.height))\n          );\n          cropBottomHandle.style.bottom = `${cropBox.bottom}%`;\n          offset = cropBox.top + (100 - (cropBox.bottom + cropBox.top)) * 0.5;\n          cropLeftHandle.style.top = `${offset}%`;\n          cropRightHandle.style.top = `${offset}%`;\n          break;\n        case \"left-handle\":\n          maxInsetPercentage = 100 - (cropBox[r] + minDimensions);\n          cropBox[l] = Math.min(\n            maxInsetPercentage,\n            Math.max(0, 100 * ((x - bounds.left) / bounds.width))\n          );\n          cropLeftHandle.style.left = `${cropBox[l]}%`;\n          offset = cropBox[l] + (100 - (cropBox[l] + cropBox[r])) * 0.5;\n          cropTopHandle.style.left = `${offset}%`;\n          cropBottomHandle.style.left = `${offset}%`;\n          break;\n      }\n      // Update saved fovBox:\n      this.$emit(\"crop-changed\", cropBox);\n      this.$parent.$emit(\"crop-changed\", cropBox);\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VideoCropControls.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VideoCropControls.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./VideoCropControls.vue?vue&type=template&id=60b9dd6c&scoped=true&\"\nimport script from \"./VideoCropControls.vue?vue&type=script&lang=ts&\"\nexport * from \"./VideoCropControls.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./VideoCropControls.vue?vue&type=style&index=0&id=60b9dd6c&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"60b9dd6c\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Emit, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport VideoCropControls from \"@/components/VideoCropControls.vue\";\nimport { BoundingBox, CropBox, FaceInfo } from \"@/types\";\nimport { mdiCrop } from \"@mdi/js\";\nimport { Circle } from \"@/geom\";\n\n@Component({ components: { VideoCropControls } })\nexport default class VideoStream extends Vue {\n  @Prop() public frame!: Uint16Array;\n  @Prop({ required: true }) public min!: number;\n  @Prop({ required: true }) public max!: number;\n  @Prop({ required: true }) public face!: FaceInfo | null;\n  @Prop({ required: true }) public cropBox!: CropBox;\n  @Prop({ required: true }) public cropEnabled!: boolean;\n  @Prop({ default: 1.0 }) public scale!: number;\n  @Prop({ required: false }) public thermalRef!: Circle | null;\n  @Prop({ default: false }) public drawOverlays!: boolean;\n  @Prop({ default: false }) public recording!: boolean;\n  @Prop({ default: false }) public showCoords!: boolean;\n  private canEditCropping = false;\n\n  $refs!: {\n    cameraStream: HTMLCanvasElement;\n    vizOverlay: HTMLCanvasElement;\n    container: HTMLDivElement;\n  };\n\n  get cropIcon() {\n    return mdiCrop;\n  }\n\n  private coords: { x: number; y: number } = { x: 0, y: 0 };\n\n  mounted() {\n    const container = this.$refs.container;\n    container.style.width = `${375 * this.scale}px`;\n    container.style.height = `${500 * this.scale}px`;\n\n    if (this.showCoords) {\n      container.addEventListener(\"mousemove\", this.onMouseMove);\n    }\n\n    if (this.frame) {\n      this.onFrameUpdate(this.frame);\n      this.updateOverlayCanvas();\n    }\n  }\n\n  onMouseMove(e: MouseEvent) {\n    const rect = (e.target as HTMLElement).getBoundingClientRect();\n    const x = Math.floor(\n      Math.min(((e.clientX - rect.x) / rect.width) * 120, 119)\n    );\n    const y = Math.floor(\n      Math.min(((e.clientY - rect.y) / rect.height) * 160, 159)\n    );\n    this.coords = { x, y };\n  }\n\n  beforeDestroy() {\n    if (this.showCoords) {\n      this.$refs.container.removeEventListener(\"mousemove\", this.onMouseMove);\n    }\n  }\n\n  updateOverlayCanvas() {\n    const underlay = this.$refs.cameraStream;\n    const canvas = this.$refs.vizOverlay;\n    const canvasWidth = canvas.width * window.devicePixelRatio;\n    const canvasHeight = canvas.height * window.devicePixelRatio;\n    const context = canvas.getContext(\"2d\") as CanvasRenderingContext2D;\n    context.clearRect(0, 0, canvasWidth, canvasHeight);\n    if (this.thermalRef) {\n      context.save();\n      const scaleX = canvasWidth / (underlay.height * window.devicePixelRatio);\n      const scaleY = canvasHeight / (underlay.width * window.devicePixelRatio);\n      context.scale(scaleX, scaleY);\n      context.fillStyle = \"rgba(255, 0, 0, 0.4)\";\n      context.beginPath();\n      context.arc(\n        this.thermalRef.center.x,\n        this.thermalRef.center.y,\n        this.thermalRef.radius,\n        0,\n        Math.PI * 2\n      );\n      context.fill();\n      context.restore();\n    }\n    if (this.drawOverlays) {\n      context.save();\n      const scaleX = canvasWidth / (underlay.height * window.devicePixelRatio);\n      const scaleY = canvasHeight / (underlay.width * window.devicePixelRatio);\n      context.scale(scaleX, scaleY);\n      const face = this.face;\n      if (face) {\n        // Now find the hotspot - only if we have a good lock!\n        context.lineWidth = 0.25;\n        if (face.isValid) {\n          let valid: boolean = face.isValid;\n          if (face.headLock >= 1.0) {\n            context.strokeStyle = \"red\";\n            context.lineWidth = 0.5;\n          } else if (face.headLock === 0.5) {\n            context.strokeStyle = \"blue\";\n          } else {\n            context.strokeStyle = \"orange\";\n            valid = false;\n          }\n          if (valid) {\n            const point = face.samplePoint;\n\n            context.beginPath();\n            context.strokeStyle = \"rgba(255, 0, 0, 0.7)\";\n            context.lineWidth = 1;\n            context.arc(point.x - 0.5, point.y - 0.5, 2, 0, Math.PI * 2);\n            context.stroke();\n\n            context.beginPath();\n            context.moveTo(face.head.bottomLeft.x, face.head.bottomLeft.y);\n            context.lineTo(face.head.topLeft.x, face.head.topLeft.y);\n            context.lineTo(face.head.topRight.x, face.head.topRight.y);\n            context.lineTo(face.head.bottomRight.x, face.head.bottomRight.y);\n            context.lineTo(face.head.bottomLeft.x, face.head.bottomLeft.y);\n            context.stroke();\n          }\n        }\n      }\n      context.restore();\n    }\n\n    /*\n    context.save();\n    if (this.cropBox) {\n\n      // Update crop-box overlay:\n      const cropBox = this.cropBoxPixelBounds;\n      const overlay = new Path2D();\n      context.scale(1, 1);\n      const width = canvas.width;\n      const height = canvas.height;\n      overlay.rect(0, 0, width, height);\n      const ratio = width / underlay.height;\n      overlay.rect(\n          cropBox.x0 * ratio,\n          cropBox.y0 * ratio,\n          (cropBox.x1 - cropBox.x0) * ratio,\n          (cropBox.y1 - cropBox.y0) * ratio\n      );\n      context.fillStyle = \"rgba(0, 0, 0, 0.5)\";\n      context.fill(overlay, \"evenodd\");\n    }\n    context.restore();\n    */\n  }\n\n  get cropBoxPixelBounds(): BoundingBox {\n    const cropBox = this.cropBox;\n    const width = 120;\n    const height = 160;\n    const onePercentWidth = width / 100;\n    const onePercentHeight = height / 100;\n    const bounds = {\n      x0: Math.floor(onePercentWidth * cropBox.left),\n      x1: width - Math.floor(onePercentWidth * cropBox.right),\n      y0: Math.floor(onePercentHeight * cropBox.top),\n      y1: height - Math.floor(onePercentHeight * cropBox.bottom)\n    };\n    return bounds;\n  }\n\n  toggleCropping() {\n    this.canEditCropping = !this.canEditCropping;\n    if (!this.canEditCropping) {\n      this.saveCropChanges();\n    }\n  }\n\n  saveCropChanges() {\n    this.$parent.$emit(\"save-crop-changes\");\n  }\n\n  @Watch(\"frame\")\n  onFrameUpdate(next: Uint16Array) {\n    const canvas = this.$refs.cameraStream;\n    const context = canvas.getContext(\"2d\") as CanvasRenderingContext2D;\n    const imgData = context.getImageData(0, 0, canvas.width, canvas.height);\n    const frameData = next;\n    const max = this.max;\n    const min = this.min;\n    if (min !== Number.MAX_SAFE_INTEGER) {\n      const data = new Uint32Array(imgData.data.buffer);\n      const range = max - min;\n      for (let i = 0; i < data.length; i++) {\n        const v = Math.max(\n          0,\n          Math.min(255, ((frameData[i] - min) / range) * 255.0)\n        );\n        data[i] = (255 << 24) | (v << 16) | (v << 8) | v;\n      }\n      context.putImageData(imgData, 0, 0);\n    }\n  }\n\n  @Watch(\"face\")\n  onFaceChanged() {\n    this.updateOverlayCanvas();\n  }\n\n  @Watch(\"thermalReference\")\n  onThermalReferenceChanged() {\n    this.updateOverlayCanvas();\n  }\n\n  @Watch(\"cropBox\")\n  onCropChanged() {\n    this.updateOverlayCanvas();\n  }\n\n  @Emit(\"crop-changed\")\n  gotCropChange(cropBox: CropBox) {\n    this.updateOverlayCanvas();\n    return cropBox;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VideoStream.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VideoStream.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./VideoStream.vue?vue&type=template&id=89fc6c86&scoped=true&\"\nimport script from \"./VideoStream.vue?vue&type=script&lang=ts&\"\nexport * from \"./VideoStream.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./VideoStream.vue?vue&type=style&index=0&id=89fc6c86&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"89fc6c86\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\ninstallComponents(component, {VBtn,VIcon})\n","import { NetworkInterface } from \"./types\";\nimport { QRCode } from \"jsqr\";\nimport { CalibrationConfig, CalibrationInfo, ScreeningEvent } from \"@/types\";\nimport { Frame } from \"@/camera\";\nconst API_BASE =\n  \"https://ixg63w0770.execute-api.ap-southeast-2.amazonaws.com/event\";\nconst DEVICE_ENDPOINT = (deviceId: string) =>\n  `https://3pu8ojk2ej.execute-api.ap-southeast-2.amazonaws.com/default/devices/${deviceId}`;\n\nexport const ExternalDeviceSettingsApi = {\n  async getDevice(deviceId: string) {\n    const request = fetch(DEVICE_ENDPOINT(deviceId), {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n    const response = await request;\n\n    if (response.status === 200) {\n      const body = await response.json();\n      return body;\n    } else {\n      console.error(response);\n    }\n  }\n};\n\nexport const ScreeningApi = {\n  async recordScreeningEvent(\n    deviceId: string,\n    deviceSerial: string,\n    data: ScreeningEvent,\n    feverMinThresholdAtRecordingTime: number,\n    QRID?: string\n  ) {\n    if (deviceId !== \"\") {\n      const appVersion = data.frame.frameInfo.AppVersion;\n      const Channel =\n        appVersion.includes(\"beta\") || appVersion.includes(\"nightly\")\n          ? \"beta\"\n          : \"stable\";\n      const request = fetch(API_BASE, {\n        method: \"POST\",\n        body: JSON.stringify({\n          Channel,\n          CameraID: `${deviceId}`,\n          Type: \"Screen\",\n          Timestamp: data.timestamp\n            .toISOString()\n            .replace(/:/g, \"_\")\n            .replace(/\\./g, \"_\"),\n          DisplayedTemperature: data.calculatedValue,\n          AppVersion: appVersion,\n          FeverThreshold: feverMinThresholdAtRecordingTime,\n          Meta: {\n            Face: {\n              tL: data.face.head.topLeft,\n              tR: data.face.head.topRight,\n              bL: data.face.head.bottomLeft,\n              bR: data.face.head.bottomRight\n            },\n            Sample: { x: data.sampleX, y: data.sampleY },\n            SampleRaw: Math.round(data.rawTemperatureValue),\n            RefTemp: data.thermalReference.temp,\n            RefRaw: data.thermalReference.val,\n            Telemetry: data.frame.frameInfo.Telemetry\n          },\n          ...(QRID && { QRID })\n        })\n      });\n      const response = await request;\n      const presignedUrl = await response.text();\n      // Based on the user, we find out whether or not to upload a reference image.\n      if (presignedUrl) {\n        // Upload to s3\n        fetch(presignedUrl, {\n          method: \"PUT\",\n          body: data.frame.frame,\n          headers: {\n            \"Content-Type\": \"application/octet-stream\",\n            \"Content-Encoding\": \"utf8\"\n          }\n        });\n      }\n    } else {\n      console.error(\"Can't send telemetry, missing deviceId\");\n    }\n  },\n  async recordCalibrationEvent(\n    deviceId: string,\n    deviceSerial: string,\n    calibrationChanged: boolean,\n    thresholdChanged: boolean,\n    calibration: CalibrationConfig,\n    frame: Frame,\n    x: number,\n    y: number\n  ) {\n    if (deviceId !== \"\") {\n      const appVersion = frame.frameInfo.AppVersion;\n      const Channel =\n        appVersion.includes(\"beta\") || appVersion.includes(\"nightly\")\n          ? \"beta\"\n          : \"stable\";\n      const calibrationPayload = {\n        Channel,\n        CameraID: `${deviceId}`,\n        Type: \"Calibrate\",\n        Timestamp: calibration.timestamp\n          .toISOString()\n          .replace(/:/g, \"_\")\n          .replace(/\\./g, \"_\"),\n        CalibratedTemp: parseFloat(\n          calibration.calibrationTemperature.val.toFixed(2)\n        ),\n        MinFeverThreshold: calibration.thresholdMinFever,\n        ThermalRefTemp: parseFloat(\n          calibration.thermalRefTemperature.val.toFixed(2)\n        ),\n        AppVersion: appVersion,\n        Meta: {\n          Face: calibration.head,\n          Sample: { x, y },\n          SampleRaw: Math.round(calibration.hotspotRawTemperatureValue),\n          RefRaw: Math.round(calibration.thermalReferenceRawValue),\n          Telemetry: frame.frameInfo.Telemetry\n        }\n      };\n      const request = fetch(API_BASE, {\n        method: \"POST\",\n        body: JSON.stringify(calibrationPayload)\n      });\n      const response = await request;\n      // Only upload an image if calibration changed, not threshold.\n      if (response.status === 200 && calibrationChanged) {\n        const presignedUrl = await response.text();\n        // Based on the user, we find out whether or not to upload a reference image.\n        if (presignedUrl) {\n          // Upload to s3\n          fetch(presignedUrl, {\n            method: \"PUT\",\n            body: frame.frame,\n            headers: {\n              \"Content-Type\": \"application/octet-stream\",\n              \"Content-Encoding\": \"utf8\"\n            }\n          });\n        }\n      }\n    } else {\n      console.error(\"Can't sent calibration event, missing deviceId\");\n    }\n  }\n};\n\nexport const DeviceApi = {\n  // Allows videos recorded based on activity.\n  recordUserActivity: false,\n  disableRecordUserActivity: true,\n  registerQRID: false,\n  get DisableRecordUserActivity(): boolean {\n    return this.disableRecordUserActivity;\n  },\n  set DisableRecordUserActivity(disable: boolean) {\n    this.disableRecordUserActivity = disable;\n    this.stopRecording(false);\n  },\n  get RegisterQRID(): boolean {\n    return this.registerQRID;\n  },\n  set RegisterQRID(enable: boolean) {\n    this.registerQRID = enable;\n    window.localStorage.setItem(\"registerQRID\", enable ? \"true\" : \"false\");\n  },\n  get RecordUserActivity(): boolean {\n    return this.recordUserActivity;\n  },\n  set RecordUserActivity(enable: boolean) {\n    this.recordUserActivity = enable;\n    window.localStorage.setItem(\n      \"recordUserActivity\",\n      enable ? \"true\" : \"false\"\n    );\n    this.stopRecording(false);\n  },\n  get debugPrefix() {\n    if (window.location.port === \"8080\" || window.location.port === \"5000\") {\n      // Used for developing the front-end against an externally running version of the\n      // backend, so it's not necessary to package up the build to do front-end testing.\n      //return \"http://localhost:2041\";\n      //return \"http://192.168.178.37\";\n      return \"http://192.168.0.181\";\n      //return \"http://192.168.0.82\";\n      //return \"http://192.168.178.21\";\n      //return \"http://192.168.0.41\";\n    }\n    return \"\";\n  },\n  get SOFTWARE_VERSION() {\n    return `${this.debugPrefix}/api/version`;\n  },\n  get DEVICE_INFO() {\n    return `${this.debugPrefix}/api/device-info`;\n  },\n  get DEVICE_TIME() {\n    return `${this.debugPrefix}/api/clock`;\n  },\n  get RUN_FFC() {\n    return `${this.debugPrefix}/api/camera/run-ffc`;\n  },\n  get DEVICE_CONFIG() {\n    return `${this.debugPrefix}/api/config`;\n  },\n  get NETWORK_INFO() {\n    return `${this.debugPrefix}/api/network-info`;\n  },\n  get SAVE_CALIBRATION() {\n    return `${this.debugPrefix}/api/calibration/save`;\n  },\n  get LOAD_CALIBRATION() {\n    return `${this.debugPrefix}/api/calibration/get`;\n  },\n  get RECORDER_STATUS() {\n    return `${this.debugPrefix}/recorderstatus`;\n  },\n  get START_RECORDING() {\n    return `${this.debugPrefix}/record?start=true`;\n  },\n  get STOP_RECORDING() {\n    return `${this.debugPrefix}/record?stop=true&dowload=false`;\n  },\n  get DOWNLOAD_RECORDING() {\n    return `${this.debugPrefix}/record?stop=true&download=true`;\n  },\n  async get(url: string) {\n    return fetch(url, {\n      method: \"GET\",\n      headers: {\n        Authorization: `Basic ${btoa(\"admin:feathers\")}`\n      }\n    });\n  },\n  async post(\n    url: string,\n    data:\n      | Blob\n      | BufferSource\n      | FormData\n      | URLSearchParams\n      | ReadableStream<Uint8Array>\n      | string\n      | null\n  ) {\n    return fetch(url, {\n      method: \"POST\",\n      headers: {\n        Authorization: `Basic ${btoa(\"admin:feathers\")}`,\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      body: data\n    });\n  },\n  async put(url: string) {\n    return fetch(url, {\n      method: \"PUT\",\n      headers: {\n        Authorization: `Basic ${btoa(\"admin:feathers\")}`,\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      }\n    });\n  },\n  async getJSON(url: string) {\n    const response = await this.get(url);\n    try {\n      return response.json();\n    } catch (e) {\n      return {};\n    }\n  },\n  async getText(url: string) {\n    const response = await this.get(url);\n    return response.text();\n  },\n  async softwareVersion(): Promise<{\n    apiVersion: number;\n    appVersion: string;\n    binaryVersion: string;\n  }> {\n    return this.getJSON(this.SOFTWARE_VERSION);\n  },\n  async startRecording(): Promise<boolean> {\n    const result = await this.getText(this.START_RECORDING);\n    return result === \"<nil>\";\n  },\n  async stopRecording(download = true): Promise<string> {\n    const result = await this.getText(\n      download ? this.DOWNLOAD_RECORDING : this.STOP_RECORDING\n    );\n    return result;\n  },\n  async deviceInfo(): Promise<{\n    serverURL?: string;\n    devicename: string;\n    deviceID: string;\n    serial: string;\n  }> {\n    return this.getJSON(this.DEVICE_INFO);\n  },\n  async deviceTime() {\n    return this.getJSON(this.DEVICE_TIME);\n  },\n  async recorderStatus() {\n    return this.getJSON(this.RECORDER_STATUS);\n  },\n  async deviceConfig() {\n    return this.getJSON(this.DEVICE_CONFIG);\n  },\n  async runFFC() {\n    console.log(\"Request FFC\");\n    return this.put(this.RUN_FFC);\n  },\n  async networkInfo(): Promise<{\n    Interfaces: NetworkInterface[];\n    Config: { Online: boolean };\n  }> {\n    return this.getJSON(this.NETWORK_INFO);\n  },\n  async saveCalibration(data: CalibrationInfo) {\n    // NOTE: This API only supports a json payload one level deep.  No nested structures.\n    const formData = new URLSearchParams();\n    formData.append(\"calibration\", JSON.stringify(data));\n    return this.post(this.SAVE_CALIBRATION, formData);\n  },\n  async getCalibration(): Promise<CalibrationInfo | null> {\n    return this.getJSON(this.LOAD_CALIBRATION);\n  }\n};\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport {\n  AppState,\n  CropBox,\n  DEFAULT_THRESHOLD_MIN_FEVER,\n  InitialFrameInfo,\n  ScreeningEvent,\n  ScreeningState\n} from \"@/types\";\nimport { State } from \"@/main\";\nimport VideoStream from \"@/components/VideoStream.vue\";\nimport { DegreesCelsius } from \"@/utils\";\nimport { mdiMinus, mdiPencil, mdiPlus } from \"@mdi/js\";\nimport { DeviceApi, ScreeningApi } from \"@/api/api\";\n\n@Component({\n  components: { VideoStream }\n})\nexport default class CalibrationSettings extends Vue {\n  private useCustomTemperatureRange = false;\n  private editedTemperatureThreshold = 0;\n  private showCalibrationDialog = false;\n  private editedCropBox: CropBox | null = null;\n  private editedCalibration: DegreesCelsius = new DegreesCelsius(0);\n  private pendingCalibration: DegreesCelsius = new DegreesCelsius(0);\n  private snapshotScreeningEvent: ScreeningEvent | null = null;\n  private playNormalSound = true;\n  private playWarningSound = true;\n  private playErrorSound = true;\n  private deviceName = \"\";\n  private deviceID = \"\";\n  private piSerial = \"\";\n\n  toggleCustomTemperatureThresholds(val: boolean) {\n    if (val) {\n      this.editedTemperatureThreshold = this.state.currentCalibration.thresholdMinFever;\n    }\n    if (!val) {\n      this.editedTemperatureThreshold = DEFAULT_THRESHOLD_MIN_FEVER;\n    }\n    this.persistSettings();\n    // Update custom back to defaults\n  }\n\n  get selectedTemperatureRange() {\n    return `${new DegreesCelsius(this.editedTemperatureThreshold)}`;\n  }\n\n  get hasMadeEdits(): boolean {\n    const unedited = {\n      head: this.state.currentCalibration.head,\n      temperatureThreshold: this.state.currentCalibration.thresholdMinFever,\n      calibration: parseFloat(\n        this.state.currentCalibration.calibrationTemperature.val.toFixed(2)\n      ),\n      sounds: {\n        warning: this.state.currentCalibration.playWarningSound,\n        normal: this.state.currentCalibration.playNormalSound,\n        error: this.state.currentCalibration.playErrorSound\n      }\n    };\n    const edited = {\n      head: this.state.currentCalibration.head,\n      temperatureThreshold: this.editedTemperatureThreshold,\n      calibration: parseFloat(this.editedCalibration.val.toFixed(2)),\n      sounds: {\n        warning: this.playWarningSound,\n        normal: this.playNormalSound,\n        error: this.playErrorSound\n      }\n    };\n    const a = JSON.stringify(edited);\n    const b = JSON.stringify(unedited);\n    return a != b;\n  }\n\n  get plusIcon() {\n    return mdiPlus;\n  }\n\n  get pencilIcon() {\n    return mdiPencil;\n  }\n\n  get minusIcon() {\n    return mdiMinus;\n  }\n\n  get state(): AppState {\n    return State;\n  }\n\n  get canCalibrate() {\n    return this.latestScreeningEvent !== null;\n  }\n\n  get screeningState(): ScreeningState {\n    return this.state.currentScreeningState;\n  }\n\n  get latestScreeningEvent(): ScreeningEvent | null {\n    return this.state.currentScreeningEvent;\n  }\n\n  get calibration(): DegreesCelsius {\n    return this.pendingCalibration;\n  }\n\n  editCalibration() {\n    this.editedCalibration = new DegreesCelsius(this.calibration.val);\n    this.snapshotScreeningEvent = this.latestScreeningEvent;\n    this.showCalibrationDialog = true;\n  }\n\n  async acceptCalibration() {\n    this.pendingCalibration = new DegreesCelsius(this.editedCalibration.val);\n    this.showCalibrationDialog = false;\n    await this.persistSettings();\n  }\n\n  async persistSettings(): Promise<Response | undefined> {\n    // Get these values from the current screening event.\n    const currentCalibration = this.pendingCalibration;\n    let thermalRefTemp = this.state.currentCalibration.thermalRefTemperature\n      .val;\n    let thermalRefRaw = this.state.currentCalibration.thermalReferenceRawValue;\n    let rawTempValue = this.state.currentCalibration.hotspotRawTemperatureValue;\n    const thresholdMinFever = this.editedTemperatureThreshold;\n    let sampleX = -1;\n    let sampleY = -1;\n    let frame = this.state.currentFrame!;\n    let head = {\n      tL: { x: 0, y: 0 },\n      tR: { x: 0, y: 0 },\n      bL: { x: 0, y: 0 },\n      bR: { x: 0, y: 0 }\n    };\n    if (this.snapshotScreeningEvent) {\n      frame = this.snapshotScreeningEvent.frame;\n      head = {\n        tL: this.snapshotScreeningEvent.face.head.topLeft,\n        tR: this.snapshotScreeningEvent.face.head.topRight,\n        bL: this.snapshotScreeningEvent.face.head.bottomLeft,\n        bR: this.snapshotScreeningEvent.face.head.bottomRight\n      };\n      thermalRefRaw = this.snapshotScreeningEvent.thermalReference.val;\n      rawTempValue = this.snapshotScreeningEvent.rawTemperatureValue;\n      thermalRefTemp =\n        currentCalibration.val - (rawTempValue - thermalRefRaw) * 0.01;\n      sampleX = this.snapshotScreeningEvent.sampleX;\n      sampleY = this.snapshotScreeningEvent.sampleY;\n    }\n    const timestamp = new Date();\n    const calibrationChanged =\n      currentCalibration.val !==\n      this.state.currentCalibration.calibrationTemperature.val;\n    const thresholdChanged =\n      thresholdMinFever !== this.state.currentCalibration.thresholdMinFever;\n    const headBoundsChanged =\n      JSON.stringify(head) !==\n      JSON.stringify(this.state.currentCalibration.head);\n    if (calibrationChanged || thresholdChanged || headBoundsChanged) {\n      // Only update the server log for threshold or calibration changes, not for sound effect prefs etc.\n      ScreeningApi.recordCalibrationEvent(\n        this.deviceID,\n        this.piSerial,\n        calibrationChanged,\n        thresholdChanged,\n        {\n          head,\n          timestamp: timestamp,\n          calibrationTemperature: currentCalibration,\n          hotspotRawTemperatureValue: rawTempValue,\n          thermalRefTemperature: new DegreesCelsius(thermalRefTemp),\n          thermalReferenceRawValue: thermalRefRaw,\n          thresholdMinFever,\n          playErrorSound: this.playErrorSound,\n          playWarningSound: this.playWarningSound,\n          playNormalSound: this.playNormalSound\n        },\n        frame,\n        sampleX,\n        sampleY\n      );\n    }\n    {\n      // For non-live playback\n      InitialFrameInfo.Calibration.ThermalRefTemp = thermalRefTemp;\n      InitialFrameInfo.Calibration.TemperatureCelsius = parseFloat(\n        currentCalibration.val.toFixed(2)\n      );\n      InitialFrameInfo.Calibration.UseErrorSound = this.playErrorSound;\n      InitialFrameInfo.Calibration.UseNormalSound = this.playNormalSound;\n      InitialFrameInfo.Calibration.UseWarningSound = this.playWarningSound;\n    }\n    const newCalibration = {\n      ThresholdMinFever: thresholdMinFever,\n      ThermalRefTemp: thermalRefTemp,\n      TemperatureCelsius: parseFloat(currentCalibration.val.toFixed(2)),\n      HeadTLX: head.tL.x,\n      HeadTLY: head.tL.y,\n      HeadBLX: head.bL.x,\n      HeadBLY: head.bL.y,\n      HeadTRX: head.tR.x,\n      HeadTRY: head.tR.y,\n      HeadBRX: head.bR.x,\n      HeadBRY: head.bR.y,\n      UuidOfUpdater: this.state.uuid,\n      CalibrationBinaryVersion: this.state.currentFrame!.frameInfo\n        .BinaryVersion,\n      SnapshotTime: timestamp.getTime(),\n      SnapshotValue: rawTempValue,\n      UseNormalSound: this.playNormalSound,\n      UseWarningSound: this.playWarningSound,\n      UseErrorSound: this.playErrorSound\n    };\n    return DeviceApi.saveCalibration(newCalibration);\n  }\n\n  incrementCalibration(amount: number) {\n    this.editedCalibration = new DegreesCelsius(\n      this.editedCalibration.val + amount\n    );\n  }\n\n  updateCalibration(event: FocusEvent) {\n    const value = (event.target as HTMLInputElement).value\n      .replace(\"&deg;\", \"\")\n      .replace(\"°\", \"\");\n    if (isNaN(Number(value))) {\n      this.editedCalibration = new DegreesCelsius(36);\n    }\n    this.editedCalibration = new DegreesCelsius(Number(value));\n  }\n\n  resetEdits() {\n    this.pendingCalibration = new DegreesCelsius(\n      this.state.currentCalibration.calibrationTemperature.val\n    );\n    this.editedCalibration = new DegreesCelsius(\n      this.state.currentCalibration.calibrationTemperature.val\n    );\n    this.editedTemperatureThreshold = this.state.currentCalibration.thresholdMinFever;\n    this.useCustomTemperatureRange =\n      this.editedTemperatureThreshold !== DEFAULT_THRESHOLD_MIN_FEVER;\n    this.playNormalSound = this.state.currentCalibration.playNormalSound;\n    this.playWarningSound = this.state.currentCalibration.playWarningSound;\n    this.playErrorSound = this.state.currentCalibration.playErrorSound;\n  }\n\n  private saving = false;\n  async saveEdits() {\n    this.saving = true;\n    await this.persistSettings();\n    this.saving = false;\n  }\n\n  async beforeMount() {\n    const { deviceID, devicename, serial } = await DeviceApi.deviceInfo();\n    this.deviceID = deviceID;\n    this.deviceName = devicename;\n    this.piSerial = serial;\n    this.resetEdits();\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CalibrationSettings.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CalibrationSettings.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./CalibrationSettings.vue?vue&type=template&id=bf659bf4&scoped=true&\"\nimport script from \"./CalibrationSettings.vue?vue&type=script&lang=ts&\"\nexport * from \"./CalibrationSettings.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./CalibrationSettings.vue?vue&type=style&index=0&id=bf659bf4&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bf659bf4\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardSubtitle } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCheckbox } from 'vuetify/lib/components/VCheckbox';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VOverlay } from 'vuetify/lib/components/VOverlay';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSlider } from 'vuetify/lib/components/VSlider';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VCard,VCardActions,VCardSubtitle,VCardText,VCardTitle,VCheckbox,VCol,VContainer,VDialog,VIcon,VOverlay,VRow,VSlider,VSpacer,VSwitch,VTextField})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{attrs:{\"flat\":\"\"}},[(_vm.items)?_c('v-simple-table',{scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('thead',[_c('tr',[_c('th',{staticClass:\"text-left\"},[_vm._v(\"Device config\")]),_c('th',{staticClass:\"text-left\"})])]),_c('tbody',_vm._l((_vm.items),function(ref){\nvar name = ref[0];\nvar item = ref[1];\nreturn _c('tr',{key:name},[_c('td',[_vm._v(_vm._s(name))]),_c('td',[_vm._v(_vm._s(item))])])}),0)]},proxy:true}],null,false,421180828)}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport { AppState } from \"@/types\";\nimport { State } from \"@/main\";\nimport { DeviceApi } from \"@/api/api\";\nimport { CameraInfo, NetworkInterface } from \"@/api/types\";\n\n@Component\nexport default class DeviceInfo extends Vue {\n  private info: {\n    devicename?: string;\n    deviceID?: string;\n    serial?: string;\n  } = {};\n  private networkInfo: {\n    Interfaces?: NetworkInterface[];\n    IPAddress?: string;\n    Config?: { Online: boolean };\n    Online?: boolean;\n  } = {};\n  private softwareVersion: {\n    apiVersion?: number;\n    appVersion?: string;\n    binaryVersion?: string;\n  } = {};\n\n  get items() {\n    return [\n      ...Object.entries(this.info),\n      ...Object.entries(this.softwareVersion),\n      ...Object.entries(this.networkInfo),\n      ...Object.entries(this.cameraInfo),\n    ];\n  }\n\n  get cameraInfo() {\n    const camera: CameraInfo = {\n      ...State.currentFrame?.frameInfo.Camera,\n    } as CameraInfo;\n    return camera as any;\n  }\n\n  get state(): AppState {\n    return State;\n  }\n\n  async beforeMount() {\n    // Get all the device data.\n    const info = await DeviceApi.deviceInfo();\n\n    this.info = info;\n    const networkInfo = await DeviceApi.networkInfo();\n    let IPAddress = networkInfo.Interfaces.filter(\n      (nic) => nic.IPAddresses !== null\n    ).map((nic) => nic.IPAddresses![0])[0];\n    IPAddress = IPAddress.substring(0, IPAddress.indexOf(\"/\"));\n    this.networkInfo = {\n      Online: networkInfo.Config.Online,\n      IPAddress,\n    };\n\n    const softwareVersion = await DeviceApi.softwareVersion();\n    softwareVersion.binaryVersion = softwareVersion.binaryVersion.substring(\n      0,\n      10\n    );\n    const newLine = softwareVersion.appVersion.indexOf(\"\\n\");\n    if (newLine !== -1) {\n      softwareVersion.appVersion = softwareVersion.appVersion.substring(\n        0,\n        newLine\n      );\n    }\n    this.softwareVersion = softwareVersion;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DeviceInfo.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DeviceInfo.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./DeviceInfo.vue?vue&type=template&id=a2dc84ae&scoped=true&\"\nimport script from \"./DeviceInfo.vue?vue&type=script&lang=ts&\"\nexport * from \"./DeviceInfo.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a2dc84ae\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VSimpleTable } from 'vuetify/lib/components/VDataTable';\ninstallComponents(component, {VCard,VSimpleTable})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{attrs:{\"flat\":\"\",\"height\":\"calc(100vh - 112px)\"}},[_c('v-container',{staticClass:\"cont\"},[_c('v-card',[_c('VideoStream',{attrs:{\"frame\":_vm.state.currentFrame.frame,\"face\":_vm.state.face,\"min\":_vm.state.currentFrame.analysisResult.heatStats.min,\"max\":_vm.state.currentFrame.analysisResult.heatStats.max,\"crop-box\":_vm.editedThermalRefMask,\"crop-enabled\":false,\"recording\":_vm.isRecording},on:{\"crop-changed\":_vm.onMaskChanged}}),_c('div',{staticClass:\"buttons\"},[(_vm.isRunningInAndroidWebview)?_c('div',[_vm._v(\" To make recordings this needs to be running inside a browser, not the Te Kahu Ora app. \")]):_c('div',[_c('v-btn',{staticClass:\"mb-4\",attrs:{\"center\":\"\"},on:{\"click\":_vm.toggleRecording}},[_vm._v(\" \"+_vm._s(!_vm.isRecording ? \"Record\" : \"Stop Recording\")+\" \")])],1)])],1),_c('v-card',[_c('v-card-actions',[_c('v-btn',{staticClass:\"ml-6\",on:{\"click\":_vm.skipWarmup}},[_vm._v(\"Skip warmup period\")]),(!_vm.disableRecordUserActivity)?_c('v-switch',{staticClass:\"pl-6\",attrs:{\"label\":\"Record User Activities\"},model:{value:(_vm.recordUserActivity),callback:function ($$v) {_vm.recordUserActivity=$$v},expression:\"recordUserActivity\"}}):_vm._e(),_c('v-switch',{staticClass:\"pl-6\",attrs:{\"label\":\"Enable QR mode\",\"disabled\":_vm.cameraAvailable},model:{value:(_vm.qrMode),callback:function ($$v) {_vm.qrMode=$$v},expression:\"qrMode\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport VideoStream from \"@/components/VideoStream.vue\";\nimport { State } from \"@/main\";\nimport { AppState, CropBox } from \"@/types\";\nimport { ObservableDeviceApi as DeviceApi } from \"@/main\";\n\nfunction download(dataurl: string) {\n  const a = document.createElement(\"a\");\n  a.href = dataurl;\n  a.setAttribute(\"download\", dataurl);\n  a.click();\n}\n\n@Component({\n  components: {\n    VideoStream,\n  },\n})\nexport default class DeveloperUtilities extends Vue {\n  private editedThermalRefMask: CropBox | null = null;\n  private isRecording = false;\n\n  get cameraAvailable(): boolean {\n    return navigator.mediaDevices === undefined;\n  }\n\n  get recordUserActivity() {\n    return DeviceApi.RecordUserActivity;\n  }\n  set recordUserActivity(enable: boolean) {\n    DeviceApi.RecordUserActivity = enable;\n  }\n\n  get disableRecordUserActivity() {\n    return DeviceApi.DisableRecordUserActivity;\n  }\n\n  get qrMode() {\n    return DeviceApi.RegisterQRID;\n  }\n\n  set qrMode(enable: boolean) {\n    DeviceApi.RegisterQRID = enable;\n  }\n\n  skipWarmup() {\n    this.$root.$children[0].$children[0].$emit(\"skip-warmup\");\n  }\n\n  onMaskChanged(box: CropBox) {\n    this.editedThermalRefMask = box;\n  }\n\n  get state(): AppState {\n    return State;\n  }\n\n  get isRunningInAndroidWebview(): boolean {\n    return window.navigator.userAgent === \"feverscreen-app\";\n  }\n\n  async toggleRecording() {\n    const { recording, processor } = await DeviceApi.recorderStatus();\n    if (!processor) {\n      return false;\n    }\n    if (recording) {\n      download(DeviceApi.DOWNLOAD_RECORDING);\n      this.isRecording = false;\n    } else {\n      this.isRecording = await DeviceApi.startRecording();\n    }\n  }\n\n  async mounted() {\n    const { recording } = await DeviceApi.recorderStatus();\n    this.isRecording = recording;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DeveloperUtilities.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DeveloperUtilities.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./DeveloperUtilities.vue?vue&type=template&id=f23cb8ce&scoped=true&\"\nimport script from \"./DeveloperUtilities.vue?vue&type=script&lang=ts&\"\nexport * from \"./DeveloperUtilities.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./DeveloperUtilities.vue?vue&type=style&index=0&id=f23cb8ce&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f23cb8ce\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\ninstallComponents(component, {VBtn,VCard,VCardActions,VContainer,VSwitch})\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Emit, Prop, Vue } from \"vue-property-decorator\";\nimport CalibrationSettings from \"@/components/CalibrationSettings.vue\";\nimport DeviceInfo from \"@/components/DeviceInfo.vue\";\nimport DeveloperUtilities from \"@/components/DeveloperUtilities.vue\";\n\ninterface TabItem {\n  tab: string;\n  content: any;\n}\n\n@Component({\n  components: {\n    CalibrationSettings,\n    DeviceInfo,\n    DeveloperUtilities\n  }\n})\nexport default class AdminSettings extends Vue {\n  private tab: TabItem | null = null;\n  private tabItems: TabItem[] = [\n    {\n      tab: \"Calibration\",\n      content: CalibrationSettings\n    },\n    {\n      tab: \"Device info\",\n      content: DeviceInfo\n    },\n    {\n      tab: \"Developer\",\n      content: DeveloperUtilities\n    }\n  ];\n\n  @Emit(\"closed\")\n  close() {\n    return true;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AdminSettings.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AdminSettings.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./AdminSettings.vue?vue&type=template&id=dc077da8&scoped=true&\"\nimport script from \"./AdminSettings.vue?vue&type=script&lang=ts&\"\nexport * from \"./AdminSettings.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"dc077da8\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTab } from 'vuetify/lib/components/VTabs';\nimport { VTabItem } from 'vuetify/lib/components/VTabs';\nimport { VTabs } from 'vuetify/lib/components/VTabs';\nimport { VTabsItems } from 'vuetify/lib/components/VTabs';\nimport { VToolbar } from 'vuetify/lib/components/VToolbar';\nimport { VToolbarTitle } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VBtn,VCard,VSpacer,VTab,VTabItem,VTabs,VTabsItems,VToolbar,VToolbarTitle})\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Possible states:\n// - Camera is still warming up\n//  (this should still want to find the constant heat source, because we want to make\n//   sure that's warming up at the same time)\n// - Frame is empty, no head detected.\n// - Head detected, but not centered.\n// - More than one head detected in frame.\n// - No constant heat-source detected.\n// - Head detected, and forehead isolated.\n// - Head has been front-on for x frames, with stable forehead lock.\n\n// - Other states:\n//      - Wifi has been lost (maybe don't care about this case now if we're wired?)\n//      - FFC is happening\n//      - Period *after* FFC, which we need to hide.\nimport { Component, Prop, Vue, Watch } from \"vue-property-decorator\";\nimport { mdiCog } from \"@mdi/js\";\nimport {\n  CalibrationConfig,\n  FaceInfo,\n  ScreeningEvent,\n  ScreeningState,\n} from \"@/types\";\nimport { DegreesCelsius } from \"@/utils\";\nimport AdminSettings from \"@/components/AdminSettings.vue\";\nimport { LerpAmount, WARMUP_TIME_SECONDS } from \"@/main\";\nimport { Point, Shape, Span } from \"@/geom\";\n\nconst PROBABLE_ERROR_TEMP = 42.5;\nconst thermalRefWidth = 42;\n\nfunction lerp(a: number, amt: number, b: number): number {\n  return a * amt + b * (1 - amt);\n}\n\nfunction closestY(prev: Span[], y: number): Span | undefined {\n  const best = prev\n    .map((x) => ({ d: Math.abs(Number(x.y) - y), x }))\n    .sort((a, b) => b.d - a.d)\n    .pop() as { x: Span; d: number };\n  return prev.find((x) => x.y === best.x.y);\n}\n\nfunction interpolateShapes(prev: Shape, amt: number, next: Shape): Shape {\n  // For each row with the same y, interpolate x0 and x0 and x1 and x1 linearly on x.\n  // Then it's a matter of figuring out what to do with the rest.\n  amt = 1 - amt;\n  const result = [];\n  // TODO(jon): Start at the bottom.\n\n  for (let i = 0; i < next.length; i++) {\n    const rowNext = next[i];\n    const y = rowNext.y;\n    if (prev[i]) {\n      // Move others across in x the same amount as the adjacent ones that *do* exist.\n      const rowPrev = prev[i];\n      result.push({\n        x0: lerp(rowPrev.x0, amt, rowNext.x0),\n        x1: lerp(rowPrev.x1, amt, rowNext.x1),\n        y: Number(y),\n      });\n    } else {\n      // What's the closest point on prev?\n      // Let's use that.\n      const rowPrev = closestY(prev, y) as unknown as Span;\n      // Should actually be the amount that rowPrev moved compared with\n      // it's corresponding row in rowNext.\n      result.push({\n        x0: lerp(rowPrev.x0, amt, rowNext.x0),\n        x1: lerp(rowPrev.x1, amt, rowNext.x1),\n        y: Number(y),\n      });\n    }\n  }\n  return result;\n}\n\nlet frameNum = 0;\n\nlet curveFitting: { fitCurveThroughPoints: (pts: Uint8Array) => number[] };\n\ninterface Message {\n  message: string;\n  count: number;\n}\n\nconst Sound = new Audio();\n\n@Component({\n  components: {\n    AdminSettings,\n  },\n})\nexport default class UserFacingScreening extends Vue {\n  @Prop({ required: true }) state!: ScreeningState;\n  @Prop({ required: true }) screeningEvent!: null | ScreeningEvent;\n  @Prop({ required: true }) calibration!: CalibrationConfig;\n  @Prop({ required: true }) onReferenceDevice!: boolean;\n  @Prop({ required: true }) face!: FaceInfo | null;\n  @Prop({ required: true }) shapes!: [Shape[], Shape[]];\n  @Prop({ required: true }) warmupSecondsRemaining!: number;\n  @Prop({ required: true }) isTesting!: number;\n  @Prop({ required: true }) thermalRefSide!: \"left\" | \"right\";\n  @Prop({ default: true }) showCanvas!: boolean;\n\n  get isLocal(): boolean {\n    return window.location.port === \"5000\" || window.location.port === \"8080\";\n  }\n\n  private didInteract = false;\n\n  private showSettings = false;\n  private hasSettings = false;\n  private shouldLeaveFrame = false;\n  private prevFrameTime = performance.now();\n\n  $refs!: {\n    beziers: HTMLCanvasElement;\n    QRRef: SVGImageElement;\n  };\n\n  stateQueue: Message[] = [];\n\n  closedAdminSettings() {\n    this.showSettings = false;\n    setTimeout(() => {\n      this.hasSettings = false;\n    }, 300);\n  }\n\n  set interacted(val: boolean) {\n    // Don't allow interaction if the camera isn't getting frames.\n    this.didInteract = val;\n    setTimeout(() => (this.didInteract = false), 5000);\n  }\n\n  get interacted(): boolean {\n    return this.didInteract;\n  }\n\n  get cogIcon() {\n    return mdiCog;\n  }\n\n  async beforeMount() {\n    curveFitting = await import(\"../../curve-fit\");\n  }\n  private canvasWidth = 710;\n  private canvasHeight = 1080;\n\n  mounted() {\n    if (this.$refs.beziers) {\n      const aspectRatio = 4 / 3;\n      if (navigator.userAgent.includes(\"Lenovo TB-X605LC\")) {\n        this.canvasHeight = document.body.getBoundingClientRect().height;\n      } else {\n        this.canvasHeight = (\n          this.$refs.beziers.parentElement as HTMLElement\n        ).getBoundingClientRect().height;\n      }\n      this.canvasWidth = this.canvasHeight / aspectRatio;\n      this.$refs.beziers.style.width = `${this.canvasWidth}px`;\n      this.$refs.beziers.style.height = `${this.canvasHeight}px`;\n      const ctx = this.$refs.beziers.getContext(\n        \"2d\"\n      ) as CanvasRenderingContext2D;\n      ctx.lineWidth = 1;\n      ctx.strokeStyle = \"rgba(255, 255, 255, 0.5)\";\n      ctx.fillStyle = \"rgba(255, 255, 255, 0.2)\";\n      ctx.lineWidth = 2;\n      ctx.lineCap = \"round\";\n    }\n    window.requestAnimationFrame(this.drawBezierOutline.bind(this));\n  }\n\n  get messageText(): string {\n    let message = \"Ready\";\n    if (this.isWarmingUp) {\n      message = `Warming up, <span>${this.remainingWarmupTime}</span> remaining`;\n    } else if (this.isAfterFFCEvent) {\n      message = \"One moment...\";\n    } else if (this.isAquiring) {\n      message = \"Hold still...\";\n    } else if (this.isTooFar) {\n      message = \"Come closer\";\n    } else if (this.missingRef) {\n      message = \"Missing reference\";\n    }\n    this.logForTest(message);\n    return message;\n  }\n\n  get screeningAdvice(): string {\n    if (this.temperatureIsNormal) {\n      return \"You're good to go!\";\n    } else if (this.temperatureIsHigherThanNormal) {\n      return \"Get checked out now!\";\n    } else {\n      return \"Please check calibration\";\n    }\n  }\n\n  get finishScan(): boolean {\n    return this.state === ScreeningState.MEASURED;\n  }\n\n  @Watch(\"screeningEvent\")\n  onScreeningEventChange(event: ScreeningEvent | null) {\n    if (event !== null) {\n      const calibration = event.frame.frameInfo.Calibration;\n      if (this.temperatureIsNormal) {\n        if (calibration.UseNormalSound) {\n          Sound.src = `${process.env.BASE_URL}sounds/341695_5858296-lq.mp3`;\n          Sound.play();\n        }\n      } else if (this.temperatureIsHigherThanNormal) {\n        if (calibration.UseWarningSound) {\n          Sound.src = `${process.env.BASE_URL}sounds/445978_9159316-lq.mp3`;\n          Sound.play();\n        }\n      } else if (this.temperatureIsProbablyAnError) {\n        if (calibration.UseErrorSound) {\n          Sound.src = `${process.env.BASE_URL}sounds/142608_1840739-lq.mp3`;\n          Sound.play();\n        }\n      }\n    }\n  }\n\n  drawBezierOutline() {\n    // Maybe we give the start and end shapes, and interpolate those, and convert to beziers each frame?\n    // const toRemove = [];\n    // for (const message of this.stateQueue) {\n    //   message.count--;\n    //   if (message.count === 0) {\n    //     toRemove.push(message);\n    //   }\n    // }\n    // for (const message of toRemove) {\n    //   if (this.stateQueue.length !== 1) {\n    //     //console.log(\"removing\", message.message);\n    //     this.stateQueue.splice(this.stateQueue.indexOf(message), 1);\n    //   }\n    // }\n\n    // If this is 9fps, we should interpolate ~5 frames in between.\n    // Let's try and draw a nice curve around the shape:\n    // Get the edge of the shape:\n    if (\n      this.screeningEvent &&\n      new Date().getTime() - this.screeningEvent.timestamp.getTime() > 1000\n    ) {\n      this.shouldLeaveFrame = true;\n    } else {\n      this.shouldLeaveFrame = false;\n    }\n    frameNum++;\n    const ctx = this.$refs.beziers.getContext(\"2d\") as CanvasRenderingContext2D;\n    const leftOffset = 0;\n    const rightOffset = 120 - thermalRefWidth;\n\n    if (ctx) {\n      ctx.clearRect(0, 0, 810, 1080);\n      ctx.save();\n      ctx.translate(thermalRefWidth / 2, 0);\n      ctx.scale(6.75, 6.75);\n      if (this.shapes.length === 2) {\n        // TODO(jon): Would Object.freeze be a better strategy for opting out of reactivity?\n        const prevShape = this.shapes[0];\n        const nextShape = this.shapes[1];\n\n        // TODO(jon): If there's no nextShape, create one to the side that prevShape seemed to be\n        // going off on.\n        if (prevShape && nextShape && prevShape.length && nextShape.length) {\n          const interpolatedShape = interpolateShapes(\n            prevShape[0],\n            LerpAmount.amount,\n            nextShape[0]\n          );\n\n          const now = performance.now();\n          const elapsedSincePrevFrame = now - this.prevFrameTime;\n          this.prevFrameTime = now;\n          LerpAmount.amount += elapsedSincePrevFrame / 100;\n          LerpAmount.amount = Math.min(1, LerpAmount.amount);\n\n          const pointsArray = new Uint8Array(interpolatedShape.length * 4);\n          let i = 0;\n          interpolatedShape.reverse();\n          let offset = 0;\n          if (this.thermalRefSide === \"left\") {\n            offset = thermalRefWidth;\n          }\n          for (const row of interpolatedShape) {\n            pointsArray[i++] = row.x1 - offset;\n            pointsArray[i++] = row.y;\n          }\n          interpolatedShape.reverse();\n          for (const row of interpolatedShape) {\n            pointsArray[i++] = row.x0 - offset;\n            pointsArray[i++] = row.y;\n          }\n          let bezierPts: number[] = [];\n          if (pointsArray.length >= 4) {\n            bezierPts = curveFitting.fitCurveThroughPoints(pointsArray);\n          }\n          if (bezierPts.length) {\n            {\n              {\n                let headWidth = 0;\n                if (this.face) {\n                  const distance = (a: Point, b: Point) => {\n                    const dX = a.x - b.x;\n                    const dY = a.y - b.y;\n                    return Math.sqrt(dX * dX + dY * dY);\n                  };\n                  headWidth = distance(\n                    this.face.head.bottomLeft,\n                    this.face.head.bottomRight\n                  );\n                }\n                const strokeAlpha = 0.2 + headWidth / 120;\n                ctx.strokeStyle = `rgba(255, 255, 255, ${strokeAlpha})`;\n                ctx.setLineDash([3, 8]);\n                ctx.lineDashOffset = (frameNum / 5) % 10; //Math.abs(((frameNum / 20) % 5) - 2.5);\n                ctx.beginPath();\n                ctx.moveTo(bezierPts[0], bezierPts[1]);\n                for (let i = 2; i < bezierPts.length; i += 6) {\n                  ctx.bezierCurveTo(\n                    bezierPts[i],\n                    bezierPts[i + 1],\n                    bezierPts[i + 2],\n                    bezierPts[i + 3],\n                    bezierPts[i + 4],\n                    bezierPts[i + 5]\n                  );\n                }\n                ctx.stroke();\n              }\n            }\n            {\n              if (this.screeningEvent) {\n                let samplePointLerp = Math.min(\n                  1.0,\n                  (new Date().getTime() -\n                    this.screeningEvent.timestamp.getTime()) /\n                    600\n                );\n                samplePointLerp *= samplePointLerp;\n                ctx.beginPath();\n                ctx.fillStyle = `rgba(255, 255, 255, ${\n                  Math.abs(1.0 - samplePointLerp) * 0.6\n                })`;\n                ctx.arc(\n                  this.screeningEvent.sampleX - offset,\n                  this.screeningEvent.sampleY,\n                  samplePointLerp * 8,\n                  0,\n                  Math.PI * 2\n                );\n                ctx.fill();\n              }\n            }\n            ctx.save();\n            // TODO(jon): Bake this alpha mask to a texture if things seem slow.\n            ctx.globalCompositeOperation = \"destination-out\";\n            const leftGradient = ctx.createLinearGradient(leftOffset, 0, 10, 0);\n            leftGradient.addColorStop(1, \"rgba(0, 0, 0, 0)\");\n            leftGradient.addColorStop(0.25, \"rgba(0, 0, 0, 230)\");\n            leftGradient.addColorStop(0, \"rgba(0, 0, 0, 255)\");\n            const rightGradient = ctx.createLinearGradient(\n              rightOffset - 10,\n              0,\n              rightOffset,\n              0\n            );\n            rightGradient.addColorStop(1, \"rgba(0, 0, 0, 255)\");\n            rightGradient.addColorStop(0.75, \"rgba(0, 0, 0, 230)\");\n            rightGradient.addColorStop(0, \"rgba(0, 0, 0, 0)\");\n\n            const topGradient = ctx.createLinearGradient(0, 0, 0, 10);\n            topGradient.addColorStop(0, \"rgba(0, 0, 0, 255)\");\n            topGradient.addColorStop(0.45, \"rgba(0, 0, 0, 230)\");\n            topGradient.addColorStop(1, \"rgba(0, 0, 0, 0)\");\n\n            const bottomGradient = ctx.createLinearGradient(0, 150, 0, 160);\n            bottomGradient.addColorStop(1, \"rgba(0, 0, 0, 255)\");\n            bottomGradient.addColorStop(0.75, \"rgba(0, 0, 0, 230)\");\n            bottomGradient.addColorStop(0, \"rgba(0, 0, 0, 0)\");\n\n            ctx.fillStyle = leftGradient;\n            ctx.fillRect(leftOffset, 0, 15, 160);\n            ctx.fillStyle = rightGradient;\n            ctx.fillRect(rightOffset - 10, 0, 15, 160);\n            ctx.fillStyle = topGradient;\n            ctx.fillRect(0, 0, 120 - thermalRefWidth, 10);\n            ctx.fillStyle = bottomGradient;\n            ctx.fillRect(0, 150, 120 - thermalRefWidth, 10);\n            ctx.restore();\n          }\n        }\n\n        // Draw corner indicators:\n        ctx.setLineDash([]);\n\n        const insetY = 15;\n        const insetX = 5;\n        const len = 10;\n        const width = 120 - thermalRefWidth;\n        const height = 160;\n        ctx.beginPath();\n        ctx.moveTo(insetX + len, insetY);\n        ctx.lineTo(insetX, insetY);\n        ctx.lineTo(insetX, insetY + len);\n\n        ctx.moveTo(insetX + len, height - insetY);\n        ctx.lineTo(insetX, height - insetY);\n        ctx.lineTo(insetX, height - (insetY + len));\n\n        ctx.moveTo(width - (insetX + len), insetY);\n        ctx.lineTo(width - insetX, insetY);\n        ctx.lineTo(width - insetX, insetY + len);\n\n        ctx.moveTo(width - (insetX + len), height - insetY);\n        ctx.lineTo(width - insetX, height - insetY);\n        ctx.lineTo(width - insetX, height - (insetY + len));\n        ctx.stroke();\n        ctx.restore();\n      }\n    }\n    requestAnimationFrame(this.drawBezierOutline.bind(this));\n  }\n\n  get temperature(): DegreesCelsius {\n    if (this.screeningEvent) {\n      const temp = new DegreesCelsius(this.screeningEvent.face.sampleTemp);\n      this.logForTest(`Temperature is ${temp}`);\n      return temp;\n    }\n    return new DegreesCelsius(0);\n  }\n\n  get temperatureIsNormal(): boolean {\n    return this.temperature.val < this.calibration.thresholdMinFever;\n  }\n\n  get temperatureIsHigherThanNormal(): boolean {\n    return (\n      this.temperature.val >= this.calibration.thresholdMinFever &&\n      this.temperature.val <= PROBABLE_ERROR_TEMP\n    );\n  }\n\n  get temperatureIsProbablyAnError(): boolean {\n    return this.temperature.val > PROBABLE_ERROR_TEMP;\n  }\n\n  get classNameForState() {\n    return this.state.toLowerCase().replace(\"_\", \"-\");\n  }\n\n  get screeningResultClass() {\n    if (this.screeningEvent) {\n      if (this.temperatureIsNormal) {\n        return \"okay\"; // or possible-fever, or error-temp\n      } else if (this.temperatureIsHigherThanNormal) {\n        return \"possible-fever\";\n      } else if (this.temperatureIsProbablyAnError) {\n        return \"error\";\n      }\n    }\n\n    return null;\n  }\n\n  get hasScreeningResult(): boolean {\n    return this.screeningResultClass !== null;\n  }\n\n  get isTooFar(): boolean {\n    return this.state === ScreeningState.TOO_FAR;\n  }\n\n  get isWarmingUp(): boolean {\n    return this.state === ScreeningState.WARMING_UP;\n  }\n\n  get warmupBackgroundColour(): string {\n    // Lerp between\n    const hueStart = 37;\n    const saturationStart = 70;\n    const lightnessStart = 66;\n\n    const hueEnd = 198;\n    const saturationEnd = 100;\n    const lightnessEnd = 42;\n\n    const val = Math.min(\n      1,\n      (WARMUP_TIME_SECONDS - this.warmupSecondsRemaining) / WARMUP_TIME_SECONDS\n    );\n\n    const hue = lerp(hueEnd, val, hueStart);\n    const saturation = lerp(saturationEnd, val, saturationStart);\n    const lightness = lerp(lightnessEnd, val, lightnessStart);\n    return `hsl(${hue}, ${saturation}%, ${lightness}%)`;\n  }\n\n  get isAfterFFCEvent(): boolean {\n    return this.state === ScreeningState.AFTER_FFC_EVENT;\n  }\n\n  get isAquiring(): boolean {\n    return (\n      this.state === ScreeningState.LARGE_BODY ||\n      this.state === ScreeningState.FACE_LOCK ||\n      this.state === ScreeningState.HEAD_LOCK ||\n      this.state === ScreeningState.FRONTAL_LOCK ||\n      this.state === ScreeningState.BLURRED ||\n      this.state === ScreeningState.STABLE_LOCK\n    );\n  }\n\n  get missingRef(): boolean {\n    return this.state === ScreeningState.MISSING_THERMAL_REF;\n  }\n\n  get remainingWarmupTime(): string {\n    const secondsRemaining = this.warmupSecondsRemaining;\n    const minsRemaining = Math.floor(secondsRemaining / 60);\n    const seconds = secondsRemaining - minsRemaining * 60;\n    return ` ${String(minsRemaining).padStart(2, \"0\")}:${String(\n      Math.floor(seconds)\n    ).padStart(2, \"0\")}`;\n  }\n\n  get message(): Message {\n    switch (this.state) {\n      case ScreeningState.WARMING_UP:\n        return { message: \"Please wait\", count: Number.MAX_SAFE_INTEGER };\n      case ScreeningState.MULTIPLE_HEADS:\n        return {\n          message: \"Only one person should be in front of the camera\",\n          count: 60,\n        };\n\n      case ScreeningState.HEAD_LOCK:\n      case ScreeningState.FACE_LOCK:\n        return {\n          message: \"Please look straight ahead\",\n          count: -1,\n        };\n      case ScreeningState.FRONTAL_LOCK:\n      case ScreeningState.BLURRED:\n        return { message: \"Great, now hold still a moment\", count: 120 };\n      case ScreeningState.STABLE_LOCK:\n        if (this.screeningEvent) {\n          if (this.temperatureIsNormal) {\n            return { message: `Your temperature is normal`, count: 460 };\n          } else if (this.temperatureIsHigherThanNormal) {\n            return {\n              message:\n                \"Your temperature is higher than normal, please don't enter\",\n              count: 180,\n            };\n          } else if (this.temperatureIsProbablyAnError) {\n            return {\n              message: \"Temperature anomaly, please check equipment\",\n              count: 360,\n            };\n          }\n        }\n        break;\n      case ScreeningState.MEASURED:\n        if (this.screeningEvent) {\n          if (this.temperatureIsNormal) {\n            return { message: \"You're good to go!\", count: -1 };\n          } else {\n            return {\n              message: \"You can go, but you need to get a follow-up\",\n              count: -1,\n            };\n          }\n        } else {\n          return {\n            message: \"\",\n            count: -1,\n          };\n        }\n      case ScreeningState.READY:\n      default:\n        return { message: \"Ready to screen\", count: Number.MAX_SAFE_INTEGER };\n    }\n    return { message: \"\", count: 0 };\n  }\n\n  logForTest(message: string) {\n    if (this.isTesting) {\n      this.$emit(\"new-message\", message);\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UserFacingScreening.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UserFacingScreening.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./UserFacingScreening.vue?vue&type=template&id=11b540bd&scoped=true&\"\nimport script from \"./UserFacingScreening.vue?vue&type=script&lang=ts&\"\nexport * from \"./UserFacingScreening.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./UserFacingScreening.vue?vue&type=style&index=0&id=11b540bd&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"11b540bd\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\ninstallComponents(component, {VBtn,VCard,VCardActions,VDialog,VIcon})\n","import { BlobReader } from \"./utils\";\nimport { FrameInfo, PartialFrameInfo } from \"./api/types\";\nimport { AnalysisResult, FactoryDefaultCalibration } from \"@/types\";\n\nexport interface Frame {\n  frameInfo: FrameInfo;\n  frame: Uint16Array;\n  bodyShape: Uint8Array;\n  analysisResult: AnalysisResult;\n}\n\nexport interface PartialFrame {\n  frameInfo: PartialFrameInfo;\n  frame: Uint16Array;\n}\n\nexport enum CameraConnectionState {\n  Connecting,\n  Connected,\n  Disconnected\n}\n\nconst UUID = new Date().getTime();\n\ninterface CameraStats {\n  skippedFramesServer: number;\n  skippedFramesClient: number;\n}\n\ninterface CameraState {\n  socket: WebSocket | null;\n  UUID: number;\n  stats: CameraStats;\n  prevFrameNum: number;\n  frames: PartialFrame[];\n  heartbeatInterval: number;\n  pendingFrame: number | null;\n}\n\nexport class CameraConnection {\n  constructor(\n    public host: string,\n    port: string,\n    public onFrame: (frame: PartialFrame) => void,\n    public onConnectionStateChange: (\n      connectionState: CameraConnectionState\n    ) => void\n  ) {\n    if (port === \"8080\" || port === \"5000\") {\n      // If we're running in development mode, find the remote camera server\n      //this.host = \"192.168.178.21\";\n      this.host = \"192.168.0.181\";\n      //this.host = \"192.168.0.82\";\n      //this.host = \"192.168.0.41\";\n    }\n    this.connect();\n  }\n  private state: CameraState = {\n    socket: null,\n    UUID: new Date().getTime(),\n    stats: {\n      skippedFramesServer: 0,\n      skippedFramesClient: 0\n    },\n    pendingFrame: null,\n    prevFrameNum: -1,\n    heartbeatInterval: 0,\n    frames: []\n  };\n\n  retryConnection(retryTime: number) {\n    if (retryTime > 0) {\n      setTimeout(() => this.retryConnection(retryTime - 1), 1000);\n    } else {\n      this.connect();\n    }\n  }\n  register() {\n    if (this.state.socket !== null) {\n      if (this.state.socket.readyState === WebSocket.OPEN) {\n        // We are waiting for frames now.\n        this.state.socket.send(\n          JSON.stringify({\n            type: \"Register\",\n            data: navigator.userAgent,\n            uuid: UUID\n          })\n        );\n        this.onConnectionStateChange(CameraConnectionState.Connected);\n\n        this.state.heartbeatInterval = (setInterval(() => {\n          this.state.socket &&\n            this.state.socket.send(\n              JSON.stringify({\n                type: \"Heartbeat\",\n                uuid: UUID\n              })\n            );\n        }, 5000) as unknown) as number;\n      } else {\n        setTimeout(this.register.bind(this), 100);\n      }\n    }\n  }\n  connect() {\n    this.state.socket = new WebSocket(`ws://${this.host}/ws`);\n    this.onConnectionStateChange(CameraConnectionState.Connecting);\n    this.state.socket.addEventListener(\"error\", e => {\n      console.warn(\"Websocket Connection error\", e);\n      //...\n    });\n    // Connection opened\n    this.state.socket.addEventListener(\"open\", this.register.bind(this));\n    this.state.socket.addEventListener(\"close\", () => {\n      // When we do reconnect, we need to treat it as a new connection\n      console.warn(\"Websocket closed\");\n      this.state.socket = null;\n      this.onConnectionStateChange(CameraConnectionState.Disconnected);\n      clearInterval(this.state.heartbeatInterval);\n      this.retryConnection(5);\n    });\n    this.state.socket.addEventListener(\"message\", async event => {\n      if (event.data instanceof Blob) {\n        // TODO(jon): Only do this if we detect that we're dropping frames?\n        const droppingFrames = false;\n        if (droppingFrames) {\n          this.state.frames.push(\n            (await this.parseFrame(event.data as Blob)) as PartialFrame\n          );\n          // Process the latest frame, after waiting half a frame delay\n          // to see if there are any more frames hot on its heels.\n          this.state.pendingFrame = (setTimeout(\n            this.useLatestFrame.bind(this),\n            1\n          ) as unknown) as number;\n        } else {\n          this.onFrame(\n            (await this.parseFrame(event.data as Blob)) as PartialFrame\n          );\n        }\n        // Every time we get a frame, set a new timeout for when we decide that the camera has stalled sending us new frames.\n      }\n    });\n  }\n  async parseFrame(\n    blob: Blob\n  ): Promise<{ frameInfo: PartialFrameInfo; frame: Uint16Array } | null> {\n    // NOTE(jon): On iOS. it seems slow to do multiple fetches from the blob, so let's do it all at once.\n    const data = await BlobReader.arrayBuffer(blob);\n    const frameInfoLength = new Uint16Array(data.slice(0, 2))[0];\n    const frameStartOffset = 2 + frameInfoLength;\n    try {\n      const frameInfo = JSON.parse(\n        String.fromCharCode(...new Uint8Array(data.slice(2, frameStartOffset)))\n      ) as PartialFrameInfo;\n\n      if (frameInfo.Calibration === null) {\n        frameInfo.Calibration = { ...FactoryDefaultCalibration };\n        frameInfo.Calibration.UuidOfUpdater = UUID;\n        frameInfo.Calibration.CalibrationBinaryVersion =\n          frameInfo.BinaryVersion;\n      }\n\n      const frameNumber = frameInfo.Telemetry.FrameCount;\n      if (frameNumber % 20 === 0) {\n        performance.clearMarks();\n        performance.clearMeasures();\n        performance.clearResourceTimings();\n      }\n      performance.mark(`start frame ${frameNumber}`);\n      if (\n        this.state.prevFrameNum !== -1 &&\n        this.state.prevFrameNum + 1 !== frameInfo.Telemetry.FrameCount\n      ) {\n        this.state.stats.skippedFramesServer +=\n          frameInfo.Telemetry.FrameCount - this.state.prevFrameNum;\n        // Work out an fps counter.\n      }\n      this.state.prevFrameNum = frameInfo.Telemetry.FrameCount;\n      const frameSizeInBytes =\n        frameInfo.Camera.ResX * frameInfo.Camera.ResY * 2;\n      // TODO(jon): Some perf optimisations here.\n      const frame = new Uint16Array(\n        data.slice(frameStartOffset, frameStartOffset + frameSizeInBytes)\n      );\n      return {\n        frameInfo,\n        frame\n      };\n    } catch (e) {\n      console.error(\"Malformed JSON payload\", e);\n    }\n    return null;\n  }\n  async useLatestFrame() {\n    if (this.state.pendingFrame) {\n      clearTimeout(this.state.pendingFrame);\n    }\n    let latestFrameTimeOnMs = 0;\n    let latestFrame: PartialFrame | null = null;\n    // Turns out that we don't always get the messages in order from the pi, so make sure we take the latest one.\n    const framesToDrop: PartialFrame[] = [];\n    while (this.state.frames.length !== 0) {\n      const frame = this.state.frames.shift() as PartialFrame;\n      const frameHeader = frame.frameInfo;\n      const timeOn = frameHeader.Telemetry.TimeOn / 1000 / 1000;\n      if (timeOn > latestFrameTimeOnMs) {\n        if (latestFrame !== null) {\n          framesToDrop.push(latestFrame);\n        }\n        latestFrameTimeOnMs = timeOn;\n        latestFrame = frame;\n      }\n    }\n    // Clear out and log any old frames that need to be dropped\n    while (framesToDrop.length !== 0) {\n      const dropFrame = framesToDrop.shift() as PartialFrame;\n      const timeOn = dropFrame.frameInfo.Telemetry.TimeOn / 1000 / 1000;\n      this.state.stats.skippedFramesClient++;\n      if (this.state.socket) {\n        (this.state.socket as WebSocket).send(\n          JSON.stringify({\n            type: \"Dropped late frame\",\n            data: `${latestFrameTimeOnMs - timeOn}ms behind current: frame#${\n              dropFrame.frameInfo.Telemetry.FrameCount\n            }`,\n            uuid: UUID\n          })\n        );\n      } else {\n        console.warn(\"Lost web socket connection\");\n      }\n    }\n\n    // Take the latest frame and process it.\n    if (latestFrame !== null) {\n      await this.onFrame(latestFrame);\n      // if (DEBUG_MODE) {\n      //   updateFpsCounter(skippedFramesServer, skippedFramesClient);\n      // } else if (fpsCount.innerText !== \"\") {\n      //   fpsCount.innerText = \"\";\n      // }\n    }\n    this.state.stats.skippedFramesClient = 0;\n    this.state.stats.skippedFramesServer = 0;\n  }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"qr-container\"},[_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.registered)?_c('svg',{staticClass:\"qr-image registered\",attrs:{\"viewBox\":\"0,0,72,65\",\"width\":\"86.4\",\"height\":\"78\",\"fill\":\"none\",\"xmlns\":\"http://www.w3.org/2000/svg\"}},[_c('path',{attrs:{\"d\":\"M65 7L28 55 7 37\",\"stroke\":\"#fff\",\"stroke-width\":\"13\",\"stroke-linecap\":\"round\"}})]):_c('svg',{staticClass:\"qr-image\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0,0,1200,1200\",\"width\":150,\"height\":150,\"fill\":\"white\"}},[_c('path',{attrs:{\"d\":\"M576 96h48v48h-48zM672 96h48v48h-48zM576 144h48v48h-48zM624 144h48v48h-48zM672 144h48v48h-48zM480 192h48v48h-48zM528 192h48v48h-48zM576 192h48v48h-48zM672 192h48v48h-48zM480 240h48v48h-48zM528 240h48v48h-48zM624 240h48v48h-48zM480 288h48v48h-48zM576 288h48v48h-48zM624 288h48v48h-48zM672 288h48v48h-48zM480 336h48v48h-48zM672 336h48v48h-48zM480 384h48v48h-48zM576 384h48v48h-48zM672 384h48v48h-48zM480 432h48v48h-48zM528 432h48v48h-48zM624 432h48v48h-48zM672 432h48v48h-48zM96 480h48v48H96zM192 480h48v48h-48zM240 480h48v48h-48zM288 480h48v48h-48zM336 480h48v48h-48zM384 480h48v48h-48zM576 480h48v48h-48zM672 480h48v48h-48zM768 480h48v48h-48zM816 480h48v48h-48zM864 480h48v48h-48zM912 480h48v48h-48zM960 480h48v48h-48zM192 528h48v48h-48zM288 528h48v48h-48zM336 528h48v48h-48zM432 528h48v48h-48zM480 528h48v48h-48zM576 528h48v48h-48zM672 528h48v48h-48zM816 528h48v48h-48zM912 528h48v48h-48zM960 528h48v48h-48zM1008 528h48v48h-48zM1056 528h48v48h-48zM96 576h48v48H96zM192 576h48v48h-48zM384 576h48v48h-48zM432 576h48v48h-48zM480 576h48v48h-48zM576 576h48v48h-48zM624 576h48v48h-48zM720 576h48v48h-48zM864 576h48v48h-48zM960 576h48v48h-48zM1056 576h48v48h-48zM96 624h48v48H96zM144 624h48v48h-48zM240 624h48v48h-48zM288 624h48v48h-48zM480 624h48v48h-48zM576 624h48v48h-48zM816 624h48v48h-48zM864 624h48v48h-48zM960 624h48v48h-48zM1008 624h48v48h-48zM1056 624h48v48h-48zM96 672h48v48H96zM192 672h48v48h-48zM288 672h48v48h-48zM336 672h48v48h-48zM384 672h48v48h-48zM432 672h48v48h-48zM624 672h48v48h-48zM720 672h48v48h-48zM864 672h48v48h-48zM960 672h48v48h-48zM1008 672h48v48h-48zM480 720h48v48h-48zM528 720h48v48h-48zM576 720h48v48h-48zM624 720h48v48h-48zM672 720h48v48h-48zM720 720h48v48h-48zM768 720h48v48h-48zM912 720h48v48h-48zM528 768h48v48h-48zM576 768h48v48h-48zM672 768h48v48h-48zM768 768h48v48h-48zM816 768h48v48h-48zM480 816h48v48h-48zM528 816h48v48h-48zM624 816h48v48h-48zM672 816h48v48h-48zM720 816h48v48h-48zM768 816h48v48h-48zM912 816h48v48h-48zM1008 816h48v48h-48zM480 864h48v48h-48zM672 864h48v48h-48zM816 864h48v48h-48zM960 864h48v48h-48zM480 912h48v48h-48zM528 912h48v48h-48zM576 912h48v48h-48zM672 912h48v48h-48zM816 912h48v48h-48zM960 912h48v48h-48zM480 960h48v48h-48zM528 960h48v48h-48zM576 960h48v48h-48zM624 960h48v48h-48zM720 960h48v48h-48zM864 960h48v48h-48zM912 960h48v48h-48zM960 960h48v48h-48zM816 1008h48v48h-48zM864 1008h48v48h-48zM960 1008h48v48h-48zM1008 1008h48v48h-48zM480 1056h48v48h-48zM576 1056h48v48h-48zM624 1056h48v48h-48zM720 1056h48v48h-48zM864 1056h48v48h-48zM912 1056h48v48h-48zM960 1056h48v48h-48z\"}}),_c('path',{attrs:{\"fill\":\"none\",\"d\":\"M146 146h236v236H146z\"}}),_c('path',{attrs:{\"d\":\"M382 96H96v336h336V96h-50zm0 286H146V146h236v236z\"}}),_c('path',{attrs:{\"fill\":\"none\",\"d\":\"M818 146h236v236H818z\"}}),_c('path',{attrs:{\"d\":\"M1054 96H768v336h336V96h-50zm0 286H818V146h236v236z\"}}),_c('path',{attrs:{\"fill\":\"none\",\"d\":\"M146 818h236v236H146z\"}}),_c('path',{attrs:{\"d\":\"M382 768H96v336h336V768h-50zm0 286H146V818h236v236z\"}}),_c('g',[_c('path',{attrs:{\"d\":\"M192 192h144v144H192z\"}})]),_c('g',[_c('path',{attrs:{\"d\":\"M864 192h144v144H864z\"}})]),_c('g',[_c('path',{attrs:{\"d\":\"M192 864h144v144H192z\"}})])])]),_c('p',{staticClass:\"qr-text\"},[_vm._v(_vm._s(_vm.qrMessage))])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Vue, Prop, Component } from \"vue-property-decorator\";\n\n@Component\nexport default class QRImage extends Vue {\n  @Prop({ required: true }) registered!: boolean;\n  get qrMessage(): string {\n    return this.registered ? \"Registered\" : \"Present ID to register\";\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./QRImage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./QRImage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./QRImage.vue?vue&type=template&id=a3bc6232&\"\nimport script from \"./QRImage.vue?vue&type=script&lang=ts&\"\nexport * from \"./QRImage.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./QRImage.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"video-container\"},[_c('video',{ref:\"videoStream\",attrs:{\"autoplay\":\"\",\"hidden\":\"\"},domProps:{\"srcObject\":_vm.stream}}),_c('transition',{attrs:{\"name\":\"fade\"}},[_c('canvas',{ref:\"videoCanvas\",staticClass:\"video-canvas\",class:{\n        'stream-loaded': _vm.streamLoaded,\n        'stream-not-loaded': !_vm.streamLoaded,\n      }})])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from \"vue-property-decorator\";\nimport jsQR, { QRCode } from \"jsqr\";\nimport { ObservableDeviceApi as DeviceApi } from \"@/main\";\n\n@Component\nexport default class QRVideo extends Vue {\n  @Prop({ required: true }) setQRCode!: (\n    code: QRCode | null,\n    duration?: number,\n    dimensions?: { height: number; width: number }\n  ) => void;\n  stream = {} as MediaStream;\n  timeQRFound = 0;\n  streamLoaded = false;\n\n  $refs!: {\n    videoStream: HTMLVideoElement;\n    videoCanvas: HTMLCanvasElement;\n  };\n\n  async mounted() {\n    // Start video camera\n    try {\n      this.stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n      });\n\n      requestAnimationFrame(this.loadFrame);\n    } catch (e) {\n      console.error(e);\n      DeviceApi.RegisterQRID = false;\n    }\n  }\n\n  loadFrame() {\n    const video = this.$refs.videoStream;\n    if (video) {\n      const { readyState, HAVE_ENOUGH_DATA } = video;\n      if (readyState === HAVE_ENOUGH_DATA) {\n        const ratio = video.videoHeight / video.videoWidth;\n        const width = 550;\n        const height = width * ratio;\n        if (!this.streamLoaded) {\n          this.$refs.videoCanvas.width = width;\n          this.$refs.videoCanvas.height = height;\n        }\n        const canvas = this.$refs.videoCanvas;\n        const canvasContext = canvas.getContext(\"2d\");\n\n        canvasContext?.drawImage(video, 0, 0, width, height);\n        const image = canvasContext?.getImageData(0, 0, width, height);\n        this.streamLoaded = true;\n\n        if (image) {\n          new Promise(() => {\n            const qr = jsQR(image.data, image.width, image.height);\n            const timePassedWithout = Math.floor(\n              (Date.now() - this.timeQRFound) / 1000\n            );\n\n            if (qr && qr.data !== \"\") {\n              this.setQRCode(qr, timePassedWithout, {\n                width: video.videoWidth,\n                height: video.videoWidth,\n              });\n            }\n          });\n        }\n      }\n    }\n    requestAnimationFrame(this.loadFrame);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./QRCameraFeed.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./QRCameraFeed.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./QRCameraFeed.vue?vue&type=template&id=791becbb&scoped=true&\"\nimport script from \"./QRCameraFeed.vue?vue&type=script&lang=ts&\"\nexport * from \"./QRCameraFeed.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./QRCameraFeed.vue?vue&type=style&index=0&id=791becbb&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"791becbb\",\n  null\n  \n)\n\nexport default component.exports","import { ObservableDeviceApi as DeviceApi } from \"@/main\";\nimport { Frame } from \"@/camera\";\nimport { ScreeningState } from \"@/types\";\n\nfunction FrameHandler() {\n  const secondsToMilliseconds = (seconds: number) => seconds * 1000;\n  const isDeviceRecording = () =>\n    DeviceApi.recorderStatus().then(({ recording }) => recording);\n  return {\n    startTimeInFrame: 0,\n    startTimeOutFrame: 0,\n    isRecording: isDeviceRecording(),\n    hasMeasured: false,\n    async process(frame: Frame) {\n      const timeInFrame = this.getTimeInFrame(frame);\n      const { hasExit, isInFrame } = this.isObjectStillInFrame(frame);\n      this.measuredInFrame(frame);\n      if (isInFrame && !this.isRecording) {\n        await DeviceApi.startRecording();\n        this.isRecording = await isDeviceRecording();\n      } else if (hasExit && this.isRecording) {\n        const shouldRecord =\n          timeInFrame > secondsToMilliseconds(8) ||\n          (this.hasMeasured && timeInFrame > secondsToMilliseconds(1));\n        this.hasMeasured = false;\n        await DeviceApi.stopRecording(shouldRecord);\n        this.isRecording = await isDeviceRecording();\n      }\n    },\n    measuredInFrame(frame: Frame) {\n      const state = frame.analysisResult.nextState;\n      this.hasMeasured =\n        state === ScreeningState.MEASURED ? true : this.hasMeasured;\n    },\n    isObjectInFrame(frame: Frame): boolean {\n      const state = frame.analysisResult.nextState;\n      return (\n        state === ScreeningState.HEAD_LOCK ||\n        state === ScreeningState.LARGE_BODY ||\n        state === ScreeningState.FRONTAL_LOCK ||\n        state === ScreeningState.STABLE_LOCK ||\n        state === ScreeningState.MULTIPLE_HEADS ||\n        state === ScreeningState.MEASURED ||\n        state === ScreeningState.TOO_FAR\n      );\n    },\n    hasObjectExitFrame(frame: Frame): boolean {\n      const isInFrame = this.isObjectInFrame(frame);\n      const ThresholdSeconds = secondsToMilliseconds(3);\n      const now = Date.now();\n      this.startTimeOutFrame = isInFrame ? now : this.startTimeOutFrame;\n      const currTimeOutFrame = Math.abs(now - this.startTimeOutFrame);\n      const hasExit = currTimeOutFrame > ThresholdSeconds;\n      this.startTimeOutFrame = hasExit ? Infinity : this.startTimeOutFrame;\n\n      return hasExit;\n    },\n    // Even if doesn't detect object is in a frame does not mean it has left.\n    isObjectStillInFrame(\n      frame: Frame\n    ): { isInFrame: boolean; hasExit: boolean } {\n      const isInFrame = this.isObjectInFrame(frame);\n      const hasExit = this.hasObjectExitFrame(frame);\n      return { isInFrame, hasExit };\n    },\n    getTimeInFrame(frame: Frame): number {\n      const now = Date.now();\n      const { isInFrame, hasExit } = this.isObjectStillInFrame(frame);\n      if (isInFrame) {\n        this.startTimeInFrame =\n          this.startTimeInFrame === 0 ? now : this.startTimeInFrame;\n        return now - this.startTimeInFrame;\n      } else if (this.startTimeInFrame === 0) {\n        return 0;\n      } else if (hasExit) {\n        // Object has yet to enter frame\n        const totalTimeInFrame = now - this.startTimeInFrame;\n        this.startTimeInFrame = 0;\n        return totalTimeInFrame;\n      } else {\n        return now - this.startTimeInFrame;\n      }\n    }\n  };\n}\n\nexport default FrameHandler;\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport UserFacingScreening from \"@/components/UserFacingScreening.vue\";\nimport { Component, Vue } from \"vue-property-decorator\";\nimport { CameraConnectionState, Frame } from \"@/camera\";\nimport FrameListenerWorker from \"worker-loader!./frame-listener\";\nimport { FrameInfo } from \"@/api/types\";\nimport {\n  ExternalDeviceSettingsApi as DeviceSettings,\n  ScreeningApi,\n} from \"@/api/api\";\nimport {\n  AppState,\n  CalibrationInfo,\n  FaceInfo,\n  FactoryDefaultCalibration,\n  ScreeningEvent,\n  ScreeningState,\n  ThermalReference,\n} from \"@/types\";\nimport { checkForSoftwareUpdates, DegreesCelsius } from \"@/utils\";\nimport {\n  FFC_SAFETY_DURATION_SECONDS,\n  FFC_MAX_INTERVAL_MS,\n  LerpAmount,\n  State,\n  ObservableDeviceApi as DeviceApi,\n  WARMUP_TIME_SECONDS,\n} from \"@/main\";\nimport VideoStream from \"@/components/VideoStream.vue\";\nimport QRImage from \"@/components/QRImage.vue\";\nimport QRVideo from \"@/components/QRCameraFeed.vue\";\nimport { FrameMessage } from \"@/frame-listener\";\nimport { ImmutableShape } from \"@/geom\";\nimport FrameHandler from \"@/frame-handler\";\nimport { QRCode } from \"jsqr\";\n\n@Component({\n  components: {\n    UserFacingScreening,\n    VideoStream,\n    QRVideo,\n    QRImage,\n  },\n})\nexport default class App extends Vue {\n  private deviceID = \"\";\n  private deviceName = \"\";\n  private piSerial = \"\";\n  private appVersion = \"\";\n\n  private appState: AppState = State;\n  private isNotFullscreen = true;\n  private showUpdatedCalibrationSnackbar = false;\n  private frameHandler = FrameHandler();\n\n  get isReferenceDevice(): boolean {\n    return (\n      window.navigator.userAgent.includes(\"Lenovo TB-X605LC\") ||\n      this.isRunningInAndroidWebview\n    );\n  }\n\n  get face(): FaceInfo | null {\n    return this.appState.currentFrame?.analysisResult.face || null;\n  }\n\n  get finishScan(): boolean {\n    return this.appState.currentScreeningState === ScreeningState.MEASURED;\n  }\n\n  get qrMode(): boolean {\n    return DeviceApi.RegisterQRID;\n  }\n\n  get isRunningInAndroidWebview(): boolean {\n    return window.navigator.userAgent === \"feverscreen-app\";\n  }\n\n  get isFakeReferenceDevice(): boolean {\n    return window.navigator.userAgent.includes(\"Fake\");\n  }\n\n  async enableFullscreen() {\n    try {\n      await document.body.requestFullscreen();\n      this.isNotFullscreen = false;\n    } catch (e) {\n      return;\n    }\n  }\n\n  private qrCode: {\n    code: QRCode | null;\n    dimensions?: { height: number; width: number };\n    duration: number;\n  } = { code: null, dimensions: { height: 0, width: 0 }, duration: 0 };\n\n  private startTimeInFrame = 0;\n  private startTimeOutFrame = Infinity;\n  private isRecording = false;\n  private skippedWarmup = false;\n  private thermalRefSide: \"left\" | \"right\" = \"left\";\n  private prevShape: ImmutableShape[] = [];\n  private nextShape: ImmutableShape[] = [];\n\n  $refs!: {\n    debugCanvas: HTMLCanvasElement;\n  };\n\n  private skipWarmup() {\n    this.skippedWarmup = true;\n  }\n\n  public get currentFrameCount(): number {\n    // NOTE(jon): This is always zero if it's the fake thermal camera.\n    if ((this.appState.currentFrame as Frame).frameInfo) {\n      return (this.appState.currentFrame as Frame).frameInfo.Telemetry\n        .FrameCount;\n    }\n    return 0;\n  }\n\n  public setQRCode(\n    code: QRCode | null,\n    duration = 0,\n    dimensions?: { height: number; width: number }\n  ) {\n    this.qrCode = { code, dimensions, duration };\n  }\n\n  get registered() {\n    if (this.qrCode.code && this.qrCode.code.data !== null) {\n      return true;\n    }\n    return false;\n  }\n\n  updateCalibration(nextCalibration: CalibrationInfo, firstLoad = false) {\n    if (!firstLoad && this.appState.uuid !== nextCalibration.UuidOfUpdater) {\n      this.showUpdatedCalibrationSnackbar = true;\n      setTimeout(() => {\n        this.showUpdatedCalibrationSnackbar = false;\n      }, 3000);\n    }\n    this.appState.currentCalibration.thermalRefTemperature = new DegreesCelsius(\n      nextCalibration.ThermalRefTemp\n    );\n    this.appState.currentCalibration.calibrationTemperature =\n      new DegreesCelsius(nextCalibration.TemperatureCelsius);\n    this.appState.currentCalibration.thresholdMinFever =\n      nextCalibration.ThresholdMinFever;\n    this.appState.currentCalibration.head = {\n      tL: { x: nextCalibration.HeadTLX, y: nextCalibration.HeadTLY },\n      tR: { x: nextCalibration.HeadTRX, y: nextCalibration.HeadTRY },\n      bL: { x: nextCalibration.HeadBLX, y: nextCalibration.HeadBLY },\n      bR: { x: nextCalibration.HeadBRX, y: nextCalibration.HeadBRY },\n    };\n    this.appState.currentCalibration.playNormalSound =\n      nextCalibration.UseNormalSound;\n    this.appState.currentCalibration.playWarningSound =\n      nextCalibration.UseWarningSound;\n    this.appState.currentCalibration.playErrorSound =\n      nextCalibration.UseErrorSound;\n  }\n\n  get currentFrame(): Frame {\n    return this.appState.currentFrame as Frame;\n  }\n\n  get timeOnInSeconds(): number {\n    const telemetry = this.frameInfo?.Telemetry;\n    if (telemetry) {\n      let timeOnSecs;\n      // NOTE: TimeOn is in nanoseconds when coming from the camera server,\n      //  but in milliseconds when coming from a CPTV file - should make these the same.\n      if (this.useLiveCamera) {\n        timeOnSecs = telemetry.TimeOn / 1000 / 1000 / 1000;\n      } else {\n        timeOnSecs = telemetry.TimeOn / 1000;\n      }\n      return timeOnSecs;\n    }\n    return WARMUP_TIME_SECONDS;\n  }\n\n  get isWarmingUp(): boolean {\n    return !this.skippedWarmup && this.timeOnInSeconds < WARMUP_TIME_SECONDS;\n  }\n\n  get remainingWarmupTime(): number {\n    if (this.skippedWarmup) {\n      return 0;\n    }\n    return Math.max(0, WARMUP_TIME_SECONDS - this.timeOnInSeconds);\n  }\n\n  get isDuringFFCEvent(): boolean {\n    const telemetry = this.frameInfo?.Telemetry;\n    if (!this.isWarmingUp && telemetry) {\n      // TODO(jon): This needs to change based on whether camera is live or not\n      return (\n        (telemetry.TimeOn - telemetry.LastFFCTime) / 1000 <\n        FFC_SAFETY_DURATION_SECONDS\n      );\n    }\n    return false;\n  }\n\n  get isGettingFrames(): boolean {\n    // Did we receive any frames in the past second?  // Did we just trigger an FFC event?\n    return this.appState.lastFrameTime > new Date().getTime() - 1000;\n  }\n\n  get isNotGettingFrames(): boolean {\n    // Did we receive any frames in the past second?\n    return !(this.appState.lastFrameTime > new Date().getTime() - 1000);\n  }\n\n  get isConnected(): boolean {\n    return (\n      this.appState.cameraConnectionState === CameraConnectionState.Connected\n    );\n  }\n\n  get isConnecting(): boolean {\n    return (\n      this.appState.cameraConnectionState === CameraConnectionState.Connecting\n    );\n  }\n\n  private updateBodyOutline(body: Uint8Array) {\n    this.prevShape = this.nextShape;\n    const shape = [];\n    for (let i = 0; i < body.length; i += 3) {\n      const y = body[i];\n      const x0 = body[i + 1];\n      const x1 = body[i + 2];\n      shape.push({ x0, x1, y });\n    }\n    LerpAmount.amount = 0.0;\n    if (shape.length) {\n      this.nextShape = [Object.freeze(shape)];\n    } else {\n      this.nextShape = [];\n    }\n  }\n\n  private checkForSoftwareUpdatesThisFrame(frame: Frame) {\n    const newLine = frame.frameInfo.AppVersion.indexOf(\"\\n\");\n    if (newLine !== -1) {\n      frame.frameInfo.AppVersion = frame.frameInfo.AppVersion.substring(\n        0,\n        newLine\n      );\n    }\n    // Did the software get updated?\n    checkForSoftwareUpdates(\n      frame.frameInfo.BinaryVersion,\n      frame.frameInfo.AppVersion,\n      this.gotFirstFrame\n    );\n  }\n\n  private checkForCalibrationUpdatesThisFrame(frame: Frame) {\n    if (this.frameInfo) {\n      const prevCalibration = JSON.stringify(this.frameInfo.Calibration);\n      const nextCalibration = JSON.stringify(frame.frameInfo.Calibration);\n      if (prevCalibration !== nextCalibration) {\n        this.updateCalibration(frame.frameInfo.Calibration);\n      }\n    }\n  }\n\n  private async onFrame(frame: Frame) {\n    this.checkForSoftwareUpdatesThisFrame(frame);\n    this.checkForCalibrationUpdatesThisFrame(frame);\n    this.updateBodyOutline(frame.bodyShape);\n    this.appState.lastFrameTime = new Date().getTime();\n\n    if (DeviceApi.RecordUserActivity) {\n      this.frameHandler.process(frame);\n    }\n\n    if (frame.analysisResult.thermalRef.geom.center.x < 60) {\n      this.thermalRefSide = \"left\";\n    } else {\n      this.thermalRefSide = \"right\";\n    }\n\n    if (this.isWarmingUp) {\n      this.appState.currentScreeningState = ScreeningState.WARMING_UP;\n    } else {\n      // See if we want to pre-emptively trigger an FFC:\n      let msSinceLastFFC =\n        frame.frameInfo.Telemetry.TimeOn -\n        frame.frameInfo.Telemetry.LastFFCTime;\n      if (this.useLiveCamera) {\n        // Nanoseconds rather than milliseconds if live\n        msSinceLastFFC = msSinceLastFFC / 1000 / 1000;\n      }\n\n      const timeTillFFC = FFC_MAX_INTERVAL_MS - msSinceLastFFC;\n      const prevScreeningState = this.appState.currentScreeningState;\n      const nextScreeningState = frame.analysisResult.nextState;\n\n      if (\n        prevScreeningState === ScreeningState.STABLE_LOCK &&\n        nextScreeningState === ScreeningState.MEASURED\n      ) {\n        const face = frame.analysisResult.face;\n        const thermalRef = frame.analysisResult.thermalRef;\n        this.snapshotScreeningEvent(thermalRef, face, frame, {\n          ...face.samplePoint,\n          v: face.sampleValue,\n          t: face.sampleTemp,\n        });\n      } else if (\n        prevScreeningState === ScreeningState.MEASURED &&\n        nextScreeningState === ScreeningState.READY\n      ) {\n        if (this.isReferenceDevice) {\n          if (timeTillFFC < 30 * 1000) {\n            // Someone just left the frame, and we need to do an FFC in the next 30 seconds,\n            // so now is a great time to do it early and hide it from the user.\n            DeviceApi.runFFC();\n          }\n          ScreeningApi.recordScreeningEvent(\n            this.deviceID,\n            this.piSerial,\n            this.appState.currentScreeningEvent as ScreeningEvent,\n            this.appState.currentCalibration.thresholdMinFever,\n            this.qrCode.code?.data\n          );\n        }\n\n        this.appState.currentScreeningEvent = null;\n      } else if (this.isReferenceDevice && timeTillFFC < 30 * 1000) {\n        // Someone just entered the frame, but we need to do an FFC in the next 30 seconds,\n        // so do it as soon as they have entered and make them wait then, rather than in the middle of trying to\n        // screen them.\n        DeviceApi.runFFC();\n      }\n      this.appState.currentScreeningState = nextScreeningState;\n      if (nextScreeningState !== ScreeningState.MEASURED) {\n        this.setQRCode(null);\n      }\n    }\n    this.appState.currentFrame = frame;\n  }\n\n  get frameInfo(): FrameInfo | undefined {\n    return this.appState.currentFrame?.frameInfo;\n  }\n\n  snapshotScreeningEvent(\n    thermalReference: ThermalReference,\n    face: FaceInfo,\n    frame: Frame,\n    sample: { x: number; y: number; v: number; t: number }\n  ) {\n    this.appState.currentScreeningEvent = {\n      rawTemperatureValue: sample.v,\n      calculatedValue: sample.t,\n      sampleX: sample.x,\n      sampleY: sample.y,\n      frame, // Really, we should be able to recreate the temperature value just from the frame + telemetry?\n      timestamp: new Date(),\n      thermalReference,\n      face,\n    };\n    return;\n  }\n\n  onConnectionStateChange(connection: CameraConnectionState) {\n    this.appState.cameraConnectionState = connection;\n  }\n\n  private checkForSettingsChanges(deviceID: string) {\n    DeviceSettings.getDevice(deviceID).then((device: any) => {\n      if (device !== undefined) {\n        const enable = device.recordUserActivity[\"BOOL\"];\n        DeviceApi.RecordUserActivity = enable;\n        DeviceApi.DisableRecordUserActivity = !enable;\n      } else {\n        DeviceApi.DisableRecordUserActivity = false;\n        DeviceApi.RecordUserActivity =\n          window.localStorage.getItem(\"recordUserActivity\") === \"false\"\n            ? false\n            : true;\n      }\n    });\n  }\n\n  private showSoftwareVersionUpdatedPrompt = false;\n  private useLiveCamera = true;\n  private gotFirstFrame = false;\n\n  async created() {\n    let cptvFilename = \"/cptv-files/0.7.5beta recording-1 2708.cptv\";\n    //let cptvFilename = \"/cptv-files/bunch of people in small meeting room 20200812.134427.735.cptv\";\n    const uri = window.location.search.substring(1);\n    const params = new URLSearchParams(uri);\n    if (params.get(\"cptvfile\")) {\n      cptvFilename = `/cptv-files/${params.get(\"cptvfile\")}.cptv`;\n      this.useLiveCamera = false;\n    }\n    DeviceApi.RegisterQRID =\n      window.localStorage.getItem(\"registerQRID\") === \"false\" ? false : true;\n\n    // Update the AppState:\n    if (this.useLiveCamera) {\n      this.appState.uuid = new Date().getTime();\n      await DeviceApi.stopRecording(false);\n      DeviceApi.getCalibration().then((existingCalibration) => {\n        if (existingCalibration === null) {\n          existingCalibration = { ...FactoryDefaultCalibration };\n        }\n        this.updateCalibration(existingCalibration, true);\n        DeviceApi.softwareVersion().then(({ appVersion, binaryVersion }) => {\n          DeviceApi.deviceInfo().then(({ deviceID, devicename, serial }) => {\n            this.deviceID = deviceID;\n            this.deviceName = devicename;\n            this.piSerial = serial;\n            const newLine = appVersion.indexOf(\"\\n\");\n            let newAppVersion = appVersion;\n            this.checkForSettingsChanges(deviceID);\n            setInterval(() => {\n              this.checkForSettingsChanges(deviceID);\n            }, 1000 * 60 * 30); // Every 30 Minutes\n            if (newLine !== -1) {\n              newAppVersion = newAppVersion.substring(0, newLine);\n            }\n            this.appVersion = newAppVersion;\n            if (\n              checkForSoftwareUpdates(\n                binaryVersion,\n                newAppVersion,\n                this.gotFirstFrame\n              )\n            ) {\n              this.showSoftwareVersionUpdatedPrompt = true;\n            }\n          });\n        });\n      });\n    }\n    const frameListener = new FrameListenerWorker();\n    frameListener.onmessage = (message) => {\n      const frameMessage = message.data as FrameMessage;\n      switch (frameMessage.type) {\n        case \"gotFrame\":\n          this.onFrame(frameMessage.payload as Frame);\n          this.gotFirstFrame = true;\n          break;\n        case \"connectionStateChange\":\n          this.onConnectionStateChange(\n            frameMessage.payload as CameraConnectionState\n          );\n          break;\n      }\n    };\n\n    frameListener.postMessage({\n      useLiveCamera: this.useLiveCamera,\n      hostname: window.location.hostname,\n      port: window.location.port,\n      cptvFileToPlayback: cptvFilename,\n    });\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??clonedRuleSet-40[0].rules[0].use[0]!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??clonedRuleSet-40[0].rules[0].use[3]!../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=f87e6892&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VOverlay } from 'vuetify/lib/components/VOverlay';\nimport { VSnackbar } from 'vuetify/lib/components/VSnackbar';\ninstallComponents(component, {VApp,VBtn,VCard,VCardActions,VCardTitle,VDialog,VOverlay,VSnackbar})\n","import Vue from \"vue\";\nimport Vuetify from \"vuetify/lib\";\nVue.use(Vuetify);\n\nexport default new Vuetify({\n  icons: {\n    iconfont: \"mdiSvg\"\n  }\n});\n","import Vue from \"vue\";\nimport App from \"./App.vue\";\nimport vuetify from \"./plugins/vuetify\";\nimport { AppState, DEFAULT_THRESHOLD_MIN_FEVER, ScreeningState } from \"@/types\";\nimport { CameraConnectionState } from \"@/camera\";\nimport { DegreesCelsius } from \"@/utils\";\nimport { DeviceApi } from \"@/api/api\";\n\nVue.config.productionTip = false;\n\nexport const WARMUP_TIME_SECONDS = 60; // 30 mins\nexport const FFC_SAFETY_DURATION_SECONDS = 5;\nexport const FFC_MAX_INTERVAL_MS = 1000 * 60 * 10; // 10 mins\n\n// A global that stores the current interpolation state - can probably become part of the vue components.\nexport const LerpAmount = { amount: 0 };\nexport const State: AppState = {\n  currentFrame: null,\n  cameraConnectionState: CameraConnectionState.Disconnected,\n  face: null,\n  paused: false,\n  currentCalibration: {\n    calibrationTemperature: new DegreesCelsius(36),\n    thermalReferenceRawValue: 30000,\n    hotspotRawTemperatureValue: 31000,\n    timestamp: new Date(),\n    head: {\n      tL: { x: 0, y: 0 },\n      tR: { x: 0, y: 0 },\n      bL: { x: 0, y: 0 },\n      bR: { x: 0, y: 0 }\n    },\n    thresholdMinFever: DEFAULT_THRESHOLD_MIN_FEVER,\n    thermalRefTemperature: new DegreesCelsius(0),\n    playErrorSound: true,\n    playNormalSound: true,\n    playWarningSound: true\n  },\n  currentScreeningEvent: null,\n  currentScreeningState: ScreeningState.INIT,\n  currentScreeningStateFrameCount: -1,\n  lastFrameTime: 0,\n  uuid: 0,\n  analysisResult: {\n    thresholdSum: 0,\n    motionThresholdSum: 0,\n    heatStats: {\n      max: 0,\n      min: 0,\n      threshold: 0\n    },\n    face: {\n      isValid: false,\n      headLock: 0,\n      halfwayRatio: 0.0,\n      samplePoint: { x: 0, y: 0 },\n      sampleValue: 0,\n      sampleTemp: 0,\n      head: {\n        topLeft: { x: 0, y: 0 },\n        topRight: { x: 0, y: 0 },\n        bottomLeft: { x: 0, y: 0 },\n        bottomRight: { x: 0, y: 0 }\n      }\n    },\n    thermalRef: {\n      geom: {\n        center: {\n          x: 0,\n          y: 0\n        },\n        radius: 0\n      },\n      val: 0,\n      temp: 0\n    },\n    hasBody: false,\n    nextState: ScreeningState.INIT,\n    motionSum: 0,\n    frameBottomSum: 0\n  }\n};\n\nexport const ObservableDeviceApi = Vue.observable(DeviceApi);\n\n/*\n//these are the *lowest* temperature in celsius for each category\nlet GThreshold_error = 42.5;\nlet GThreshold_fever = 37.8;\nlet GThreshold_check = 37.4;\nlet GThreshold_normal = 35.7;\n */\n\nnew Vue({\n  vuetify,\n  render: h => h(App)\n}).$mount(\"#app\");\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"f76748cb591434668cf8.worker.js\");\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// expose the module cache\n__webpack_require__.c = __webpack_module_cache__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".\" + \"f577683e\" + \".js\";\n};","// This function allow to reference all chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"css/\" + \"chunk-vendors\" + \".\" + \"2141b8b5\" + \".css\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var inProgress = {};\nvar dataWebpackPrefix = \"frontend:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/static/dist/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = globalThis[\"webpackChunkfrontend\"] = globalThis[\"webpackChunkfrontend\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// object to store loaded and loading wasm modules\nvar installedWasmModules = {};\n\nfunction promiseResolve() { return Promise.resolve(); }\n\nvar wasmImportedFuncCache0;\nvar wasmImportedFuncCache1;\nvar wasmImportedFuncCache2;\nvar wasmImportedFuncCache3;\nvar wasmImportedFuncCache4;\nvar wasmImportObjects = {\n\t9534: function() {\n\t\treturn {\n\t\t\t\"./curve_fitting_bg.js\": {\n\t\t\t\t\"__wbindgen_number_new\": function(p0f64) {\n\t\t\t\t\tif(wasmImportedFuncCache0 === undefined) wasmImportedFuncCache0 = __webpack_require__.c[476].exports;\n\t\t\t\t\treturn wasmImportedFuncCache0[\"pT\"](p0f64);\n\t\t\t\t},\n\t\t\t\t\"__wbindgen_object_drop_ref\": function(p0i32) {\n\t\t\t\t\tif(wasmImportedFuncCache1 === undefined) wasmImportedFuncCache1 = __webpack_require__.c[476].exports;\n\t\t\t\t\treturn wasmImportedFuncCache1[\"ug\"](p0i32);\n\t\t\t\t},\n\t\t\t\t\"__wbg_new_6b6f346b4912cdae\": function() {\n\t\t\t\t\tif(wasmImportedFuncCache2 === undefined) wasmImportedFuncCache2 = __webpack_require__.c[476].exports;\n\t\t\t\t\treturn wasmImportedFuncCache2[\"w_\"]();\n\t\t\t\t},\n\t\t\t\t\"__wbg_push_f353108e20ec67a0\": function(p0i32,p1i32) {\n\t\t\t\t\tif(wasmImportedFuncCache3 === undefined) wasmImportedFuncCache3 = __webpack_require__.c[476].exports;\n\t\t\t\t\treturn wasmImportedFuncCache3[\"TJ\"](p0i32,p1i32);\n\t\t\t\t},\n\t\t\t\t\"__wbindgen_throw\": function(p0i32,p1i32) {\n\t\t\t\t\tif(wasmImportedFuncCache4 === undefined) wasmImportedFuncCache4 = __webpack_require__.c[476].exports;\n\t\t\t\t\treturn wasmImportedFuncCache4[\"Or\"](p0i32,p1i32);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n};\n\nvar wasmModuleMap = {\n\t\"641\": [\n\t\t9534\n\t]\n};\n\n// object with all WebAssembly.instance exports\n__webpack_require__.w = {};\n\n// Fetch + compile chunk loading for webassembly\n__webpack_require__.f.wasm = function(chunkId, promises) {\n\n\tvar wasmModules = wasmModuleMap[chunkId] || [];\n\n\twasmModules.forEach(function(wasmModuleId, idx) {\n\t\tvar installedWasmModuleData = installedWasmModules[wasmModuleId];\n\n\t\t// a Promise means \"currently loading\" or \"already loaded\".\n\t\tif(installedWasmModuleData)\n\t\t\tpromises.push(installedWasmModuleData);\n\t\telse {\n\t\t\tvar importObject = wasmImportObjects[wasmModuleId]();\n\t\t\tvar req = fetch(__webpack_require__.p + \"\" + {\"641\":{\"9534\":\"e3f7296217571fdd8bb8\"}}[chunkId][wasmModuleId] + \".module.wasm\");\n\t\t\tvar promise;\n\t\t\tif(importObject && typeof importObject.then === 'function' && typeof WebAssembly.compileStreaming === 'function') {\n\t\t\t\tpromise = Promise.all([WebAssembly.compileStreaming(req), importObject]).then(function(items) {\n\t\t\t\t\treturn WebAssembly.instantiate(items[0], items[1]);\n\t\t\t\t});\n\t\t\t} else if(typeof WebAssembly.instantiateStreaming === 'function') {\n\t\t\t\tpromise = WebAssembly.instantiateStreaming(req, importObject);\n\t\t\t} else {\n\t\t\t\tvar bytesPromise = req.then(function(x) { return x.arrayBuffer(); });\n\t\t\t\tpromise = bytesPromise.then(function(bytes) {\n\t\t\t\t\treturn WebAssembly.instantiate(bytes, importObject);\n\t\t\t\t});\n\t\t\t}\n\t\t\tpromises.push(installedWasmModules[wasmModuleId] = promise.then(function(res) {\n\t\t\t\treturn __webpack_require__.w[wasmModuleId] = (res.instance || res).exports;\n\t\t\t}));\n\t\t}\n\t});\n};","","// module cache are used so entry inlining is disabled\n// startup\n// Load entry module and return exports\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], () => (__webpack_require__(9892)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":[],"sourceRoot":""}